{
  TextRange variableRange=templateState.getVariableRange(0);
  if (variableRange == null)   return;
  PsiElement name=psiFile.findElementAt(variableRange.getStartOffset());
  if (name != null && name.getParent() instanceof JetReferenceExpression) {
    JetReferenceExpression ref=(JetReferenceExpression)name.getParent();
    BindingContext bc=WholeProjectAnalyzerFacade.analyzeProjectWithCacheOnAFile((JetFile)psiFile);
    DeclarationDescriptor descriptor=bc.get(BindingContext.REFERENCE_TARGET,ref);
    if (descriptor instanceof ClassDescriptor) {
      classRef=ref;
      classDescriptor=(ClassDescriptor)descriptor;
    }
  }
}
