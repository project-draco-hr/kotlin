{
  printVersionIfNeeded(messageCollector,arguments);
  if (arguments.suppressWarnings) {
    messageCollector=new FilteringMessageCollector(messageCollector,Predicates.equalTo(CompilerMessageSeverity.WARNING));
  }
  GroupingMessageCollector groupingCollector=new GroupingMessageCollector(messageCollector);
  try {
    Disposable rootDisposable=Disposer.newDisposable();
    try {
      MessageSeverityCollector severityCollector=new MessageSeverityCollector(groupingCollector);
      ExitCode code=doExecute(arguments,services,severityCollector,rootDisposable);
      return severityCollector.anyReported(CompilerMessageSeverity.ERROR) ? COMPILATION_ERROR : code;
    }
  finally {
      Disposer.dispose(rootDisposable);
    }
  }
 catch (  CompilationInterruptedException e) {
    return e.exitCode;
  }
catch (  Throwable t) {
    groupingCollector.report(CompilerMessageSeverity.EXCEPTION,OutputMessageUtil.renderException(t),CompilerMessageLocation.NO_LOCATION);
    return INTERNAL_ERROR;
  }
 finally {
    groupingCollector.flush();
  }
}
