{
  GenerationState state=new GenerationState(myProject,ClassBuilderFactory.TEXT);
  try {
    BindingContext binding=WholeProjectAnalyzerFacade.analyzeProjectWithCacheOnAFile(file);
    AnalyzingUtils.throwExceptionOnErrors(binding);
    state.compileCorrectFiles(binding,Collections.singletonList(file));
  }
 catch (  Exception e) {
    StringWriter out=new StringWriter(1024);
    e.printStackTrace(new PrintWriter(out));
    return out.toString().replaceAll("\r","");
  }
  StringBuilder answer=new StringBuilder();
  final ClassFileFactory factory=state.getFactory();
  for (  String filename : factory.files()) {
    answer.append("// ================ ");
    answer.append(filename);
    answer.append(" =================\n");
    answer.append(factory.asText(filename)).append("\n\n");
  }
  return answer.toString();
}
