{
  JetImportList importList=file.getImportList();
  if (importList != null) {
    JetImportDirective newDirective=JetPsiFactory.createImportDirective(file.getProject(),importPath);
    importList.add(newDirective);
  }
 else {
    JetImportList newDirective=JetPsiFactory.createImportDirectiveWithImportList(file.getProject(),importPath);
    JetNamespaceHeader header=file.getNamespaceHeader();
    if (header == null) {
      throw new IllegalStateException("Scripts are not supported: " + file.getName());
    }
    header.getParent().addAfter(newDirective,header);
  }
}
