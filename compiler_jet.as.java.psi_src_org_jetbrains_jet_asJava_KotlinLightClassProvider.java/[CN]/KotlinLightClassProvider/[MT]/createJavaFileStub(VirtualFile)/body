{
  PsiManager manager=PsiManager.getInstance(project);
  final PsiJavaFileStubImpl javaFileStub=new PsiJavaFileStubImpl(packageFqName.getFqName(),true);
  javaFileStub.setPsiFactory(new ClsWrapperStubPsiFactory());
  ClsFileImpl fakeFile=new ClsFileImpl((PsiManagerImpl)manager,new ClassFileViewProvider(manager,virtualFile)){
    @NotNull @Override public PsiClassHolderFileStub getStub(){
      return javaFileStub;
    }
    @NotNull @Override public String getPackageName(){
      return packageFqName.getFqName();
    }
  }
;
  fakeFile.setPhysical(false);
  javaFileStub.setPsi(fakeFile);
  return javaFileStub;
}
