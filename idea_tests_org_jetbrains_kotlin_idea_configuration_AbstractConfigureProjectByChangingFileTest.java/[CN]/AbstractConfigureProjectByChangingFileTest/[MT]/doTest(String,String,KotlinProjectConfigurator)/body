{
  configureByFile(beforeFile);
  String versionFromFile=InTextDirectivesUtils.findStringWithPrefixes(getFile().getText(),"// VERSION:");
  String version=versionFromFile != null ? versionFromFile : DEFAULT_VERSION;
  if (configurator instanceof KotlinWithGradleConfigurator) {
    ((KotlinWithGradleConfigurator)configurator).changeGradleFile((GroovyFile)getFile(),version);
  }
 else   if (configurator instanceof KotlinMavenConfigurator) {
    ((KotlinMavenConfigurator)configurator).changePomFile(getModule(),getFile(),version);
  }
  KotlinTestUtils.assertEqualsToFile(new File(afterFile),getFile().getText().replace(version,"$VERSION$"));
}
