{
  for (  ClassDescriptorWithResolutionScopes mutableClassDescriptor : c.getDeclaredClasses().values()) {
    ((MutableClassDescriptor)mutableClassDescriptor).lockScopes();
  }
  Set<FqName> scriptFqNames=Sets.newHashSet();
  for (  JetFile file : c.getFileScopes().keySet()) {
    if (file.isScript()) {
      scriptFqNames.add(file.getPackageFqName());
    }
  }
  for (  MutablePackageFragmentDescriptor fragment : packageFragmentProvider.getAllFragments()) {
    if (!scriptFqNames.contains(fragment.getFqName())) {
      fragment.getMemberScope().changeLockLevel(WritableScope.LockLevel.READING);
    }
  }
}
