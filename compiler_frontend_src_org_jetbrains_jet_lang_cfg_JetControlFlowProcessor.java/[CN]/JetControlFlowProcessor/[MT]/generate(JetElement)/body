{
  builder.enterSubroutine(subroutine);
  CFPVisitor cfpVisitor=new CFPVisitor(builder);
  if (subroutine instanceof JetDeclarationWithBody) {
    JetDeclarationWithBody declarationWithBody=(JetDeclarationWithBody)subroutine;
    List<JetParameter> valueParameters=declarationWithBody.getValueParameters();
    for (    JetParameter valueParameter : valueParameters) {
      cfpVisitor.generateInstructions(valueParameter);
    }
    JetExpression bodyExpression=declarationWithBody.getBodyExpression();
    if (bodyExpression != null) {
      cfpVisitor.generateInstructions(bodyExpression);
      if (!declarationWithBody.hasBlockBody()) {
        generateImplicitReturnValue(bodyExpression,subroutine);
      }
    }
  }
 else {
    cfpVisitor.generateInstructions(subroutine);
  }
  return builder.exitSubroutine(subroutine);
}
