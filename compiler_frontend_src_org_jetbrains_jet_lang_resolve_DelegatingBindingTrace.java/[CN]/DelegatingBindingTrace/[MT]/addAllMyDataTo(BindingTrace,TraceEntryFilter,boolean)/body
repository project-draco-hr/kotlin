{
  for (  Map.Entry<SlicedMapKey<?,?>,?> entry : map) {
    SlicedMapKey slicedMapKey=entry.getKey();
    WritableSlice slice=slicedMapKey.getSlice();
    Object key=slicedMapKey.getKey();
    Object value=entry.getValue();
    if (filter == null || filter.accept(slice,key)) {
      trace.record(slice,key,value);
    }
  }
  if (!commitDiagnostics)   return;
  for (  Diagnostic diagnostic : mutableDiagnostics.getOwnDiagnostics()) {
    if (filter == null || filter.accept(null,diagnostic.getPsiElement())) {
      trace.report(diagnostic);
    }
  }
}
