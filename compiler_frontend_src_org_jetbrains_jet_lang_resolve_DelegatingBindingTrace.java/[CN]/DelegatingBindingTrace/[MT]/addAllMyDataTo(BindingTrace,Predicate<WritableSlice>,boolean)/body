{
  for (  Map.Entry<SlicedMapKey<?,?>,?> entry : map) {
    SlicedMapKey slicedMapKey=entry.getKey();
    Object value=entry.getValue();
    WritableSlice slice=slicedMapKey.getSlice();
    if (filter == null || filter.apply(slice)) {
      trace.record(slice,slicedMapKey.getKey(),value);
    }
  }
  if (!commitDiagnostics)   return;
  for (  Diagnostic diagnostic : diagnostics) {
    trace.report(diagnostic);
  }
}
