{
  VariableDescriptor variable=BindingContextUtils.extractVariableDescriptorIfAny(trace.getBindingContext(),expression,true);
  if (variable != null) {
    DeclarationDescriptor variableParent=variable.getContainingDeclaration();
    DeclarationDescriptor scopeContainer=scope.getContainingDeclaration();
    if (scopeContainer != variableParent && variableParent instanceof CallableDescriptor) {
      if (trace.get(CAPTURED_IN_CLOSURE,variable) != CaptureKind.NOT_INLINE) {
        boolean inline=isCapturedInInline(trace.getBindingContext(),scopeContainer,variableParent);
        trace.record(CAPTURED_IN_CLOSURE,variable,inline ? CaptureKind.INLINE_ONLY : CaptureKind.NOT_INLINE);
      }
    }
  }
}
