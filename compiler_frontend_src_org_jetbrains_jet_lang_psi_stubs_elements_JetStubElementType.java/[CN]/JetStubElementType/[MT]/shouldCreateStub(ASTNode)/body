{
  PsiElement psi=node.getPsi();
  if (PsiTreeUtil.getParentOfType(psi,JetFunctionLiteral.class) != null) {
    return false;
  }
  JetBlockExpression blockExpression=PsiTreeUtil.getParentOfType(psi,JetBlockExpression.class);
  @SuppressWarnings("unchecked") JetDeclarationWithBody stubStopElement=PsiTreeUtil.getParentOfType(blockExpression,JetFunction.class,JetPropertyAccessor.class);
  if (stubStopElement != null) {
    return false;
  }
  @SuppressWarnings("unchecked") JetWithExpressionInitializer withInitializer=PsiTreeUtil.getParentOfType(psi,JetWithExpressionInitializer.class,true,JetBlockExpression.class);
  if (withInitializer != null) {
    JetExpression initializer=withInitializer.getInitializer();
    if (PsiTreeUtil.isAncestor(initializer,psi,true)) {
      return false;
    }
  }
  return super.shouldCreateStub(node);
}
