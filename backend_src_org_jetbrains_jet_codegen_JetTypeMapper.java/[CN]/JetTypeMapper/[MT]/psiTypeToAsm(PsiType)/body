{
  if (type instanceof PsiArrayType) {
    PsiArrayType psiArrayType=(PsiArrayType)type;
    return Type.getType("[" + psiTypeToAsm(psiArrayType.getComponentType()).getDescriptor());
  }
  if (type instanceof PsiPrimitiveType) {
    if (type == PsiType.VOID) {
      return Type.VOID_TYPE;
    }
    if (type == PsiType.INT) {
      return Type.INT_TYPE;
    }
    if (type == PsiType.LONG) {
      return Type.LONG_TYPE;
    }
    if (type == PsiType.BOOLEAN) {
      return Type.BOOLEAN_TYPE;
    }
    if (type == PsiType.BYTE) {
      return Type.BYTE_TYPE;
    }
    if (type == PsiType.SHORT) {
      return Type.SHORT_TYPE;
    }
    if (type == PsiType.CHAR) {
      return Type.CHAR_TYPE;
    }
    if (type == PsiType.FLOAT) {
      return Type.FLOAT_TYPE;
    }
    if (type == PsiType.DOUBLE) {
      return Type.DOUBLE_TYPE;
    }
  }
  if (type instanceof PsiClassType) {
    PsiClass psiClass=((PsiClassType)type).resolve();
    if (psiClass instanceof PsiTypeParameter) {
      final PsiClassType[] extendsListTypes=psiClass.getExtendsListTypes();
      if (extendsListTypes.length > 0) {
        throw new UnsupportedOperationException("should return common supertype");
      }
      return TYPE_OBJECT;
    }
    if (psiClass == null) {
      throw new UnsupportedOperationException("unresolved PsiClassType: " + type);
    }
    return psiClassType(psiClass);
  }
  throw new UnsupportedOperationException("don't know how to map type " + type + " to ASM");
}
