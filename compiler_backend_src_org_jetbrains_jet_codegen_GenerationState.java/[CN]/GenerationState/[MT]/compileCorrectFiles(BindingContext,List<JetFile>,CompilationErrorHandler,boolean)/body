{
  ClosureAnnotator closureAnnotator=!annotate ? null : new ClosureAnnotator(bindingContext,files);
  typeMapper=new JetTypeMapper(standardLibrary,bindingContext,closureAnnotator);
  bindingContexts.push(bindingContext);
  try {
    for (    JetFile namespace : files) {
      if (namespace == null)       throw new IllegalArgumentException("A null file given for compilation");
      try {
        generateNamespace(namespace);
      }
 catch (      Throwable e) {
        VirtualFile virtualFile=namespace.getContainingFile().getVirtualFile();
        errorHandler.reportException(e,virtualFile == null ? "no file" : virtualFile.getUrl());
        DiagnosticUtils.throwIfRunningOnServer(e);
        if (ApplicationManager.getApplication().isInternal()) {
          e.printStackTrace();
        }
      }
    }
  }
  finally {
    bindingContexts.pop();
    typeMapper=null;
  }
}
