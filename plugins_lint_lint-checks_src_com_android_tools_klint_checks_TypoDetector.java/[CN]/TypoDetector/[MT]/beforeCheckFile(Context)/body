{
  initLocale(context.file.getParentFile().getName());
  if (mLanguage == null) {
    if (context instanceof XmlContext) {
      Element root=((XmlContext)context).document.getDocumentElement();
      if (root != null) {
        String locale=root.getAttributeNS(TOOLS_URI,ATTR_LOCALE);
        if (locale != null && !locale.isEmpty()) {
          initLocale(FD_RES_VALUES + '-' + locale);
        }
      }
    }
    if (mLanguage == null) {
      mLanguage="en";
    }
  }
  if (!equal(mLastLanguage,mLanguage) || !equal(mLastRegion,mRegion)) {
    mLookup=TypoLookup.get(context.getClient(),mLanguage,mRegion);
    mLastLanguage=mLanguage;
    mLastRegion=mRegion;
  }
}
