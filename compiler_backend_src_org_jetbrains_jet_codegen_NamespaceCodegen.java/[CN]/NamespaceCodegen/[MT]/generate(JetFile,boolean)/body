{
  NamespaceDescriptor descriptor=state.getBindingContext().get(BindingContext.FILE_TO_NAMESPACE,file);
  for (  JetDeclaration declaration : file.getDeclarations()) {
    if (declaration instanceof JetProperty) {
      final CodegenContext context=CodegenContext.STATIC.intoNamespace(descriptor);
      state.getMemberCodegen().generateFunctionOrProperty((JetTypeParameterListOwner)declaration,context,v.getClassBuilder());
    }
 else     if (declaration instanceof JetNamedFunction) {
      if (!multiFile) {
        final CodegenContext context=CodegenContext.STATIC.intoNamespace(descriptor);
        state.getMemberCodegen().generateFunctionOrProperty((JetTypeParameterListOwner)declaration,context,v.getClassBuilder());
      }
    }
 else     if (declaration instanceof JetClassOrObject) {
      final CodegenContext context=CodegenContext.STATIC.intoNamespace(descriptor);
      state.getClassCodegen().generate(context,(JetClassOrObject)declaration);
    }
 else     if (declaration instanceof JetScript) {
      state.getScriptCodegen().generate((JetScript)declaration);
    }
  }
  if (multiFile) {
    int k=0;
    for (    JetDeclaration declaration : file.getDeclarations()) {
      if (declaration instanceof JetNamedFunction) {
        k++;
      }
    }
    if (k > 0) {
      PsiFile containingFile=file.getContainingFile();
      String namespaceInternalName=name.child(Name.identifier(JvmAbi.PACKAGE_CLASS)).getFqName().replace('.','/');
      String className=getMultiFileNamespaceInternalName(namespaceInternalName,containingFile);
      ClassBuilder builder=state.getFactory().forNamespacepart(className);
      builder.defineClass(containingFile,V1_6,ACC_PUBLIC,className,null,"java/lang/Object",new String[0]);
      builder.visitSource(containingFile.getName(),null);
      for (      JetDeclaration declaration : file.getDeclarations()) {
        if (declaration instanceof JetNamedFunction) {
{
            final CodegenContext context=CodegenContext.STATIC.intoNamespace(descriptor);
            state.getMemberCodegen().generateFunctionOrProperty((JetTypeParameterListOwner)declaration,context,builder);
          }
{
            final CodegenContext context=CodegenContext.STATIC.intoNamespacePart(className,descriptor);
            state.getMemberCodegen().generateFunctionOrProperty((JetTypeParameterListOwner)declaration,context,v.getClassBuilder());
          }
        }
      }
      builder.done();
    }
  }
}
