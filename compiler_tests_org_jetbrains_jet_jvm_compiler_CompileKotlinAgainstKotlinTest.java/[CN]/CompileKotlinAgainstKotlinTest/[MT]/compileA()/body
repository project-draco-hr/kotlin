{
  JetCoreEnvironment jetCoreEnvironment=JetTestUtils.createEnvironmentWithMockJdkAndIdeaAnnotations(myTestRootDisposable);
  String text=FileUtil.loadFile(ktAFile);
  LightVirtualFile virtualFile=new LightVirtualFile(ktAFile.getName(),JetLanguage.INSTANCE,text);
  virtualFile.setCharset(CharsetToolkit.UTF8_CHARSET);
  JetFile psiFile=(JetFile)((PsiFileFactoryImpl)PsiFileFactory.getInstance(jetCoreEnvironment.getProject())).trySetupPsiForFile(virtualFile,JetLanguage.INSTANCE,true,false);
  ClassFileFactory classFileFactory=GenerationUtils.compileFileGetClassFileFactoryForTest(psiFile);
  CompileEnvironmentUtil.writeToOutputDirectory(classFileFactory,aDir);
  Disposer.dispose(myTestRootDisposable);
}
