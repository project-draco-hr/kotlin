{
  List<JetType> types=getPossibleTypes(context);
  Collections.reverse(types);
  Set<JetType> newTypes=new LinkedHashSet<JetType>(types);
  for (  TypeSubstitution substitution : substitutions) {
    List<JetType> toAdd=new ArrayList<JetType>();
    List<JetType> toRemove=new ArrayList<JetType>();
    for (    JetType type : newTypes) {
      toAdd.add(substituteType(type,substitution,variance));
      if (containsType(type,substitution.getByType())) {
        toRemove.add(type);
      }
    }
    newTypes.addAll(toAdd);
    newTypes.removeAll(toRemove);
  }
  if (newTypes.isEmpty()) {
    newTypes.add(KotlinBuiltIns.getInstance().getAnyType());
  }
  typeCandidates=new TypeCandidate[newTypes.size()];
  int i=typeCandidates.length - 1;
  for (  JetType type : newTypes) {
    typeCandidates[i]=new TypeCandidate(type,scope);
    i--;
  }
}
