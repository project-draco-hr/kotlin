{
  PsiElement immediateParent=jetDeclaration.getParent();
  if (immediateParent instanceof JetFile) {
    return getFileScopeForDeclarationResolution((JetFile)immediateParent);
  }
  JetDeclaration parentDeclaration=PsiTreeUtil.getParentOfType(jetDeclaration,JetDeclaration.class);
  if (parentDeclaration instanceof JetClassOrObject) {
    JetClassOrObject classOrObject=(JetClassOrObject)parentDeclaration;
    return getScopeForClassMemberResolution(classOrObject);
  }
 else {
    throw new IllegalStateException("Don't call this method for local declarations: " + jetDeclaration);
  }
}
