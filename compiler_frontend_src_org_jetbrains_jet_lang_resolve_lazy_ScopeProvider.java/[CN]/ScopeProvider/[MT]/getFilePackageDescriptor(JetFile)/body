{
  JetPackageDirective directive=file.getPackageDirective();
  if (directive == null) {
    throw new IllegalArgumentException("Scripts are not supported: " + file.getName());
  }
  FqName fqName=new FqName(directive.getQualifiedName());
  PackageViewDescriptor packageDescriptor=resolveSession.getModuleDescriptor().getPackage(fqName);
  if (packageDescriptor == null) {
    throw new IllegalStateException("Package not found: " + fqName + " maybe the file is not in scope of this resolve session: "+ file.getName());
  }
  return packageDescriptor;
}
