{
  KotlinMoveTarget target=selectMoveTarget();
  if (target == null)   return;
  saveRefactoringSettings();
  List<JetNamedDeclaration> elementsToMove=getSelectedElementsToMove();
  for (  PsiElement element : elementsToMove) {
    String message=target.verify(element.getContainingFile());
    if (message != null) {
      CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("error.title"),message,null,myProject);
      return;
    }
  }
  try {
    MoveKotlinTopLevelDeclarationsOptions options=new MoveKotlinTopLevelDeclarationsOptions(elementsToMove,target,isSearchInComments(),isSearchInNonJavaFiles(),true,moveCallback);
    invokeRefactoring(new MoveKotlinTopLevelDeclarationsProcessor(myProject,options,Mover.Default.INSTANCE$));
  }
 catch (  IncorrectOperationException e) {
    CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("error.title"),e.getMessage(),null,myProject);
  }
}
