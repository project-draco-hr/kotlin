{
  try {
    ModuleScriptData moduleScriptData=loadModuleDescriptions(getKotlinPathsForAntTask(),module,MessageCollectorPlainTextToStream.PLAIN_TEXT_TO_SYSTEM_ERR);
    List<Module> modules=moduleScriptData.getModules();
    List<String> sourcesRoots=new ArrayList<String>();
    for (    Module m : modules) {
      sourcesRoots.addAll(m.getSourceFiles());
    }
    CompilerConfiguration configuration=createConfiguration(stdlib,classpath,externalAnnotationsPath,ArrayUtil.toStringArray(sourcesRoots),args);
    File directory=new File(module).getParentFile();
    boolean success=KotlinToJVMBytecodeCompiler.compileModules(configuration,modules,directory,new File(jar),includeRuntime);
    if (!success) {
      throw new CompileEnvironmentException(errorMessage(new String[]{module},false));
    }
  }
 catch (  Exception e) {
    throw new CompileEnvironmentException(errorMessage(new String[]{module},true),e);
  }
}
