{
  CompilerConfiguration configuration=new CompilerConfiguration();
  configuration.add(CLASSPATH_KEY,PathUtil.findRtJar());
  if ((stdlib != null) && (stdlib.trim().length() > 0)) {
    configuration.add(CLASSPATH_KEY,new File(stdlib));
  }
 else {
    File path=PathUtil.getDefaultRuntimePath();
    if (path != null) {
      configuration.add(CLASSPATH_KEY,path);
    }
  }
  if ((classpath != null) && (classpath.length > 0)) {
    for (    String path : classpath) {
      configuration.add(CLASSPATH_KEY,new File(path));
    }
  }
  File jdkAnnotationsPath=PathUtil.getJdkAnnotationsPath();
  if (jdkAnnotationsPath != null) {
    configuration.add(ANNOTATIONS_PATH_KEY,jdkAnnotationsPath);
  }
  configuration.addAll(CommonConfigurationKeys.SOURCE_ROOTS_KEY,Arrays.asList(sourceRoots));
  configuration.put(CLIConfigurationKeys.MESSAGE_COLLECTOR_KEY,MessageCollectorPlainTextToStream.PLAIN_TEXT_TO_SYSTEM_ERR);
  configuration.addAll(CLIConfigurationKeys.COMPILER_PLUGINS,getCompilerPlugins());
  return configuration;
}
