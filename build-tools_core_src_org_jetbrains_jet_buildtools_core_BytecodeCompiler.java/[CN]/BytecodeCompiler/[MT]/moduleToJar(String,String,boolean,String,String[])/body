{
  try {
    ModuleChunk modules=CompileEnvironmentUtil.loadModuleDescriptions(getKotlinPathsForAntTask(),module,MessageCollectorPlainTextToStream.PLAIN_TEXT_TO_SYSTEM_ERR);
    List<String> sourcesRoots=new ArrayList<String>();
    for (    Module m : modules.getModules()) {
      sourcesRoots.addAll(m.getSourceFiles());
    }
    CompilerConfiguration configuration=createConfiguration(stdlib,classpath,sourcesRoots.toArray(new String[0]));
    File directory=new File(module).getParentFile();
    boolean success=KotlinToJVMBytecodeCompiler.compileModules(configuration,modules,directory,new File(jar),includeRuntime);
    if (!success) {
      throw new CompileEnvironmentException(errorMessage(new String[]{module},false));
    }
  }
 catch (  Exception e) {
    throw new CompileEnvironmentException(errorMessage(new String[]{module},true),e);
  }
}
