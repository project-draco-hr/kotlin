{
  String executableFileName=SystemInfo.isWindows ? executableName + ".bat" : executableName;
  File kotlincFile=new File(PathUtil.getKotlinPathsForDistDirectory().getHomePath(),"bin/" + executableFileName);
  assertTrue("kotlinc executable not found, probably you need to invoke 'dist' Ant target: " + kotlincFile.getAbsolutePath(),kotlincFile.exists());
  List<String> args=AbstractCliTest.readArgs(argsFilePath,testDataDir,tmpdir.getAbsolutePath());
  args.add(0,kotlincFile.getAbsolutePath());
  ProcessOutput processOutput=ExecUtil.execAndGetOutput(args,null);
  String stdout=processOutput.getStdout();
  String stderr=processOutput.getStderr();
  int exitCode=processOutput.getExitCode();
  String normalizedOutput=AbstractCliTest.getNormalizedCompilerOutput(stderr,ExitCode.values()[exitCode],testDataDir);
  File outFile=new File(argsFilePath.replace(".args",".out"));
  try {
    KotlinTestUtils.assertEqualsToFile(outFile,normalizedOutput);
  }
 catch (  Exception e) {
    System.err.println("exit code " + exitCode);
    System.err.println("<stdout>" + stdout + "</stdout>");
    System.err.println("<stderr>" + stderr + "</stderr>");
    throw e;
  }
}
