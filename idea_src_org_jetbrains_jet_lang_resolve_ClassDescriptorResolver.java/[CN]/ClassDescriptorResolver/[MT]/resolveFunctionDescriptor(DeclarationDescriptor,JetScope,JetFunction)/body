{
  FunctionDescriptorImpl functionDescriptor=new FunctionDescriptorImpl(containingDescriptor,AnnotationResolver.INSTANCE.resolveAnnotations(function.getModifierList()),JetPsiUtil.safeName(function.getName()));
  WritableScope innerScope=semanticServices.createWritableScope(scope,functionDescriptor);
  innerScope.addLabeledDeclaration(functionDescriptor);
  List<TypeParameterDescriptor> typeParameterDescriptors=resolveTypeParameters(functionDescriptor,innerScope,function.getTypeParameters());
  List<ValueParameterDescriptor> valueParameterDescriptors=resolveValueParameters(functionDescriptor,innerScope,function.getValueParameters());
  JetTypeReference returnTypeRef=function.getReturnTypeRef();
  JetType returnType=null;
  if (returnTypeRef != null) {
    returnType=typeResolver.resolveType(innerScope,returnTypeRef);
  }
  functionDescriptor.initialize(typeParameterDescriptors,valueParameterDescriptors,returnType);
  trace.recordDeclarationResolution(function,functionDescriptor);
  return functionDescriptor;
}
