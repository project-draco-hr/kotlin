{
  ModuleDescriptor module=new ModuleDescriptor(Name.special("<test module>"));
  InjectorForTopDownAnalyzer injector=createInjectorForTDA(module);
  InjectorForTopDownAnalyzer tdaInjectorForLazy=getEagerInjectorForTopDownAnalyzer();
  ModuleDescriptor lazyModule=new ModuleDescriptor(Name.special("<lazy module>"));
  ResolveSession session=new ResolveSession(project,lazyModule,tdaInjectorForLazy.getModuleConfiguration(),new FileBasedDeclarationProviderFactory(files));
  injector.getTopDownAnalyzer().analyzeFiles(files,Collections.<AnalyzerScriptParameter>emptyList());
  Pair<NamespaceDescriptor,NamespaceDescriptor> namespacesToCompare=transform.fun(Pair.create(module,lazyModule));
  NamespaceComparator.compareNamespaces(namespacesToCompare.first,namespacesToCompare.second,includeMembersOfObject,filterJetNamespace,serializeResultsTo);
}
