{
  boolean isWithRuntime=name.endsWith("Runtime");
  if (isWithRuntime) {
    ConfigLibraryUtil.configureKotlinRuntime(getModule(),getFullJavaJDK());
  }
  try {
    doSingleTest(name.substring("before".length()) + ".kt");
    checkAvailableActionsAreExpected();
    checkForUnexpectedErrors();
  }
  finally {
    if (isWithRuntime) {
      ConfigLibraryUtil.unConfigureKotlinRuntime(getModule(),getProjectJDK());
    }
  }
}
