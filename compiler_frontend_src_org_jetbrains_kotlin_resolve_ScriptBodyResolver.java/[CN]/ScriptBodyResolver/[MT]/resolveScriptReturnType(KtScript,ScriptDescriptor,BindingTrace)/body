{
  ExpressionTypingContext context=ExpressionTypingContext.newContext(trace,scriptDescriptor.getScopeForBodyResolution(),DataFlowInfo.EMPTY,NO_EXPECTED_TYPE);
  PreliminaryDeclarationVisitor.Companion.createForDeclaration(script,trace);
  KotlinType returnType=expressionTypingServices.getBlockReturnedType(script.getBlockExpression(),CoercionStrategy.NO_COERCION,context).getType();
  if (returnType == null) {
    returnType=ErrorUtils.createErrorType("getBlockReturnedType returned null");
  }
  return returnType;
}
