{
  CompilerConfiguration configuration=new CompilerConfiguration();
  configuration.addAll(CLASSPATH_KEY,priorityClasspath);
  if (jdkKind == TestJdkKind.MOCK_JDK) {
    configuration.add(CLASSPATH_KEY,findMockJdkRtJar());
  }
 else {
    configuration.addAll(CLASSPATH_KEY,PathUtil.getJdkClassesRoots());
  }
  if (configurationKind == ALL) {
    configuration.add(CLASSPATH_KEY,ForTestCompileRuntime.runtimeJarForTests());
  }
  configuration.addAll(CLASSPATH_KEY,extraClasspath);
  if (configurationKind == ALL || configurationKind == JDK_AND_ANNOTATIONS) {
    configuration.add(ANNOTATIONS_PATH_KEY,ForTestPackJdkAnnotations.jdkAnnotationsForTests());
  }
  return configuration;
}
