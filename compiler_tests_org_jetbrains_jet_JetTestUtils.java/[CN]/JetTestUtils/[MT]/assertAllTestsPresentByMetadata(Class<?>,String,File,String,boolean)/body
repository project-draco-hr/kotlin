{
  TestMetadata testClassMetadata=testCaseClass.getAnnotation(TestMetadata.class);
  Assert.assertNotNull("No metadata for class: " + testCaseClass,testClassMetadata);
  String rootPath=testClassMetadata.value();
  File rootFile=new File(rootPath);
  Set<String> filePaths=Sets.newHashSet();
  for (  Method method : testCaseClass.getDeclaredMethods()) {
    TestMetadata testMetadata=method.getAnnotation(TestMetadata.class);
    if (testMetadata != null) {
      filePaths.add(testMetadata.value());
    }
  }
  File[] files=testDataDir.listFiles();
  if (files != null) {
    for (    File file : files) {
      if (file.isDirectory()) {
        if (recursive) {
          assertAllTestsPresentByMetadata(testCaseClass,generatorClassFqName,file,extension,recursive);
        }
      }
 else {
        if (file.getName().endsWith("." + extension)) {
          String relativePath=FileUtil.getRelativePath(rootFile,file);
          if (!filePaths.contains(relativePath)) {
            String generatorClassSimpleName=generatorClassFqName.substring(generatorClassFqName.lastIndexOf(".") + 1);
            Assert.fail("Test data file missing from the generated test class: " + file + "\nPlease re-run the generator: "+ generatorClassFqName+ "("+ generatorClassSimpleName+ ".java:1)");
          }
        }
      }
    }
  }
}
