{
  checkedModuleNames.add(module.getName());
  for (  final OrderEntry orderEntry : ModuleRootManager.getInstance(module).getOrderEntries()) {
    if (orderEntry instanceof ModuleOrderEntry) {
      final ModuleOrderEntry moduleOrderEntry=(ModuleOrderEntry)orderEntry;
      final Module depModule=moduleOrderEntry.getModule();
      if (depModule != null && !checkedModuleNames.contains(depModule.getName()) && isAvailable(moduleOrderEntry,isDependency)) {
        final File sdkHome=findSDKHome(depModule,checkedModuleNames,true);
        if (sdkHome != null) {
          return sdkHome;
        }
      }
    }
 else     if (orderEntry instanceof LibraryOrderEntry) {
      final LibraryOrderEntry libraryOrderEntry=(LibraryOrderEntry)orderEntry;
      if (isAvailable(libraryOrderEntry,isDependency)) {
        final File sdkHome=detectSDKHome(Arrays.asList(libraryOrderEntry.getRootFiles(OrderRootType.CLASSES)));
        if (sdkHome != null) {
          return sdkHome;
        }
      }
    }
  }
  return null;
}
