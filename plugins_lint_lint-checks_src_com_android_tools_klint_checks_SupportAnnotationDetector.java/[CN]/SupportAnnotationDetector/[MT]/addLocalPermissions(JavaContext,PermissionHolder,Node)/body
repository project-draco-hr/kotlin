{
  Node methodNode=JavaContext.findSurroundingMethod(node);
  if (methodNode == null) {
    return permissions;
  }
  ResolvedNode resolved=context.resolve(methodNode);
  if (!(resolved instanceof ResolvedMethod)) {
    return permissions;
  }
  ResolvedMethod method=(ResolvedMethod)resolved;
  ResolvedAnnotation annotation=method.getAnnotation(PERMISSION_ANNOTATION);
  permissions=mergeAnnotationPermissions(context,permissions,annotation);
  annotation=method.getContainingClass().getAnnotation(PERMISSION_ANNOTATION);
  permissions=mergeAnnotationPermissions(context,permissions,annotation);
  return permissions;
}
