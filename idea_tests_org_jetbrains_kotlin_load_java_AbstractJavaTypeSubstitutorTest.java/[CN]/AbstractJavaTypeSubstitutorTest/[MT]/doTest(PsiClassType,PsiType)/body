{
  PsiType expectedType=type.resolveGenerics().getSubstitutor().substitute(psiTypeToSubstitute);
  JavaClassifierTypeImpl javaClassifierType=(JavaClassifierTypeImpl)JavaTypeImpl.create(type);
  JavaTypeImpl<?> javaTypeToSubstitute=JavaTypeImpl.create(psiTypeToSubstitute);
  JavaType actualType=javaClassifierType.getSubstitutor().substitute(javaTypeToSubstitute);
  if (expectedType instanceof PsiEllipsisType) {
    PsiEllipsisType ellipsisType=(PsiEllipsisType)expectedType;
    assertEquals(ellipsisType.toArrayType(),((JavaTypeImpl)actualType).getPsi());
  }
 else {
    assertEquals(expectedType,((JavaTypeImpl)actualType).getPsi());
  }
}
