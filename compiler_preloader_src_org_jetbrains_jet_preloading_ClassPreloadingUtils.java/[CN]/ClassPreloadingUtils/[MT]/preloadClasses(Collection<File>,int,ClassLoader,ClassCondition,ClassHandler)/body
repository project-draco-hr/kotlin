{
  Map<String,Object> entries=loadAllClassesFromJars(jarFiles,classCountEstimation,handler);
  Collection<File> classpath=mergeClasspathFromManifests(entries);
  if (!classpath.isEmpty()) {
    parentClassLoader=preloadClasses(classpath,classCountEstimation,parentClassLoader,null,handler);
  }
  return createMemoryBasedClassLoader(parentClassLoader,entries,handler,classesToLoadByParent);
}
