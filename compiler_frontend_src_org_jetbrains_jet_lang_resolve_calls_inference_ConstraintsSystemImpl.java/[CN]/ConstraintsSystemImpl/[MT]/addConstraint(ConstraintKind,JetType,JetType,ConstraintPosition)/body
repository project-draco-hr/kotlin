{
  if (constrainingType == DONT_CARE || subjectType == DONT_CARE || constrainingType == TypeUtils.NO_EXPECTED_TYPE || subjectType == TypeUtils.NO_EXPECTED_TYPE) {
    return;
  }
  DeclarationDescriptor constrainingTypeDescriptor=constrainingType.getConstructor().getDeclarationDescriptor();
  DeclarationDescriptor subjectTypeDescriptor=subjectType.getConstructor().getDeclarationDescriptor();
  if (subjectTypeDescriptor instanceof TypeParameterDescriptor) {
    if (TypeUtils.dependsOnTypeParameterConstructors(constrainingType,Collections.singleton(DONT_CARE.getConstructor())))     return;
    if (subjectType.isNullable()) {
      constrainingType=TypeUtils.makeNotNullable(constrainingType);
    }
    TypeParameterDescriptor typeParameter=(TypeParameterDescriptor)subjectTypeDescriptor;
    if (constraintKind == ConstraintKind.SUPER_TYPE) {
      typeParameterConstraints.get(typeParameter).addLowerBound(constrainingType);
    }
 else     if (constraintKind == ConstraintKind.SUB_TYPE) {
      typeParameterConstraints.get(typeParameter).addUpperBound(constrainingType);
    }
 else {
      typeParameterConstraints.get(typeParameter).addExactBound(constrainingType);
    }
    return;
  }
  if (constrainingTypeDescriptor instanceof ClassDescriptor && subjectTypeDescriptor instanceof ClassDescriptor) {
    if (constraintKind != ConstraintKind.SUB_TYPE) {
      JetType correspondingSupertype=TypeCheckingProcedure.findCorrespondingSupertype(constrainingType,subjectType);
      if (correspondingSupertype != null) {
        constrainingType=correspondingSupertype;
      }
    }
 else {
      JetType correspondingSupertype=TypeCheckingProcedure.findCorrespondingSupertype(subjectType,constrainingType);
      if (correspondingSupertype != null) {
        subjectType=correspondingSupertype;
      }
    }
    if (constrainingType.getConstructor().getParameters().size() != subjectType.getConstructor().getParameters().size()) {
      errorConstraintPositions.add(constraintPosition);
      typeConstructorMismatch=true;
      return;
    }
    ClassDescriptor subClass=(ClassDescriptor)constrainingType.getConstructor().getDeclarationDescriptor();
    ClassDescriptor superClass=(ClassDescriptor)subjectType.getConstructor().getDeclarationDescriptor();
    if (DescriptorUtils.isSubclass(subClass,superClass)) {
      List<TypeProjection> subArguments=constrainingType.getArguments();
      List<TypeProjection> superArguments=subjectType.getArguments();
      List<TypeParameterDescriptor> superParameters=subjectType.getConstructor().getParameters();
      for (int i=0; i < superArguments.size(); i++) {
        addConstraint(varianceToConstraintKind(superParameters.get(i).getVariance()),superArguments.get(i).getType(),subArguments.get(i).getType(),constraintPosition);
      }
      return;
    }
  }
  typeConstructorMismatch=true;
  errorConstraintPositions.add(constraintPosition);
}
