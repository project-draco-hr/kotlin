{
  PackageMemberDeclarationProvider cached=packageDeclarationProviders.get(packageFqName);
  if (cached != null) {
    return cached;
  }
  if (!isPackageDeclaredExplicitly(packageFqName)) {
    if (isPackageDeclaredExternally.apply(packageFqName)) {
      return EmptyPackageMemberDeclarationProvider.INSTANCE;
    }
    return null;
  }
  FileBasedPackageMemberDeclarationProvider provider=new FileBasedPackageMemberDeclarationProvider(storageManager,packageFqName,this,index.get().filesByPackage.get(packageFqName));
  PackageMemberDeclarationProvider oldValue=packageDeclarationProviders.putIfAbsent(packageFqName,provider);
  if (oldValue != null) {
    return oldValue;
  }
  return provider;
}
