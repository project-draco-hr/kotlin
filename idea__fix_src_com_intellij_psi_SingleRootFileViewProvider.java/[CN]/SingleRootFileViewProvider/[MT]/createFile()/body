{
  try {
    final VirtualFile vFile=getVirtualFile();
    if (vFile.isDirectory())     return null;
    if (isIgnored())     return null;
    final Project project=myManager.getProject();
    if (isPhysical()) {
      final VirtualFile parent=vFile.getParent();
      if (parent == null)       return null;
      final PsiDirectory psiDir=getManager().findDirectory(parent);
      if (psiDir == null)       return null;
    }
    FileType fileType=vFile.getFileType();
    PsiFile file=null;
    if (fileType.isBinary() || vFile.isSpecialFile()) {
      file=new ClsFileImpl((PsiManagerImpl)getManager(),this);
    }
 else {
      if (!isTooLarge(vFile)) {
        final PsiFile psiFile=createFile(getBaseLanguage());
        if (psiFile != null)         file=psiFile;
      }
 else {
        file=new PsiPlainTextFileImpl(this);
      }
    }
    return file;
  }
 catch (  ProcessCanceledException e) {
    e.printStackTrace();
    throw e;
  }
catch (  Throwable e) {
    e.printStackTrace();
    LOG.error(e);
    return null;
  }
}
