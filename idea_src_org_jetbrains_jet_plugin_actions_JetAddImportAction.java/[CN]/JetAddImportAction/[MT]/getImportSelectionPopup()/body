{
  return new BaseListPopupStep<FqName>(JetBundle.message("imports.chooser.title"),possibleImports){
    @Override public boolean isAutoSelectionEnabled(){
      return false;
    }
    @Override public PopupStep onChosen(    FqName selectedValue,    boolean finalChoice){
      if (selectedValue == null) {
        return FINAL_CHOICE;
      }
      if (finalChoice) {
        addImport(myElement,myProject,selectedValue);
        return FINAL_CHOICE;
      }
      List<String> toExclude=AddImportAction.getAllExcludableStrings(selectedValue.getFqName());
      return new BaseListPopupStep<String>(null,toExclude){
        @NotNull @Override public String getTextFor(        String value){
          return "Exclude '" + value + "' from auto-import";
        }
        @Override public PopupStep onChosen(        String selectedValue,        boolean finalChoice){
          if (finalChoice) {
            AddImportAction.excludeFromImport(myProject,selectedValue);
          }
          return super.onChosen(selectedValue,finalChoice);
        }
      }
;
    }
    @Override public boolean hasSubstep(    FqName selectedValue){
      return true;
    }
    @NotNull @Override public String getTextFor(    FqName value){
      return value.getFqName();
    }
    @Override public Icon getIconFor(    FqName aValue){
      return PlatformIcons.CLASS_ICON;
    }
  }
;
}
