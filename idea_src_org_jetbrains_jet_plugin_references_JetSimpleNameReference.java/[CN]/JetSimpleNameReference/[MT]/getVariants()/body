{
  PsiElement parent=myExpression.getParent();
  if (parent instanceof JetQualifiedExpression) {
    JetQualifiedExpression qualifiedExpression=(JetQualifiedExpression)parent;
    JetExpression receiverExpression=qualifiedExpression.getReceiverExpression();
    JetFile file=(JetFile)myExpression.getContainingFile();
    BindingContext bindingContext=AnalyzerFacade.analyzeFileWithCache(file);
    final JetType expressionType=bindingContext.get(BindingContext.EXPRESSION_TYPE,receiverExpression);
    if (expressionType != null) {
      return collectLookupElements(bindingContext,expressionType.getMemberScope());
    }
  }
 else {
    JetFile file=(JetFile)myExpression.getContainingFile();
    BindingContext bindingContext=AnalyzerFacade.analyzeFileWithCache(file);
    JetScope resolutionScope=bindingContext.get(BindingContext.RESOLUTION_SCOPE,myExpression);
    if (resolutionScope != null) {
      return collectLookupElements(bindingContext,resolutionScope);
    }
  }
  return EMPTY_ARRAY;
}
