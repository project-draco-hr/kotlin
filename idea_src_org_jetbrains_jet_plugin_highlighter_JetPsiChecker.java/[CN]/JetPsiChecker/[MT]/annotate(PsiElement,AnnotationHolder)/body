{
  if (!(JetPluginUtil.isInSource(element) || element.getContainingFile() instanceof JetCodeFragment) || JetPluginUtil.isKtFileInGradleProjectInWrongFolder(element)) {
    return;
  }
  for (  HighlightingVisitor visitor : getBeforeAnalysisVisitors(holder)) {
    element.accept(visitor);
  }
  JetFile file=(JetFile)element.getContainingFile();
  AnalyzeExhaust analyzeExhaust=ResolvePackage.getAnalysisResults(file);
  if (analyzeExhaust.isError()) {
    HighlighterPackage.updateHighlightingResult(file,true);
    throw new ProcessCanceledException(analyzeExhaust.getError());
  }
  BindingContext bindingContext=analyzeExhaust.getBindingContext();
  for (  HighlightingVisitor visitor : getAfterAnalysisVisitor(holder,bindingContext)) {
    element.accept(visitor);
  }
  annotateElement(element,holder,bindingContext.getDiagnostics());
  if (element instanceof JetFile) {
    HighlighterPackage.updateHighlightingResult(file,false);
  }
}
