{
  final Alignment parameterAlignment=shouldAlignChild ? Alignment.createAlignment() : null;
  final Alignment bracketsAlignment=shouldAlignParenthesis ? Alignment.createAlignment() : null;
  return new NodeAlignmentStrategy(){
    @Override public Alignment getAlignment(    @NotNull ASTNode node){
      IElementType childNodeType=node.getElementType();
      ASTNode prev=getPrevWithoutWhitespace(node);
      if ((prev != null && prev.getElementType() == TokenType.ERROR_ELEMENT) || childNodeType == TokenType.ERROR_ELEMENT) {
        return parameterAlignment;
      }
      if (childNodeType == openBracket || childNodeType == closeBracket) {
        return bracketsAlignment;
      }
      if (childNodeType == parameter || childNodeType == delimiter) {
        return parameterAlignment;
      }
      return null;
    }
  }
;
}
