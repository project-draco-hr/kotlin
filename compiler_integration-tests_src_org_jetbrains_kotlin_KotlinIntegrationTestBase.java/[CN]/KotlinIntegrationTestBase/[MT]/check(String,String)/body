{
  File actualFile=new File(testDataDir,baseName + ".actual");
  File expectedFile=new File(testDataDir,baseName + ".expected");
  String normalizedContent=normalizeOutput(content);
  if (!expectedFile.isFile()) {
    Files.write(normalizedContent,actualFile,Charsets.UTF_8);
    fail("No .expected file " + expectedFile);
  }
 else {
    String goldContent=FileUtil.loadFile(expectedFile,CharsetToolkit.UTF8,true);
    try {
      assertEquals(goldContent,normalizedContent);
      actualFile.delete();
    }
 catch (    ComparisonFailure e) {
      Files.write(normalizedContent,actualFile,Charsets.UTF_8);
      throw e;
    }
  }
}
