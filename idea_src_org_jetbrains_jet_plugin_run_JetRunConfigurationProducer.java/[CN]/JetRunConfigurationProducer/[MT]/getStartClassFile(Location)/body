{
  PsiFile psiFile=location.getPsiElement().getContainingFile();
  if (psiFile instanceof JetFile) {
    JetFile jetFile=(JetFile)psiFile;
    final ResolveSessionForBodies session=ResolvePackage.getLazyResolveSession(jetFile);
    MainFunctionDetector mainFunctionDetector=new MainFunctionDetector(new NotNullFunction<JetNamedFunction,FunctionDescriptor>(){
      @NotNull @Override public FunctionDescriptor fun(      JetNamedFunction function){
        return (FunctionDescriptor)session.resolveToDescriptor(function);
      }
    }
);
    if (mainFunctionDetector.hasMain(jetFile.getDeclarations())) {
      return jetFile;
    }
  }
  return null;
}
