{
  String text=declareCheckType ? clearText + CHECK_TYPE_DECLARATIONS : clearText;
  if (declareFlexibleType) {
    Pattern pattern=Pattern.compile("^package [\\.\\w\\d]*\n",Pattern.MULTILINE);
    Matcher matcher=pattern.matcher(text);
    if (matcher.find()) {
      text=text.substring(0,matcher.end()) + EXPLICIT_FLEXIBLE_TYPES_IMPORT + "\n"+ text.substring(matcher.end());
    }
 else {
      text=EXPLICIT_FLEXIBLE_TYPES_IMPORT + "\n" + text;
    }
  }
  return text;
}
