{
  JetSimpleNameExpression operationSign=expression.getOperationSign();
  IElementType operationType=operationSign.getReferencedNameElementType();
  String name=unaryOperationNames.get(operationType);
  if (name == null) {
    semanticServices.getErrorHandler().genericError(operationSign.getNode(),"Unknown unary operation");
  }
 else {
    JetType receiverType=getType(scope,expression.getBaseExpression(),false);
    if (receiverType != null) {
      FunctionDescriptor functionDescriptor=lookupFunction(scope,expression.getOperationSign(),name,receiverType,Collections.<JetType>emptyList(),true);
      if (functionDescriptor != null) {
        JetType returnType=functionDescriptor.getUnsubstitutedReturnType();
        if (operationType == JetTokens.PLUSPLUS || operationType == JetTokens.MINUSMINUS) {
          if (!semanticServices.getTypeChecker().isSubtypeOf(returnType,receiverType)) {
            semanticServices.getErrorHandler().genericError(operationSign.getNode(),name + " must return " + receiverType+ " but returns "+ returnType);
          }
          result=receiverType;
        }
 else {
          result=returnType;
        }
      }
    }
  }
}
