{
  TypeInferenceContext context=contextWithExpectedType.replaceExpectedType(NO_EXPECTED_TYPE);
  JetType knownType=getType(expression.getLeftHandSide(),context.replaceScope(context.scope));
  JetPattern pattern=expression.getPattern();
  if (pattern != null && knownType != null) {
    WritableScopeImpl scopeToExtend=newWritableScopeImpl(context.scope,context.trace).setDebugName("Scope extended in 'is'");
    DataFlowInfo newDataFlowInfo=checkPatternType(pattern,knownType,scopeToExtend,context,context.services.getVariableDescriptorFromSimpleName(expression.getLeftHandSide(),context));
    patternsToDataFlowInfo.put(pattern,newDataFlowInfo);
    patternsToBoundVariableLists.put(pattern,scopeToExtend.getDeclaredVariables());
  }
  return context.services.checkType(semanticServices.getStandardLibrary().getBooleanType(),expression,contextWithExpectedType);
}
