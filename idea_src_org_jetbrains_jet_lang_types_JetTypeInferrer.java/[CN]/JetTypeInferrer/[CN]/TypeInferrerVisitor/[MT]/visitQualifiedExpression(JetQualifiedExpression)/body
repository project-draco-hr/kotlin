{
  JetExpression selectorExpression=expression.getSelectorExpression();
  JetExpression receiverExpression=expression.getReceiverExpression();
  JetType receiverType=getType(scope,receiverExpression,false);
  if (receiverType != null) {
    checkNullSafety(receiverType,expression);
    JetType selectorReturnType=getSelectorReturnType(receiverType,selectorExpression);
    if (expression.getOperationSign() == JetTokens.QUEST) {
      if (selectorReturnType != null && !isBoolean(selectorReturnType)) {
        semanticServices.getErrorHandler().typeMismatch(selectorExpression,semanticServices.getStandardLibrary().getBooleanType(),selectorReturnType);
      }
      result=TypeUtils.makeNullable(receiverType);
    }
 else {
      result=selectorReturnType;
    }
  }
}
