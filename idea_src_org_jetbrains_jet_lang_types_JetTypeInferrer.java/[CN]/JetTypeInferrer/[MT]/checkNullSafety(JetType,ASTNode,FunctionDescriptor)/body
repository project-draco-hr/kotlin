{
  if (receiverType != null && callee != null) {
    boolean namespaceType=receiverType instanceof NamespaceType;
    JetType calleeReceiverType=callee.getReceiverType();
    boolean nullableReceiver=!namespaceType && receiverType.isNullable();
    boolean calleeForbidsNullableReceiver=calleeReceiverType == null || !calleeReceiverType.isNullable();
    IElementType operationSign=operationTokenNode.getElementType();
    if (nullableReceiver && calleeForbidsNullableReceiver && operationSign == JetTokens.DOT) {
      trace.getErrorHandler().genericError(operationTokenNode,"Only safe calls (?.) are allowed on a nullable receiver of type " + receiverType);
    }
 else     if ((!nullableReceiver || !calleeForbidsNullableReceiver) && operationSign == JetTokens.SAFE_ACCESS) {
      if (namespaceType) {
        trace.getErrorHandler().genericError(operationTokenNode,"Safe calls are not allowed on namespaces");
      }
 else {
        trace.getErrorHandler().genericWarning(operationTokenNode,"Unnecessary safe call on a non-null receiver of type  " + receiverType);
      }
    }
  }
}
