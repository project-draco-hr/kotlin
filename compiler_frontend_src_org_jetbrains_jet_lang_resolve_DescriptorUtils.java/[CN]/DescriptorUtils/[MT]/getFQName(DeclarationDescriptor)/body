{
  DeclarationDescriptor containingDeclaration=descriptor.getContainingDeclaration();
  if (descriptor instanceof ModuleDescriptor || containingDeclaration instanceof ModuleDescriptor) {
    return FqName.ROOT.toUnsafe();
  }
  if (containingDeclaration == null) {
    if (descriptor instanceof NamespaceDescriptor) {
      if (descriptor.getName().equals("jet")) {
        return FqNameUnsafe.topLevel("jet");
      }
      if (descriptor.getName().equals("<java_root>")) {
        return FqName.ROOT.toUnsafe();
      }
    }
    throw new IllegalStateException("descriptor is not module descriptor and has null containingDeclaration: " + containingDeclaration);
  }
  return getFQName(containingDeclaration).child(descriptor.getName());
}
