{
  if (!DescriptorResolverUtils.isCorrectOwnerForEnumMember(ownerDescriptor,method)) {
    return null;
  }
  JavaType returnJavaType=method.getReturnType();
  if (returnJavaType == null) {
    return null;
  }
  SimpleFunctionDescriptor alreadyResolved=trace.get(BindingContext.FUNCTION,method.getPsi());
  if (alreadyResolved != null) {
    return alreadyResolved;
  }
  SimpleFunctionDescriptorImpl functionDescriptorImpl=new SimpleFunctionDescriptorImpl(ownerDescriptor,annotationResolver.resolveAnnotations(method),method.getName(),CallableMemberDescriptor.Kind.DECLARATION);
  JavaTypeParameterResolver.Initializer typeParameterInitializer=typeParameterResolver.resolveTypeParameters(functionDescriptorImpl,method);
  typeParameterInitializer.initialize();
  List<TypeParameterDescriptor> methodTypeParameters=typeParameterInitializer.getDescriptors();
  TypeVariableResolver typeVariableResolver=new TypeVariableResolver(methodTypeParameters,functionDescriptorImpl);
  JavaValueParameterResolver.ValueParameters valueParameters=valueParameterResolver.resolveValueParameters(functionDescriptorImpl,method,typeVariableResolver);
  JetType returnType=makeReturnType(returnJavaType,method,typeVariableResolver);
  List<String> signatureErrors=Lists.newArrayList();
  List<FunctionDescriptor> superFunctions;
  if (ownerDescriptor instanceof ClassDescriptor) {
    SignaturesPropagationData signaturesPropagationData=new SignaturesPropagationData((ClassDescriptor)ownerDescriptor,returnType,valueParameters,methodTypeParameters,method,trace);
    superFunctions=signaturesPropagationData.getSuperFunctions();
    returnType=signaturesPropagationData.getModifiedReturnType();
    valueParameters=signaturesPropagationData.getModifiedValueParameters();
    methodTypeParameters=signaturesPropagationData.getModifiedTypeParameters();
    signatureErrors.addAll(signaturesPropagationData.getSignatureErrors());
  }
 else {
    superFunctions=Collections.emptyList();
  }
  AlternativeMethodSignatureData alternativeMethodSignatureData=new AlternativeMethodSignatureData(method,valueParameters,returnType,methodTypeParameters,!superFunctions.isEmpty());
  if (alternativeMethodSignatureData.isAnnotated() && !alternativeMethodSignatureData.hasErrors()) {
    valueParameters=alternativeMethodSignatureData.getValueParameters();
    returnType=alternativeMethodSignatureData.getReturnType();
    methodTypeParameters=alternativeMethodSignatureData.getTypeParameters();
  }
 else   if (alternativeMethodSignatureData.hasErrors()) {
    signatureErrors.add(alternativeMethodSignatureData.getError());
  }
  functionDescriptorImpl.initialize(valueParameters.getReceiverType(),DescriptorUtils.getExpectedThisObjectIfNeeded(ownerDescriptor),methodTypeParameters,valueParameters.getDescriptors(),returnType,Modality.convertFromFlags(method.isAbstract(),!method.isFinal()),method.getVisibility(),false);
  if (functionDescriptorImpl.getKind() == CallableMemberDescriptor.Kind.DECLARATION && record) {
    BindingContextUtils.recordFunctionDeclarationToDescriptor(trace,method.getPsi(),functionDescriptorImpl);
  }
  if (record) {
    trace.record(JavaBindingContext.IS_DECLARED_IN_JAVA,functionDescriptorImpl);
  }
  if (!RawTypesCheck.hasRawTypesInHierarchicalSignature(method) && JavaMethodSignatureUtil.isMethodReturnTypeCompatible(method) && !containsErrorType(superFunctions,functionDescriptorImpl)) {
    if (signatureErrors.isEmpty()) {
      checkFunctionsOverrideCorrectly(method,superFunctions,functionDescriptorImpl);
    }
 else {
      if (record) {
        trace.record(JavaBindingContext.LOAD_FROM_JAVA_SIGNATURE_ERRORS,functionDescriptorImpl,signatureErrors);
      }
    }
  }
  return functionDescriptorImpl;
}
