{
  if (PsiUtilBase.getLanguageAtOffset(file,offset).isKindOf(JetLanguage.INSTANCE)) {
    PsiElement element=file.findElementAt(offset);
    if (element instanceof PsiWhiteSpace || element instanceof PsiComment) {
      return false;
    }
 else     if (PsiTreeUtil.getParentOfType(element,JetPackageDirective.class) != null || PsiTreeUtil.getParentOfType(element,JetImportDirective.class) != null) {
      return false;
    }
 else     if (element instanceof LeafPsiElement) {
      IElementType elementType=((LeafPsiElement)element).getElementType();
      if (elementType == JetTokens.IDENTIFIER) {
        if (element.getParent() instanceof JetReferenceExpression) {
          PsiElement parentOfParent=element.getParent().getParent();
          JetQualifiedExpression qualifiedExpression=PsiTreeUtil.getParentOfType(element,JetQualifiedExpression.class);
          if (qualifiedExpression != null && qualifiedExpression.getSelectorExpression() == parentOfParent) {
            return false;
          }
        }
 else {
          return false;
        }
      }
    }
    return element != null && isInContext(element);
  }
  return false;
}
