{
  if (modifierList == null)   return defaultModality;
  checkCompatibility(trace,modifierList,Lists.newArrayList(JetTokens.ABSTRACT_KEYWORD,JetTokens.OPEN_KEYWORD,JetTokens.FINAL_KEYWORD),Lists.<JetToken>newArrayList(JetTokens.ABSTRACT_KEYWORD,JetTokens.OPEN_KEYWORD));
  boolean hasAbstractModifier=modifierList.hasModifier(JetTokens.ABSTRACT_KEYWORD);
  boolean hasOverrideModifier=modifierList.hasModifier(JetTokens.OVERRIDE_KEYWORD);
  if (modifierList.hasModifier(JetTokens.OPEN_KEYWORD)) {
    if (hasAbstractModifier || hasOverrideModifier) {
      trace.report(Errors.REDUNDANT_MODIFIER.on(modifierList,JetTokens.OPEN_KEYWORD,hasAbstractModifier ? JetTokens.ABSTRACT_KEYWORD : JetTokens.OVERRIDE_KEYWORD));
    }
    if (hasAbstractModifier || defaultModality == Modality.ABSTRACT) {
      return Modality.ABSTRACT;
    }
    return Modality.OPEN;
  }
  if (hasAbstractModifier) {
    return Modality.ABSTRACT;
  }
  boolean hasFinalModifier=modifierList.hasModifier(JetTokens.FINAL_KEYWORD);
  if (hasOverrideModifier && !hasFinalModifier && !(defaultModality == Modality.ABSTRACT)) {
    return Modality.OPEN;
  }
  if (hasFinalModifier) {
    return Modality.FINAL;
  }
  return defaultModality;
}
