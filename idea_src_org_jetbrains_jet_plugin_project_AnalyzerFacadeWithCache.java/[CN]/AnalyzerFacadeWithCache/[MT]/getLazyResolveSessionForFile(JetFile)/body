{
  Project project=file.getProject();
  DeclarationsCacheProvider provider=KotlinCacheManager.getInstance(project).getRegisteredProvider(TargetPlatformDetector.getPlatform(file));
  if (!provider.areDeclarationsAvailable(file)) {
    CachedValue<CancelableResolveSession> cachedValue;
synchronized (PER_FILE_SESSION_CACHE) {
      cachedValue=PER_FILE_SESSION_CACHE.get(file);
    }
    return cachedValue.getValue();
  }
  return provider.getLazyResolveSession();
}
