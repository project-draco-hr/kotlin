{
  JetStandardLibrary standardLibrary=JetStandardLibrary.getInstance();
  StaticContext staticContext=StaticContext.generateStaticContext(standardLibrary,bindingContext,config.getTarget());
  JsProgram program=staticContext.getProgram();
  JsBlock block=program.getGlobalBlock();
  JsFunction rootFunction=JsAstUtils.createPackage(block.getStatements(),program.getScope());
  JsBlock rootBlock=rootFunction.getBody();
  List<JsStatement> statements=rootBlock.getStatements();
  statements.add(program.getStringLiteral("use strict").makeStmt());
  TranslationContext context=TranslationContext.rootContext(staticContext);
  statements.addAll(translateFiles(files,context));
  TranslationUtils.defineModule(context,statements,config.getModuleId());
  if (mainCallParameters.shouldBeGenerated()) {
    JsStatement statement=generateCallToMain(context,files,mainCallParameters.arguments());
    if (statement != null) {
      statements.add(statement);
    }
  }
  JSTestGenerator.generateTestCalls(context,files,rootBlock);
  performSimpleNameMangling(context.program());
  return context.program();
}
