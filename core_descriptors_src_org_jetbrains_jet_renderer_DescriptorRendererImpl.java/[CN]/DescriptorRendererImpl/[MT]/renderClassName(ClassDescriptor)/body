{
  if (klass instanceof MissingDependencyErrorClass) {
    return ((MissingDependencyErrorClass)klass).getFullFqName().asString();
  }
  if (ErrorUtils.isError(klass)) {
    return klass.getTypeConstructor().toString();
  }
  if (shortNames) {
    List<Name> qualifiedNameElements=Lists.newArrayList();
    DeclarationDescriptor current=klass;
    do {
      if (((ClassDescriptor)current).getKind() != ClassKind.CLASS_OBJECT) {
        qualifiedNameElements.add(current.getName());
      }
      current=current.getContainingDeclaration();
    }
 while (current instanceof ClassDescriptor);
    Collections.reverse(qualifiedNameElements);
    return renderFqName(qualifiedNameElements);
  }
  return renderFqName(DescriptorUtils.getFqName(klass));
}
