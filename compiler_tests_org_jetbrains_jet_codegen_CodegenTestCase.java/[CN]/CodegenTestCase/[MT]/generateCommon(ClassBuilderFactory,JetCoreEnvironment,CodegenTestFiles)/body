{
  AnalyzeExhaust analyzeExhaust=AnalyzerFacadeForJVM.analyzeFilesWithJavaIntegrationAndCheckForErrors(environment.getProject(),files.getPsiFiles(),files.getScriptParameterTypes(),Predicates.<PsiFile>alwaysTrue(),BuiltinsScopeExtensionMode.ALL);
  analyzeExhaust.throwIfError();
  AnalyzingUtils.throwExceptionOnErrors(analyzeExhaust.getBindingContext());
  GenerationState state=new GenerationState(environment.getProject(),classBuilderFactory,Progress.DEAF,analyzeExhaust,files.getPsiFiles(),environment.getConfiguration().get(JVMConfigurationKeys.BUILTIN_TO_JAVA_TYPES_MAPPING_KEY,BuiltinToJavaTypesMapping.ENABLED),environment.getConfiguration().get(JVMConfigurationKeys.GENERATE_NOT_NULL_ASSERTIONS,true));
  GenerationStrategy.STANDARD.compileCorrectFiles(state,CompilationErrorHandler.THROW_EXCEPTION);
  return state;
}
