{
  KtExpression left=KtPsiUtil.deparenthesize(lhs);
  if (left == null) {
    List<PseudoValue> arguments=Collections.singletonList(rhsDeferredValue.invoke());
    builder.magic(parentExpression,parentExpression,arguments,MagicKind.UNSUPPORTED_ELEMENT);
    return;
  }
  if (left instanceof KtArrayAccessExpression) {
    generateArrayAssignment((KtArrayAccessExpression)left,rhsDeferredValue,parentExpression);
    return;
  }
  Map<PseudoValue,ReceiverValue> receiverValues=SmartFMap.emptyMap();
  AccessTarget accessTarget=AccessTarget.BlackBox.INSTANCE;
  if (left instanceof KtSimpleNameExpression || left instanceof KtQualifiedExpression) {
    accessTarget=getResolvedCallAccessTarget(KtPsiUtilKt.getQualifiedElementSelector(left));
    if (accessTarget instanceof AccessTarget.Call) {
      receiverValues=getReceiverValues(((AccessTarget.Call)accessTarget).getResolvedCall());
    }
  }
 else   if (left instanceof KtProperty) {
    accessTarget=getDeclarationAccessTarget(left);
  }
  if (accessTarget == AccessTarget.BlackBox.INSTANCE && !(left instanceof KtProperty)) {
    generateInstructions(left);
    createSyntheticValue(left,MagicKind.VALUE_CONSUMER,left);
  }
  PseudoValue rightValue=rhsDeferredValue.invoke();
  PseudoValue rValue=rightValue != null ? rightValue : createSyntheticValue(parentExpression,MagicKind.UNRECOGNIZED_WRITE_RHS);
  builder.write(parentExpression,left,rValue,accessTarget,receiverValues);
}
