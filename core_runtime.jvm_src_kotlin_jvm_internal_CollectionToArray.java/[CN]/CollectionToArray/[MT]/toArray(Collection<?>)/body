{
  int size=collection.size();
  if (size == 0)   return EMPTY_OBJECT_ARRAY;
  Object[] r=new Object[size];
  Iterator<?> it=collection.iterator();
  for (int i=0; i < size; i++) {
    if (!it.hasNext()) {
      return Arrays.copyOf(r,i);
    }
    r[i]=it.next();
  }
  return it.hasNext() ? finishToArray(r,it) : r;
}
