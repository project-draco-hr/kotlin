{
  JetPsiFactory.IfChainBuilder builder=new JetPsiFactory.IfChainBuilder();
  List<JetWhenEntry> entries=whenExpression.getEntries();
  for (  JetWhenEntry entry : entries) {
    JetExpression branch=entry.getExpression();
    if (entry.isElse()) {
      builder.elseBranch(branch);
    }
 else {
      String branchConditionText=combineWhenConditions(entry.getConditions(),whenExpression.getSubjectExpression());
      builder.ifBranch(branchConditionText,branch != null ? branch.getText() : "");
    }
  }
  whenExpression.replace(builder.toExpression(whenExpression.getProject()));
}
