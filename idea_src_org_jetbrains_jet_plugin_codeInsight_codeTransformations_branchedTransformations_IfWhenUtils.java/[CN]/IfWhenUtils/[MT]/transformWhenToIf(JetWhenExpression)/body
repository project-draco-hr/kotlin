{
  JetPsiFactory.IfChainBuilder builder=new JetPsiFactory.IfChainBuilder();
  List<JetWhenEntry> entries=whenExpression.getEntries();
  for (  JetWhenEntry entry : entries) {
    JetExpression branch=entry.getExpression();
    assertNotNull(branch);
    if (entry.isElse()) {
      builder.elseBranch(branch);
    }
 else {
      String branchConditionText=combineWhenConditions(entry.getConditions(),whenExpression.getSubjectExpression());
      JetExpression branchExpression=entry.getExpression();
      assertNotNull(branchExpression);
      builder.ifBranch(branchConditionText,branchExpression.getText());
    }
  }
  whenExpression.replace(builder.toExpression(whenExpression.getProject()));
}
