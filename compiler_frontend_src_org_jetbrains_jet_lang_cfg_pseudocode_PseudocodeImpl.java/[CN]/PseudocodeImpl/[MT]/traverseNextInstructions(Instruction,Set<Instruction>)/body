{
  Deque<Instruction> stack=Queues.newArrayDeque();
  stack.push(rootInstruction);
  List<Instruction> nextInstructions=Lists.newArrayList();
  while (!stack.isEmpty()) {
    final Instruction instruction=stack.pop();
    if (visited.contains(instruction))     continue;
    visited.add(instruction);
    nextInstructions.addAll(instruction.getNextInstructions());
    for (    Instruction nextInstruction : Lists.reverse(nextInstructions)) {
      if (nextInstruction == null)       continue;
      stack.push(nextInstruction);
    }
    nextInstructions.clear();
  }
}
