{
  Deque<Instruction> stack=Queues.newArrayDeque();
  stack.push(rootInstruction);
  while (!stack.isEmpty()) {
    Instruction instruction=stack.pop();
    visited.add(instruction);
    Collection<Instruction> followingInstructions=directOrder ? instruction.getNextInstructions() : instruction.getPreviousInstructions();
    for (    Instruction followingInstruction : followingInstructions) {
      if (followingInstruction != null && !visited.contains(followingInstruction)) {
        stack.push(followingInstruction);
      }
    }
  }
}
