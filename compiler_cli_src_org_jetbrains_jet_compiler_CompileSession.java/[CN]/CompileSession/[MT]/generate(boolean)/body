{
  Project project=environment.getProject();
  GenerationState generationState=new GenerationState(project,ClassBuilderFactories.binaries(stubs),verbose ? new BackendProgress() : Progress.DEAF,bindingContext,environment.getSourceFiles(),compilerDependencies.getCompilerSpecialMode());
  generationState.compileCorrectFiles(CompilationErrorHandler.THROW_EXCEPTION);
  List<CompilerPlugin> plugins=environment.getCompilerPlugins();
  if (!module) {
    if (plugins != null) {
      CompilerPluginContext context=new CompilerPluginContext(project,bindingContext.getBindingContext(),environment.getSourceFiles());
      for (      CompilerPlugin plugin : plugins) {
        plugin.processFiles(context);
      }
    }
  }
  return generationState;
}
