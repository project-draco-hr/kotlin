{
  if (type == null)   return;
  if (isBareTypeParameterWithNullableUpperBound(type)) {
    return;
  }
  if (TypesPackage.isFlexible(type)) {
    Flexibility flexibility=TypesPackage.flexibility(type);
    if (!TypeUtils.isNullableType(flexibility.getLowerBound()) && TypeUtils.isNullableType(flexibility.getUpperBound())) {
      return;
    }
  }
  boolean isNullableType=TypeUtils.isNullableType(type);
  Class<?> annotationClass=isNullableType ? Nullable.class : NotNull.class;
  String descriptor=Type.getType(annotationClass).getDescriptor();
  if (!annotationDescriptorsAlreadyPresent.contains(descriptor)) {
    visitAnnotation(descriptor,false).visitEnd();
  }
}
