{
  if (arguments.isHelp()) {
    usage(errStream);
    return OK;
  }
  MessageRenderer messageRenderer=getMessageRenderer(arguments);
  errStream.print(messageRenderer.renderPreamble());
  printVersionIfNeeded(errStream,arguments,messageRenderer);
  PrintingMessageCollector messageCollector=new PrintingMessageCollector(errStream,messageRenderer,arguments.isVerbose());
  try {
    return exec(messageCollector,arguments);
  }
  finally {
    messageCollector.printToErrStream();
    errStream.print(messageRenderer.renderConclusion());
  }
}
