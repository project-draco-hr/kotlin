{
  if (descriptor instanceof PackageFragmentDescriptor) {
    return new PackageContext((PackageFragmentDescriptor)descriptor,null,null);
  }
  CodegenContext parent=getContext(descriptor.getContainingDeclaration(),state);
  if (descriptor instanceof ClassDescriptor) {
    OwnerKind kind=DescriptorUtils.isTrait(descriptor) ? OwnerKind.TRAIT_IMPL : OwnerKind.IMPLEMENTATION;
    return parent.intoClass((ClassDescriptor)descriptor,kind,state);
  }
 else   if (descriptor instanceof FunctionDescriptor) {
    return parent.intoFunction((FunctionDescriptor)descriptor);
  }
  throw new IllegalStateException("Couldn't build context for " + descriptorName(descriptor));
}
