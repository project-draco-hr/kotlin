{
  Project project=returnExpression.getProject();
  JetIfExpression ifExpression=(JetIfExpression)returnExpression.getReturnedExpression();
  assertNotNull(ifExpression);
  JetIfExpression newIfExpression=(JetIfExpression)ifExpression.copy();
  JetExpression thenExpr=getOutermostLastBlockElement(newIfExpression.getThen());
  JetExpression elseExpr=getOutermostLastBlockElement(newIfExpression.getElse());
  assertNotNull(thenExpr);
  assertNotNull(elseExpr);
  thenExpr.replace(JetPsiFactory.createReturn(project,thenExpr));
  elseExpr.replace(JetPsiFactory.createReturn(project,elseExpr));
  returnExpression.replace(newIfExpression);
}
