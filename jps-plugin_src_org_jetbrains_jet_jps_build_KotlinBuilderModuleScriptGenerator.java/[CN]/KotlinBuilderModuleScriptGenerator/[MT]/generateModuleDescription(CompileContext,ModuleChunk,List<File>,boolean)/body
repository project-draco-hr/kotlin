{
  KotlinModuleDescriptionBuilder builder=FACTORY.create();
  boolean noSources=true;
  Set<File> outputDirs=new HashSet<File>();
  for (  ModuleBuildTarget target : chunk.getTargets()) {
    outputDirs.add(getOutputDir(target));
  }
  ProjectBuilderLogger logger=context.getLoggingManager().getProjectBuilderLogger();
  for (  ModuleBuildTarget target : chunk.getTargets()) {
    File outputDir=getOutputDir(target);
    if (!IncrementalCompilation.ENABLED) {
      sourceFiles=new ArrayList<File>(KotlinSourceFileCollector.getAllKotlinSourceFiles(target));
    }
    if (sourceFiles.size() > 0 || hasRemovedFiles) {
      noSources=false;
      if (logger.isEnabled()) {
        logger.logCompiledFiles(sourceFiles,KotlinBuilder.KOTLIN_BUILDER_NAME,"Compiling files:");
      }
    }
    builder.addModule(target.getId(),outputDir.getAbsolutePath(),getIncrementalCacheDir(context).getAbsolutePath(),getKotlinModuleDependencies(context,target),sourceFiles,target.isTests(),outputDirs);
  }
  if (noSources)   return null;
  String scriptFilename=context.getProjectDescriptor().dataManager.getDataPaths().getDataStorageRoot().getName() + "#" + StringUtil.sanitizeJavaIdentifier(chunk.getName());
  File scriptFile=new File(PathManager.getTempPath() + File.separator + scriptFilename+ ".script."+ FACTORY.getFileExtension());
  writeScriptToFile(context,builder.asText(),scriptFile);
  return scriptFile;
}
