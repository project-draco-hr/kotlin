{
  File outputDir=target.getOutputDir();
  if (outputDir == null) {
    throw new IllegalStateException("No output directory found for " + target);
  }
  CharSequence moduleScriptText=GENERATOR.generateModuleScript(target.getId(),outputDir.getAbsolutePath(),getKotlinModuleDependencies(context,target),sourceFiles,target.isTests(),Collections.singleton(outputDir));
  File scriptFile=new File(outputDir,"script." + GENERATOR.getFileExtension());
  writeScriptToFile(context,moduleScriptText,scriptFile);
  return scriptFile;
}
