{
  final PsiAnonymousClass anonymousClass=expression.getAnonymousClass();
  final PsiMethod constructor=expression.resolveMethod();
  PsiJavaCodeReferenceElement classReference=expression.getClassOrAnonymousClassReference();
  final boolean isNotConvertedClass=classReference != null && !getConverter().getClassIdentifiers().contains(classReference.getQualifiedName());
  PsiExpressionList argumentList=expression.getArgumentList();
  PsiExpression[] arguments=argumentList != null ? argumentList.getExpressions() : new PsiExpression[]{};
  if (constructor == null || isConstructorPrimary(constructor) || isNotConvertedClass) {
    return new NewClassExpression(getConverter().expressionToExpression(expression.getQualifier()),getConverter().elementToElement(classReference),getConverter().expressionsToExpressionList(arguments),getConverter().createConversions(expression),anonymousClass != null ? getConverter().anonymousClassToAnonymousClass(anonymousClass) : null);
  }
  final PsiJavaCodeReferenceElement reference=expression.getClassReference();
  final List<Type> typeParameters=reference != null ? getConverter().typesToTypeList(reference.getTypeParameters()) : Collections.<Type>emptyList();
  return new CallChainExpression(new IdentifierImpl(constructor.getName(),false),new MethodCallExpression(new IdentifierImpl("init"),getConverter().expressionsToExpressionList(arguments),typeParameters));
}
