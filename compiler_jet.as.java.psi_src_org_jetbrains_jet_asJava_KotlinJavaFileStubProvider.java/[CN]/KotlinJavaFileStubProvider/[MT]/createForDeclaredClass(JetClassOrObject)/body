{
  return new KotlinJavaFileStubProvider<OutermostKotlinClassLightClassData>(classOrObject.getProject(),JetPsiUtil.isLocal(classOrObject),new StubGenerationStrategy.WithDeclaredClasses<OutermostKotlinClassLightClassData>(){
    private JetFile getFile(){
      return (JetFile)classOrObject.getContainingFile();
    }
    @NotNull @Override public LightClassConstructionContext getContext(    @NotNull Collection<JetFile> files){
      return LightClassGenerationSupport.getInstance(classOrObject.getProject()).getContextForClassOrObject(classOrObject);
    }
    @NotNull @Override public OutermostKotlinClassLightClassData createLightClassData(    PsiJavaFileStub javaFileStub,    BindingContext bindingContext){
      ClassDescriptor classDescriptor=bindingContext.get(BindingContext.CLASS,classOrObject);
      if (classDescriptor == null) {
        return new OutermostKotlinClassLightClassData(javaFileStub,"",classOrObject,null,Collections.<JetClassOrObject,InnerKotlinClassLightClassData>emptyMap());
      }
      String jvmInternalName=CodegenBinding.getJvmInternalName(bindingContext,classDescriptor);
      Collection<ClassDescriptor> allInnerClasses=CodegenBinding.getAllInnerClasses(bindingContext,classDescriptor);
      Map<JetClassOrObject,InnerKotlinClassLightClassData> innerClassesMap=ContainerUtil.newHashMap();
      for (      ClassDescriptor innerClassDescriptor : allInnerClasses) {
        JetClassOrObject innerClass=(JetClassOrObject)BindingContextUtils.descriptorToDeclaration(bindingContext,innerClassDescriptor);
        if (innerClass == null)         continue;
        InnerKotlinClassLightClassData innerLightClassData=new InnerKotlinClassLightClassData(CodegenBinding.getJvmInternalName(bindingContext,innerClassDescriptor),innerClass,innerClassDescriptor);
        innerClassesMap.put(innerClass,innerLightClassData);
      }
      return new OutermostKotlinClassLightClassData(javaFileStub,jvmInternalName,classOrObject,classDescriptor,innerClassesMap);
    }
    @NotNull @Override public Collection<JetFile> getFiles(){
      return Collections.singletonList(getFile());
    }
    @NotNull @Override public FqName getPackageFqName(){
      return JetPsiUtil.getFQName(getFile());
    }
    @Override public void generate(    @NotNull GenerationState state,    @NotNull Collection<JetFile> files){
      PackageCodegen packageCodegen=state.getFactory().forPackage(getPackageFqName(),files);
      packageCodegen.generateClassOrObject(classOrObject);
      state.getFactory().asList();
    }
  }
);
}
