{
  File tempDir=FileUtil.createTempDirectory("compilerTest","compilerTest");
  try {
    File stdlib=ForTestCompileRuntime.runtimeJarForTests();
    File jdkAnnotations=JetTestUtils.getJdkAnnotationsJar();
    File resultJar=new File(tempDir,"result.jar");
    ExitCode rv=new K2JVMCompiler().exec(System.out,"-module",JetTestCaseBuilder.getTestDataPathBase() + "/compiler/smoke/Smoke.ktm","-d",resultJar.getAbsolutePath(),"-no-stdlib","-classpath",stdlib.getAbsolutePath(),"-no-jdk-annotations","-annotations",jdkAnnotations.getAbsolutePath());
    Assert.assertEquals("compilation completed with non-zero code",ExitCode.OK,rv);
    FileInputStream fileInputStream=new FileInputStream(resultJar);
    try {
      JarInputStream is=new JarInputStream(fileInputStream);
      try {
        List<String> entries=listEntries(is);
        assertTrue(entries.contains("Smoke/" + PackageClassUtils.getPackageClassName(new FqName("Smoke")) + ".class"));
        assertEquals(2,entries.size());
      }
  finally {
        is.close();
      }
    }
  finally {
      fileInputStream.close();
    }
  }
  finally {
    FileUtil.delete(tempDir);
  }
}
