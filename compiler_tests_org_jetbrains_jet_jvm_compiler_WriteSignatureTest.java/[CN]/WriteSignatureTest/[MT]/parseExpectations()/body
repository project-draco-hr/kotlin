{
  List<String> lines=Files.readLines(ktFile,Charset.forName("utf-8"));
  for (int i=0; i < lines.size() - 2; ++i) {
    String line=lines.get(i);
    Matcher methodMatcher=methodPattern.matcher(line);
    Matcher classMatcher=classPattern.matcher(line);
    boolean isMethod=methodMatcher.matches();
    boolean isClass=classMatcher.matches();
    Matcher matcher=isMethod ? methodMatcher : classMatcher;
    if (isMethod || isClass) {
      Matcher jvmSignatureMatcher=jvmSignaturePattern.matcher(lines.get(i + 1));
      Matcher genericSignatureMatcher=genericSignaturePattern.matcher(lines.get(i + 2));
      if (!jvmSignatureMatcher.matches() || !genericSignatureMatcher.matches()) {
        throw new AssertionError("'method:' must be followed ... bla bla ... use the source luke");
      }
      String className=matcher.group(1);
      String methodName=isMethod ? matcher.group(2) : null;
      String jvmSignature=jvmSignatureMatcher.group(1);
      String genericSignature=genericSignatureMatcher.group(1);
      if (genericSignature.equals("null")) {
        genericSignature=null;
      }
      return new Expectation(className,methodName,jvmSignature,genericSignature);
    }
  }
  throw new AssertionError("test instructions not found in " + ktFile);
}
