{
  JetTestUtils.newTrace(environment);
  GlobalContextImpl globalContext=ContextPackage.GlobalContext();
  TopDownAnalysisParameters params=TopDownAnalysisParameters.create(globalContext.getStorageManager(),globalContext.getExceptionTracker(),Predicates.<PsiFile>alwaysTrue(),false,false);
  CliLightClassGenerationSupport support=CliLightClassGenerationSupport.getInstanceForCli(environment.getProject());
  BindingTrace sharedTrace=support.getTrace();
  ModuleDescriptorImpl sharedModule=support.newModule();
  TopDownAnalyzerFacadeForJVM.analyzeFilesWithJavaIntegration(environment.getProject(),files,sharedTrace,params,sharedModule);
  return sharedModule;
}
