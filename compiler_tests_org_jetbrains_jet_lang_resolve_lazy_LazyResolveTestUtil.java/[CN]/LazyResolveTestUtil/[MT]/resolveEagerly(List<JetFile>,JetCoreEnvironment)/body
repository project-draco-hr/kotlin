{
  JetTestUtils.newTrace(environment);
  GlobalContextImpl globalContext=ContextPackage.GlobalContext();
  TopDownAnalysisParameters params=TopDownAnalysisParameters.create(globalContext.getStorageManager(),globalContext.getExceptionTracker(),Predicates.<PsiFile>alwaysTrue(),false,false);
  CliLightClassGenerationSupport support=CliLightClassGenerationSupport.getInstanceForCli(environment.getProject());
  BindingTrace sharedTrace=support.getTrace();
  ModuleDescriptorImpl sharedModule=support.newModule();
  InjectorForTopDownAnalyzerForJvm injector=new InjectorForTopDownAnalyzerForJvm(environment.getProject(),params,sharedTrace,sharedModule);
  injector.getTopDownAnalyzer().analyzeFiles(params,files,injector.getJavaDescriptorResolver().getPackageFragmentProvider());
  return injector.getModuleDescriptor();
}
