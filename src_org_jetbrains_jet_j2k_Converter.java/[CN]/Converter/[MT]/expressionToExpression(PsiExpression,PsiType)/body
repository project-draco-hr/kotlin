{
  if (argument == null)   return (IdentifierImpl)Identifier.EMPTY_IDENTIFIER;
  Expression expression=expressionToExpression(argument);
  PsiType actualType=argument.getType();
  boolean isPrimitiveTypeOrNull=actualType == null || actualType instanceof PsiPrimitiveType;
  boolean isRef=(argument instanceof PsiReferenceExpression && ((PsiReferenceExpression)argument).isQualified() || argument instanceof PsiMethodCallExpression);
  if (isPrimitiveTypeOrNull && isRef && expression.isNullable()) {
    expression=new BangBangExpression(expression);
  }
  if (actualType != null) {
    if (isConversionNeeded(actualType,expectedType) && !(expression instanceof LiteralExpression)) {
      String conversion=PRIMITIVE_TYPE_CONVERSIONS.get(expectedType.getCanonicalText());
      if (conversion != null) {
        expression=new DummyMethodCallExpression(expression,conversion,(IdentifierImpl)Identifier.EMPTY_IDENTIFIER);
      }
    }
  }
  return expression;
}
