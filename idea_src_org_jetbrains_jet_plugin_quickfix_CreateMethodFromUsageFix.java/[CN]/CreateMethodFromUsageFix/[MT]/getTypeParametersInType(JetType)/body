{
  Set<TypeParameterDescriptor> typeParameters=new LinkedHashSet<TypeParameterDescriptor>();
  List<TypeProjection> arguments=type.getArguments();
  if (arguments.isEmpty()) {
    ClassifierDescriptor descriptor=type.getConstructor().getDeclarationDescriptor();
    if (descriptor instanceof TypeParameterDescriptor) {
      typeParameters.add((TypeParameterDescriptor)descriptor);
    }
  }
 else {
    for (    TypeProjection projection : arguments) {
      typeParameters.addAll(getTypeParametersInType(projection.getType()));
    }
  }
  return typeParameters;
}
