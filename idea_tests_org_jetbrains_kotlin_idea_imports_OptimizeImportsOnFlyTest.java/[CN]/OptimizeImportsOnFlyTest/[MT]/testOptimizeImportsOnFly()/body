{
  configureFromFileText("test.kt","import java.util.ArrayList");
  boolean oldValue=CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY;
  try {
    CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY=true;
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        ImportInsertHelper.OBJECT$.getINSTANCE().addImportDirectiveIfNeeded(new FqName("java.util.HashSet"),(JetFile)getFile());
      }
    }
);
  }
  finally {
    CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY=oldValue;
  }
  checkResultByText("import java.util.HashSet");
}
