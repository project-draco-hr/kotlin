{
  DeclarationDescriptor constructorDescriptor=bindingContext.resolveReferenceExpression(constructorReference);
  final PsiElement declaration=bindingContext.getDeclarationPsiElement(constructorDescriptor);
  Type type;
  if (declaration instanceof PsiMethod) {
    type=generateJavaConstructorCall(expression,(PsiMethod)declaration);
  }
 else   if (constructorDescriptor instanceof ConstructorDescriptor) {
    type=typeMapper.mapType(bindingContext.getExpressionType(expression),OwnerKind.IMPLEMENTATION);
    if (type.getSort() == Type.ARRAY) {
      generateNewArray(expression,type);
    }
 else {
      ClassDescriptor classDecl=(ClassDescriptor)constructorDescriptor.getContainingDeclaration();
      v.anew(type);
      v.dup();
      pushOuterClassArguments(classDecl);
      CallableMethod method=typeMapper.mapToCallableMethod((ConstructorDescriptor)constructorDescriptor,OwnerKind.IMPLEMENTATION);
      pushMethodArguments(expression,method.getValueParameterTypes());
      pushTypeArguments(expression);
      method.invoke(v);
    }
  }
 else {
    throw new UnsupportedOperationException("don't know how to generate this new expression");
  }
  myStack.push(StackValue.onStack(type));
}
