{
  JetSimpleNameExpression operationSign=expression.getOperationSign();
  IElementType opToken=operationSign.getReferencedNameElementType();
  if (opToken == JetTokens.COLON) {
    gen(expression.getLeft());
  }
 else {
    JetTypeReference typeReference=expression.getRight();
    JetType jetType=bindingContext.resolveTypeReference(typeReference);
    DeclarationDescriptor descriptor=jetType.getConstructor().getDeclarationDescriptor();
    if (!(descriptor instanceof ClassDescriptor)) {
      throw new UnsupportedOperationException("don't know how to handle non-class types in as/as?");
    }
    Type type=typeMapper.mapType(jetType,OwnerKind.INTERFACE);
    gen(expression.getLeft(),OBJECT_TYPE);
    generateInstanceOf(new Runnable(){
      @Override public void run(){
        gen(expression.getLeft(),OBJECT_TYPE);
      }
    }
,jetType,true);
    Label isInstance=new Label();
    v.ifne(isInstance);
    v.pop();
    if (opToken == JetTokens.AS_SAFE) {
      v.aconst(null);
    }
 else {
      throwNewException(CLASS_TYPE_CAST_EXCEPTION);
    }
    v.mark(isInstance);
    myStack.push(StackValue.onStack(type));
  }
}
