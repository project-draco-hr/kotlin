{
  JetExpression receiver=getReceiverForSelector(expression);
  if (receiver != null) {
    if (!resolvesToClassOrPackage(receiver)) {
      if (myStack.isEmpty()) {
        throw new IllegalStateException("expected receiver on stack but it's not there: " + receiver.getText());
      }
      return myStack.pop();
    }
  }
 else   if (!(expression.getParent() instanceof JetSafeQualifiedExpression) && !(expression.getParent() instanceof JetPredicateExpression)) {
    return generateThisOrOuter(calleeContainingClass);
  }
  return null;
}
