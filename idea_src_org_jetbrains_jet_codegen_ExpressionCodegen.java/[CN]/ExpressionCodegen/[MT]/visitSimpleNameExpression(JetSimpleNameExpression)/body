{
  final DeclarationDescriptor descriptor=bindingContext.resolveReferenceExpression(expression);
  if (descriptor instanceof PropertyDescriptor) {
    final DeclarationDescriptor container=descriptor.getContainingDeclaration();
    if (isClass(container,"Number")) {
      Type castType=getCastType(expression.getReferencedName());
      if (castType != null) {
        final StackValue value=myStack.pop();
        value.put(castType,v);
        myStack.push(StackValue.onStack(castType));
        return;
      }
    }
  }
  PsiElement declaration=bindingContext.getDeclarationPsiElement(descriptor);
  if (declaration instanceof PsiField) {
    PsiField psiField=(PsiField)declaration;
    if (psiField.hasModifierProperty(PsiModifier.STATIC)) {
      v.visitFieldInsn(Opcodes.GETSTATIC,JetTypeMapper.jvmName(psiField.getContainingClass()),psiField.getName(),psiTypeToAsm(psiField.getType()).getDescriptor());
    }
 else {
      throw new UnsupportedOperationException("don't know how to generate field reference " + descriptor);
    }
  }
 else {
    int index=myMap.getIndex(descriptor);
    if (index >= 0) {
      final JetType outType=((PropertyDescriptor)descriptor).getOutType();
      myStack.push(StackValue.local(index,typeMapper.mapType(outType)));
    }
 else {
      throw new UnsupportedOperationException("don't know how to generate reference " + descriptor);
    }
  }
}
