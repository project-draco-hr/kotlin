{
  final DeclarationDescriptor descriptor=bindingContext.resolveReferenceExpression(expression);
  PsiElement declaration=bindingContext.getDeclarationPsiElement(descriptor);
  if (declaration instanceof PsiField) {
    PsiField psiField=(PsiField)declaration;
    if (psiField.hasModifierProperty(PsiModifier.STATIC)) {
      v.visitFieldInsn(Opcodes.GETSTATIC,jvmName(psiField.getContainingClass()),psiField.getName(),psiTypeToAsm(psiField.getType()).getDescriptor());
    }
 else {
      throw new UnsupportedOperationException("don't know how to generate field reference " + descriptor);
    }
  }
 else {
    int index=myMap.getIndex(descriptor);
    if (index >= 0) {
      final JetType outType=((PropertyDescriptor)descriptor).getOutType();
      myStack.push(StackValue.local(index,typeMapper.mapType(outType)));
    }
 else {
      throw new UnsupportedOperationException("don't know how to generate reference " + descriptor);
    }
  }
}
