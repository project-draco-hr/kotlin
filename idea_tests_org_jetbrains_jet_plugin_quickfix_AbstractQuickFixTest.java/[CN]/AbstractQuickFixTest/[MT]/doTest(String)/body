{
  boolean isWithRuntime=beforeFileName.endsWith("Runtime.kt");
  if (isWithRuntime) {
    ConfigLibraryUtil.configureKotlinRuntime(getModule(),getFullJavaJDK());
  }
  try {
    doSingleTest(getTestName(false) + ".kt");
    checkAvailableActionsAreExpected();
    checkForUnexpectedErrors();
  }
  finally {
    if (isWithRuntime) {
      ConfigLibraryUtil.unConfigureKotlinRuntime(getModule(),getProjectJDK());
    }
  }
}
