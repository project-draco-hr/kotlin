{
  PsiElement element=CodeInsightUtils.findElement(file,startOffset,endOffset,elementKind);
  if (element == null && elementKind == CodeInsightUtils.ElementKind.EXPRESSION) {
    element=IntroduceUtilKt.findExpressionOrStringFragment(file,startOffset,endOffset);
  }
  if (element == null) {
    if (failOnNoExpression) {
      throw new IntroduceRefactoringException(KotlinRefactoringBundle.message("cannot.refactor.not.expression"));
    }
    return null;
  }
  return element;
}
