{
  boolean shouldBeUnresolved=InTextDirectivesUtils.isDirectiveDefined(fileText,REF_EMPTY);
  List<String> refs=ReferenceUtils.getExpectedReferences(fileText);
  String referenceToString;
  if (shouldBeUnresolved) {
    Assert.assertTrue("REF: directives will be ignored for " + REF_EMPTY + " test: "+ refs,refs.isEmpty());
    referenceToString="<empty>";
  }
 else {
    assertTrue("Must be a single ref: " + refs + ".\n"+ "Use "+ MULTIRESOLVE+ " if you need multiple refs\n"+ "Use "+ REF_EMPTY+ " for an unresolved reference",refs.size() == 1);
    referenceToString=refs.get(0);
    Assert.assertNotNull("Test data wasn't found, use \"// REF: \" directive",referenceToString);
  }
  return new ExpectedResolveData(shouldBeUnresolved,referenceToString);
}
