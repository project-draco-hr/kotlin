{
  final String originalFileText=FileUtil.loadFile(new File(getTestDataPath() + beforeFileName),true);
  if (InTextDirectivesUtils.findStringWithPrefixes(originalFileText,"// WITH_RUNTIME") != null) {
    ConfigLibraryUtil.configureKotlinRuntime(myModule,PluginTestCaseBase.fullJdk());
  }
  if (withExtraFile) {
    configureByFiles(null,beforeFileName,beforeFileName.replace(".Main.",".data.Sample."));
  }
 else {
    configureByFiles(null,beforeFileName);
  }
  CommandProcessor.getInstance().executeCommand(getProject(),new Runnable(){
    @Override public void run(){
      try {
        Pair<String,Boolean> pair=LightQuickFixTestCase.parseActionHint(getFile(),originalFileText);
        String text=pair.getFirst();
        boolean actionShouldBeAvailable=pair.getSecond();
        DirectiveBasedActionUtils.checkForUnexpectedErrors((JetFile)getFile());
        doAction(text,actionShouldBeAvailable,beforeFileName);
      }
 catch (      ComparisonFailure e) {
        throw e;
      }
catch (      Throwable e) {
        e.printStackTrace();
        fail(getTestName(true));
      }
    }
  }
,"","");
}
