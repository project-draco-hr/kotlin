{
  if (klass.isArray() && !klass.getComponentType().isPrimitive()) {
    Signature signature=new ArraySignature(klass);
    map.put(klass,signature);
    return signature;
  }
  JetSignature annotation=(JetSignature)klass.getAnnotation(JetSignature.class);
  if (annotation != null) {
    String value=annotation.value();
    if (value != null) {
      Parser parser=new Parser(value,klass.getClassLoader());
      Class enclosingClass=klass.getEnclosingClass();
      Signature signature=new Signature(klass);
      map.put(klass,signature);
      parser.parseVars(signature);
      parser.parseTypes(signature);
      signature.afterParse();
      return signature;
    }
  }
  return getGenericSignature(klass);
}
