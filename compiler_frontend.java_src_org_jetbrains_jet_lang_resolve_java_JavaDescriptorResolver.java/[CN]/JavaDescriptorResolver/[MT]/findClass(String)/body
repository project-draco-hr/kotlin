{
  PsiClass original=javaFacade.findClass(qualifiedName,javaSearchScope);
  PsiClass altClass=altClassFinder.findClass(qualifiedName);
  PsiClass result=original;
  if (altClass != null) {
    if (altClass instanceof ClsClassImpl) {
      altClass.putUserData(ClsClassImpl.DELEGATE_KEY,original);
    }
    result=altClass;
  }
  if (result != null) {
    String actualQualifiedName=result.getQualifiedName();
    if (!actualQualifiedName.equals(qualifiedName)) {
      throw new IllegalStateException("requested " + qualifiedName + ", got "+ actualQualifiedName);
    }
  }
  return result;
}
