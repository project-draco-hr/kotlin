{
  if (annotation == null) {
    return null;
  }
  if (diagnostic instanceof DiagnosticWithPsiElementImpl && diagnostic.getFactory() instanceof PsiElementOnlyDiagnosticFactory) {
    PsiElementOnlyDiagnosticFactory factory=(PsiElementOnlyDiagnosticFactory)diagnostic.getFactory();
    Collection<JetIntentionActionFactory> intentionActionFactories=QuickFixes.get(factory);
    for (    JetIntentionActionFactory intentionActionFactory : intentionActionFactories) {
      IntentionAction action=null;
      if (intentionActionFactory != null) {
        action=intentionActionFactory.createAction((DiagnosticWithPsiElement)diagnostic);
      }
      if (action != null) {
        annotation.registerFix(action);
      }
    }
  }
  Collection<IntentionAction> actions=QuickFixes.get(diagnostic.getFactory());
  for (  IntentionAction action : actions) {
    annotation.registerFix(action);
  }
  return annotation;
}
