{
  if (check && occupiedCount != keyCount)   Context.codeBug();
  if (check && keyCount == 1 << power)   Context.codeBug();
  int fraction=hash * A;
  int index=fraction >>> (32 - power);
  int N=1 << power;
  if (keys[index] != null) {
    int mask=N - 1;
    int step=tableLookupStep(fraction,mask,power);
    int firstIndex=index;
    do {
      if (check && keys[index] == DELETED)       Context.codeBug();
      index=(index + step) & mask;
      if (check && firstIndex == index)       Context.codeBug();
    }
 while (keys[index] != null);
  }
  keys[index]=key;
  values[N + index]=hash;
  ++occupiedCount;
  ++keyCount;
  return index;
}
