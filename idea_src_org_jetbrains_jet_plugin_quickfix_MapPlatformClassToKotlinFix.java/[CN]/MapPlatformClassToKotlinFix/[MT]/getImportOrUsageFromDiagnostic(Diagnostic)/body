{
  JetImportDirective imp=QuickFixUtil.getParentElementOfType(diagnostic,JetImportDirective.class);
  JetReferenceExpression typeExpr;
  if (imp == null) {
    JetUserType type=QuickFixUtil.getParentElementOfType(diagnostic,JetUserType.class);
    if (type == null)     return null;
    typeExpr=type.getReferenceExpression();
  }
 else {
    JetExpression importRef=imp.getImportedReference();
    if (importRef == null || !(importRef instanceof JetDotQualifiedExpression))     return null;
    JetExpression refExpr=((JetDotQualifiedExpression)importRef).getSelectorExpression();
    if (refExpr == null || !(refExpr instanceof JetReferenceExpression))     return null;
    typeExpr=(JetReferenceExpression)refExpr;
  }
  return typeExpr;
}
