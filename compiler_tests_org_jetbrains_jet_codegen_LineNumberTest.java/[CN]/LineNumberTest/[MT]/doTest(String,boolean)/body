{
  JetFile psiFile=createPsiFile(filename);
  GenerationState state=GenerationUtils.compileFileGetGenerationStateForTest(psiFile);
  List<Integer> expectedLineNumbers;
  List<Integer> actualLineNumbers;
  if (custom) {
    expectedLineNumbers=extractCustomLineNumbersFromSource(psiFile);
    actualLineNumbers=extractActualLineNumbersFromBytecode(state,false);
    assertEquals(expectedLineNumbers,actualLineNumbers);
  }
 else {
    expectedLineNumbers=extractSelectedLineNumbersFromSource(psiFile);
    actualLineNumbers=extractActualLineNumbersFromBytecode(state,true);
    assertSameElements(actualLineNumbers,expectedLineNumbers);
  }
}
