{
  List<TestFile> testFileFiles=Lists.newArrayList();
  Matcher matcher=FILE_PATTERN.matcher(expectedText);
  if (!matcher.find()) {
    testFileFiles.add(new TestFile(testFileName,expectedText));
  }
 else {
    int processedChars=0;
    while (true) {
      String fileName=matcher.group(1);
      int start=matcher.start();
      assertTrue("Characters skipped from " + processedChars + " to "+ matcher.start(),start == processedChars);
      boolean nextFileExists=matcher.find();
      int end;
      if (nextFileExists) {
        end=matcher.start();
      }
 else {
        end=expectedText.length();
      }
      String fileText=expectedText.substring(start,end);
      processedChars=end;
      testFileFiles.add(new TestFile(fileName,fileText));
      if (!nextFileExists)       break;
    }
    assertTrue("Characters skipped from " + processedChars + " to "+ (expectedText.length() - 1),processedChars == expectedText.length());
  }
  return testFileFiles;
}
