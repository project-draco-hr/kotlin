{
  CompilerConfiguration compilerConfiguration=new CompilerConfiguration();
  compilerConfiguration.addAll(JVMConfigurationKeys.CLASSPATH_KEY,getClassPathFromClassLoaders(getClass().getClassLoader()));
  myEnvironment=new JetCoreEnvironment(getTestRootDisposable(),compilerConfiguration);
  String text="import org.jetbrains.jet.codegen.CompileTextTest; fun x() = CompileTextTest()";
  K2JVMCompileEnvironmentConfiguration configuration=new K2JVMCompileEnvironmentConfiguration(myEnvironment,MessageCollector.PLAIN_TEXT_TO_SYSTEM_ERR,false,BuiltinsScopeExtensionMode.ALL,false,BuiltinToJavaTypesMapping.ENABLED);
  ClassLoader classLoader=KotlinToJVMBytecodeCompiler.compileText(configuration,text);
  Class<?> namespace=classLoader.loadClass("namespace");
  Method x=namespace.getDeclaredMethod("x");
  Object invoke=x.invoke(null);
  assertTrue(invoke instanceof CompileTextTest);
}
