{
  if (expression == null) {
    return JetTypeInfo.create(null,context.dataFlowInfo);
  }
  if (expression instanceof JetFunctionLiteralExpression) {
    return getFunctionLiteralTypeInfo((JetFunctionLiteralExpression)expression,context,resolveArgumentsMode);
  }
  JetTypeInfo recordedTypeInfo=getRecordedTypeInfo(expression,context.trace.getBindingContext());
  if (recordedTypeInfo != null) {
    return recordedTypeInfo;
  }
  CallExpressionResolver callExpressionResolver=expressionTypingServices.getCallExpressionResolver();
  if (!(expression instanceof JetCallExpression) && !(expression instanceof JetQualifiedExpression)) {
    return expressionTypingServices.getTypeInfo(context.scope,expression,context.expectedType,context.dataFlowInfo,context.trace);
  }
  JetTypeInfo result;
  if (expression instanceof JetCallExpression) {
    result=callExpressionResolver.getCallExpressionTypeInfo((JetCallExpression)expression,ReceiverValue.NO_RECEIVER,null,context.replaceExpectedType(TypeUtils.NO_EXPECTED_TYPE),ResolveMode.NESTED_CALL,context.resolutionResultsCache);
  }
 else {
    result=callExpressionResolver.getQualifiedExpressionTypeInfo((JetQualifiedExpression)expression,context.replaceExpectedType(TypeUtils.NO_EXPECTED_TYPE),ResolveMode.NESTED_CALL,context.resolutionResultsCache);
  }
  recordExpressionType(expression,context.trace,context.scope,result);
  if (traceToCommitForCall != null) {
    traceToCommitForCall.commit();
  }
  return result;
}
