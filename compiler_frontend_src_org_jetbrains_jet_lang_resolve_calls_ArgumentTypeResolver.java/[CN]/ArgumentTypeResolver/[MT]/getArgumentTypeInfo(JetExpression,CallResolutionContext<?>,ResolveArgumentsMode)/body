{
  if (expression == null) {
    return JetTypeInfo.create(null,context.dataFlowInfo);
  }
  JetExpression deparenthesizedExpression=JetPsiUtil.deparenthesize(expression,false);
  if (deparenthesizedExpression instanceof JetFunctionLiteralExpression) {
    return getFunctionLiteralTypeInfo(expression,(JetFunctionLiteralExpression)deparenthesizedExpression,context,resolveArgumentsMode);
  }
  JetTypeInfo recordedTypeInfo=getRecordedTypeInfo(expression,context.trace.getBindingContext());
  if (recordedTypeInfo != null) {
    return recordedTypeInfo;
  }
  ResolutionContext newContext=context.replaceExpectedType(TypeUtils.NO_EXPECTED_TYPE).replaceContextDependency(ContextDependency.DEPENDENT).replaceExpressionPosition(ExpressionPosition.FREE);
  return expressionTypingServices.getTypeInfo(expression,newContext);
}
