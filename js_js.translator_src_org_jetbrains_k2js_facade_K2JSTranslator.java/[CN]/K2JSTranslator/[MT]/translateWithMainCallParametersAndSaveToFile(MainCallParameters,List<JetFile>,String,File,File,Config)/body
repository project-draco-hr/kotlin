{
  K2JSTranslator translator=new K2JSTranslator(config);
  File outFile=new File(outputPath);
  TextOutputImpl output=new TextOutputImpl();
  SourceMapBuilder sourceMapBuilder=config.isSourcemap() ? new SourceMap3Builder(outFile,output,new SourceMapBuilderConsumer()) : null;
  String programCode=translator.generateProgramCode(files,mainCall,output,sourceMapBuilder);
  if (outputPrefixFile != null) {
    String prefix=FileUtil.loadFile(outputPrefixFile);
    FileUtil.writeToFile(outFile,prefix);
    if (sourceMapBuilder != null) {
      sourceMapBuilder.skipLinesInBegin(StringUtil.getLineBreakCount(prefix));
    }
  }
  FileUtil.writeToFile(outFile,programCode.getBytes(),outputPrefixFile != null);
  if (outputPostfixFile != null) {
    byte[] postfix=FileUtil.loadFileBytes(outputPostfixFile);
    FileUtil.writeToFile(outFile,postfix,true);
  }
  if (sourceMapBuilder != null) {
    FileUtil.writeToFile(sourceMapBuilder.getOutFile(),sourceMapBuilder.build());
  }
}
