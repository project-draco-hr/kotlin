{
  MoveDestination destination=selectDestination();
  if (destination == null)   return;
  saveRefactoringSettings();
  for (  PsiElement element : elementsToMove) {
    String message=destination.verify(element.getContainingFile());
    if (message != null) {
      CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("error.title"),message,null,myProject);
      return;
    }
  }
  try {
    MoveKotlinTopLevelDeclarationsOptions options=new MoveKotlinTopLevelDeclarationsOptions(elementsToMove,destination,isSearchInComments(),isSearchInNonJavaFiles(),moveCallback);
    invokeRefactoring(new MoveKotlinTopLevelDeclarationsProcessor(myProject,options));
  }
 catch (  IncorrectOperationException e) {
    CommonRefactoringUtil.showErrorMessage(RefactoringBundle.message("error.title"),e.getMessage(),null,myProject);
  }
}
