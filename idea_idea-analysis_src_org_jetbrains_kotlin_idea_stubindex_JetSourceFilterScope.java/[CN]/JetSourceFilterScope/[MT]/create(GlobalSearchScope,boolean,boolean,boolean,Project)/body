{
  if (delegate == GlobalSearchScope.EMPTY_SCOPE)   return delegate;
  if (delegate instanceof JetSourceFilterScope) {
    JetSourceFilterScope wrappedDelegate=(JetSourceFilterScope)delegate;
    boolean doIncludeProjectSourceFiles=wrappedDelegate.includeProjectSourceFiles && includeProjectSourceFiles;
    boolean doIncludeLibrarySourceFiles=wrappedDelegate.includeLibrarySourceFiles && includeLibrarySourceFiles;
    boolean doIncludeClassFiles=wrappedDelegate.includeClassFiles && includeClassFiles;
    return new JetSourceFilterScope(wrappedDelegate.myBaseScope,doIncludeProjectSourceFiles,doIncludeLibrarySourceFiles,doIncludeClassFiles,project);
  }
  return new JetSourceFilterScope(delegate,includeProjectSourceFiles,includeLibrarySourceFiles,includeClassFiles,project);
}
