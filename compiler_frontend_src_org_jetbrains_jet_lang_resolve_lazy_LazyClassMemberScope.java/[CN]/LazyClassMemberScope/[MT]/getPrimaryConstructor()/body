{
  if (!primaryConstructorResolved) {
    if (EnumSet.of(ClassKind.CLASS,ClassKind.ANNOTATION_CLASS).contains(thisDescriptor.getKind())) {
      JetClassOrObject classOrObject=declarationProvider.getOwnerClassOrObject();
      if (classOrObject instanceof JetClass) {
        JetClass jetClass=(JetClass)classOrObject;
        ConstructorDescriptorImpl descriptor=resolveSession.getInjector().getDescriptorResolver().resolvePrimaryConstructorDescriptor(thisDescriptor.getScopeForClassHeaderResolution(),thisDescriptor,jetClass,resolveSession.getTrace());
        primaryConstructor=descriptor;
        descriptor.setReturnType(DeferredType.create(resolveSession.getTrace(),new LazyValue<JetType>(){
          @Override protected JetType compute(){
            return thisDescriptor.getDefaultType();
          }
        }
));
      }
    }
    primaryConstructorResolved=true;
  }
  return primaryConstructor;
}
