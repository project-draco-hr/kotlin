{
  if (parentClass != null) {
    FqName parentFqName=parentClass.getFqName();
    ClassDescriptor parentClassDescriptor=resolveClass(parentFqName,INCLUDE_KOTLIN_SOURCES);
    if (parentClassDescriptor == null) {
      throw new IllegalStateException("Could not resolve " + parentFqName + " required to be parent for "+ childClassFQName);
    }
    return parentClassDescriptor;
  }
 else {
    FqName parentFqName=childClassFQName.parent();
    PackageFragmentDescriptor parentPackage=packageFragmentProvider.getOrCreatePackage(parentFqName);
    if (parentPackage == null) {
      throw new IllegalStateException("Could not resolve " + parentFqName + " required to be parent for "+ childClassFQName);
    }
    return parentPackage;
  }
}
