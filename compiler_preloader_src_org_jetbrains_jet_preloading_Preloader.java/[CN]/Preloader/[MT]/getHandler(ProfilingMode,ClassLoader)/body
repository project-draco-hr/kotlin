{
  if (profilingMode == ProfilingMode.NO_TIME)   return new Handler();
  ServiceLoader<Instrumenter> loader=ServiceLoader.load(Instrumenter.class,withInstrumenter);
  Iterator<Instrumenter> instrumenters=loader.iterator();
  final Instrumenter instrumenter=instrumenters.hasNext() ? instrumenters.next() : Instrumenter.DO_NOTHING;
  final int[] counter=new int[1];
  final int[] size=new int[1];
  return new Handler(){
    @Override public void beforeDefineClass(    String name,    int sizeInBytes){
      counter[0]++;
      size[0]+=sizeInBytes;
    }
    @Override public void done(){
      System.out.println("Loaded classes: " + counter[0]);
      System.out.println("Loaded classes size: " + size[0]);
      instrumenter.dump(System.out);
    }
    @Override public byte[] instrument(    String resourceName,    byte[] data){
      return instrumenter.instrument(resourceName,data);
    }
  }
;
}
