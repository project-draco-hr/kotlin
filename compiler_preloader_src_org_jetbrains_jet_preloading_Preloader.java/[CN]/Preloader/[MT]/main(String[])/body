{
  if (args.length < PRELOADER_ARG_COUNT) {
    printUsageAndExit();
  }
  List<File> files=parseClassPath(args[0]);
  String mainClassCanonicalName=args[1];
  int classNumber;
  try {
    classNumber=Integer.parseInt(args[2]);
  }
 catch (  NumberFormatException e) {
    System.out.println(e.getMessage());
    printUsageAndExit();
    return;
  }
  String modeStr=args[3];
  Mode mode=parseMode(modeStr);
  URL[] instrumentersClasspath=parseInstrumentersClasspath(mode,modeStr);
  long startTime=System.nanoTime();
  ClassLoader parent=Preloader.class.getClassLoader();
  ClassLoader withInstrumenter=instrumentersClasspath.length > 0 ? new URLClassLoader(instrumentersClasspath,parent) : parent;
  Handler handler=getHandler(mode,withInstrumenter);
  ClassLoader preloaded=ClassPreloadingUtils.preloadClasses(files,classNumber,withInstrumenter,handler);
  Class<?> mainClass=preloaded.loadClass(mainClassCanonicalName);
  Method mainMethod=mainClass.getMethod("main",String[].class);
  try {
    mainMethod.invoke(0,new Object[]{Arrays.copyOfRange(args,PRELOADER_ARG_COUNT,args.length)});
  }
  finally {
    if (mode != Mode.NO_TIME) {
      long dt=System.nanoTime() - startTime;
      System.out.format("Total time: %.3fs\n",dt / 1e9);
    }
    handler.done();
  }
}
