{
  ProtoBuf.Function.Builder builder=ProtoBuf.Function.newBuilder();
  DescriptorSerializer local=createChildSerializer(descriptor);
  int flags=Flags.getFunctionFlags(hasAnnotations(descriptor),descriptor.getVisibility(),descriptor.getModality(),descriptor.getKind(),descriptor.isOperator(),descriptor.isInfix());
  if (flags != builder.getFlags()) {
    builder.setFlags(flags);
  }
  builder.setName(getSimpleNameIndex(descriptor.getName()));
  if (useTypeTable()) {
    builder.setReturnTypeId(local.typeId(descriptor.getReturnType()));
  }
 else {
    builder.setReturnType(local.type(descriptor.getReturnType()));
  }
  for (  TypeParameterDescriptor typeParameterDescriptor : descriptor.getTypeParameters()) {
    builder.addTypeParameter(local.typeParameter(typeParameterDescriptor));
  }
  ReceiverParameterDescriptor receiverParameter=descriptor.getExtensionReceiverParameter();
  if (receiverParameter != null) {
    if (useTypeTable()) {
      builder.setReceiverTypeId(local.typeId(receiverParameter.getType()));
    }
 else {
      builder.setReceiverType(local.type(receiverParameter.getType()));
    }
  }
  for (  ValueParameterDescriptor valueParameterDescriptor : descriptor.getValueParameters()) {
    builder.addValueParameter(local.valueParameter(valueParameterDescriptor));
  }
  if (serializeTypeTableToFunction) {
    ProtoBuf.TypeTable typeTableProto=typeTable.serialize();
    if (typeTableProto != null) {
      builder.setTypeTable(typeTableProto);
    }
  }
  extension.serializeFunction(descriptor,builder);
  return builder;
}
