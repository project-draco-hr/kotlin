{
  if (at(REGULAR_STRING_PART)) {
    PsiBuilder.Marker mark=mark();
    advance();
    mark.done(LITERAL_STRING_TEMPLATE_ENTRY);
  }
 else   if (at(ESCAPE_SEQUENCE)) {
    PsiBuilder.Marker mark=mark();
    advance();
    mark.done(ESCAPE_STRING_TEMPLATE_ENTRY);
  }
 else   if (at(SHORT_TEMPLATE_ENTRY)) {
    PsiBuilder.Marker entry=mark();
    PsiBuilder.Marker reference=mark();
    advance();
    reference.done(REFERENCE_EXPRESSION);
    entry.done(SHORT_STRING_TEMPLATE_ENTRY);
  }
 else   if (at(LONG_TEMPLATE_ENTRY_START)) {
    PsiBuilder.Marker longTemplateEntry=mark();
    advance();
    parseExpression();
    expect(LONG_TEMPLATE_ENTRY_END,"Expecting '}'",TokenSet.create(CLOSING_QUOTE,DANGLING_NEWLINE,REGULAR_STRING_PART,ESCAPE_SEQUENCE,SHORT_TEMPLATE_ENTRY));
    longTemplateEntry.done(LONG_STRING_TEMPLATE_ENTRY);
  }
 else {
    errorAndAdvance("Unexpected token in a string template");
  }
}
