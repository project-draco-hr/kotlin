{
  BindingContext bindingContext=AnalyzerFacadeWithCache.getContextForElement(declaration);
  CallableDescriptor declarationDescriptor=(CallableDescriptor)bindingContext.get(BindingContext.DECLARATION_TO_DESCRIPTOR,declaration);
  if (declarationDescriptor == null || declarationDescriptor instanceof LocalVariableDescriptor) {
    return Collections.singletonList(declaration);
  }
  Project project=declaration.getProject();
  Map<PsiElement,CallableDescriptor> overriddenElementsToDescriptor=new HashMap<PsiElement,CallableDescriptor>();
  for (  CallableDescriptor overridenDescriptor : OverrideResolver.getAllOverriddenDescriptors(declarationDescriptor)) {
    PsiElement overridenDeclaration=DescriptorToDeclarationUtil.getDeclaration(project,overridenDescriptor);
    if (overridenDeclaration != null) {
      overriddenElementsToDescriptor.put(overridenDeclaration,overridenDescriptor);
    }
  }
  if (ignore != null) {
    overriddenElementsToDescriptor.keySet().removeAll(ignore);
  }
  if (overriddenElementsToDescriptor.isEmpty())   return Collections.singletonList(declaration);
  List<String> superClasses=getClassDescriptions(overriddenElementsToDescriptor);
  return askUserForMethodsToSearch(declaration,declarationDescriptor,overriddenElementsToDescriptor,superClasses,actionStringKey);
}
