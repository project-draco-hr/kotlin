{
  ConfigureDialogWithModulesAndVersion dialog=new ConfigureDialogWithModulesAndVersion(project,this,KOTLIN_VERSIONS,excludeModules);
  dialog.show();
  if (!dialog.isOK())   return;
  NotificationMessageCollector collector=NotificationMessageCollectorKt.createConfigureKotlinNotificationCollector(project);
  for (  Module module : dialog.getModulesToConfigure()) {
    PsiFile file=findModulePomFile(module);
    if (file != null && canConfigureFile(file)) {
      changePomFile(module,file,dialog.getKotlinVersion(),collector);
      OpenFileAction.openFile(file.getVirtualFile(),project);
    }
 else {
      showErrorMessage(project,"Cannot find pom.xml for module " + module.getName());
    }
  }
  collector.showNotification();
}
