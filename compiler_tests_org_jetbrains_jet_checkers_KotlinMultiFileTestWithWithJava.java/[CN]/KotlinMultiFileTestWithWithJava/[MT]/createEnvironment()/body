{
  File javaFilesDir=createJavaFilesDir();
  CompilerConfiguration configuration=JetTestUtils.compilerConfigurationForTests(ConfigurationKind.JDK_AND_ANNOTATIONS,TestJdkKind.MOCK_JDK,Arrays.asList(JetTestUtils.getAnnotationsJar()),Arrays.asList(javaFilesDir));
  File kotlinSourceRoot=getKotlinSourceRoot();
  if (kotlinSourceRoot != null) {
    configuration.add(CommonConfigurationKeys.SOURCE_ROOTS_KEY,kotlinSourceRoot.getPath());
  }
  return JetCoreEnvironment.createForTests(getTestRootDisposable(),configuration,EnvironmentConfigFiles.JVM_CONFIG_FILES);
}
