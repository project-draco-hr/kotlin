{
  List<String> expectedReferences=InTextDirectivesUtils.findListWithPrefixes(getFile().getText(),"REF:");
  PsiReference psiReference=getFile().findReferenceAt(getEditor().getCaretModel().getOffset());
  assertTrue(psiReference instanceof PsiPolyVariantReference);
  PsiPolyVariantReference variantReference=(PsiPolyVariantReference)psiReference;
  ResolveResult[] results=variantReference.multiResolve(true);
  List<String> actualResolvedTo=Lists.newArrayList();
  for (  ResolveResult result : results) {
    PsiElement resolvedToElement=result.getElement();
    assertNotNull(resolvedToElement);
    actualResolvedTo.add(ReferenceUtils.renderAsGotoImplementation(resolvedToElement));
  }
  assertOrderedEquals(Ordering.natural().sortedCopy(actualResolvedTo),Ordering.natural().sortedCopy(expectedReferences));
}
