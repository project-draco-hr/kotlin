{
  StringBuilder output=new StringBuilder();
  Pattern symbolReference=Pattern.compile("^\\w+$",Pattern.MULTILINE);
  Matcher matcher=symbolReference.matcher(allRules);
  int copiedUntil=0;
  while (matcher.find()) {
    int start=matcher.start();
    output.append(allRules.subSequence(copiedUntil,start));
    String group=matcher.group();
    output.append("&").append(group);
    copiedUntil=matcher.end();
  }
  output.append(allRules.subSequence(copiedUntil,allRules.length()));
  return output;
}
