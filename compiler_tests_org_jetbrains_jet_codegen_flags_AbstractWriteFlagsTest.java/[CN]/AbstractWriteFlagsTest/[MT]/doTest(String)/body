{
  File ktFile=new File(path);
  assertTrue("Cannot find a file " + ktFile.getAbsolutePath(),ktFile.exists());
  String fileText=FileUtil.loadFile(ktFile,true);
  JetFile psiFile=JetTestUtils.createFile(ktFile.getName(),fileText,jetCoreEnvironment.getProject());
  assertTrue("Cannot create JetFile from text",psiFile != null);
  OutputFileCollection outputFiles=GenerationUtils.compileFileGetClassFileFactoryForTest(psiFile);
  List<TestedObject> testedObjects=parseExpectedTestedObject(fileText);
  for (  TestedObject testedObject : testedObjects) {
    String className=null;
    for (    OutputFile outputFile : outputFiles.asList()) {
      String filePath=outputFile.getRelativePath();
      if (testedObject.isFullContainingClassName && filePath.equals(testedObject.containingClass + ".class")) {
        className=filePath;
      }
 else       if (!testedObject.isFullContainingClassName && filePath.startsWith(testedObject.containingClass)) {
        className=filePath;
      }
    }
    assertNotNull("Couldn't find a class file with name " + testedObject.containingClass,className);
    OutputFile outputFile=outputFiles.get(className);
    assertNotNull(outputFile);
    ClassReader cr=new ClassReader(outputFile.asByteArray());
    TestClassVisitor classVisitor;
    classVisitor=getClassVisitor(testedObject.kind,testedObject.name);
    cr.accept(classVisitor,ClassReader.SKIP_CODE);
    boolean isObjectExists=!Boolean.valueOf(findStringWithPrefixes(testedObject.textData,"// ABSENT: "));
    assertEquals("Wrong object existence state: " + testedObject,isObjectExists,classVisitor.isExists());
    int expectedAccess=getExpectedFlags(testedObject.textData);
    if (isObjectExists) {
      assertEquals("Wrong access flag for " + testedObject + " \n"+ outputFile.asText(),expectedAccess,classVisitor.getAccess());
    }
  }
}
