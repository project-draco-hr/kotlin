{
  CachedJavaStub cachedJavaStub=virtualFile.getUserData(cachedJavaStubKey);
  long fileModificationStamp=virtualFile.getModificationStamp();
  if (cachedJavaStub != null && cachedJavaStub.modificationStamp == fileModificationStamp) {
    return cachedJavaStub.javaFileStub;
  }
  PsiJavaFileStubImpl stub=(PsiJavaFileStubImpl)createStub(virtualFile);
  if (stub != null) {
    virtualFile.putUserData(cachedJavaStubKey,new CachedJavaStub(fileModificationStamp,stub));
  }
  return stub;
}
