{
  if (expression instanceof JetParenthesizedExpression) {
    JetParenthesizedExpression parenthesizedExpression=(JetParenthesizedExpression)expression;
    JetExpression innerExpression=parenthesizedExpression.getExpression();
    return getIdForStableIdentifier(innerExpression,bindingContext,allowNamespaces);
  }
 else   if (expression instanceof JetQualifiedExpression) {
    JetQualifiedExpression qualifiedExpression=(JetQualifiedExpression)expression;
    JetExpression receiverExpression=qualifiedExpression.getReceiverExpression();
    JetExpression selectorExpression=qualifiedExpression.getSelectorExpression();
    IdentifierInfo receiverId=getIdForStableIdentifier(receiverExpression,bindingContext,true);
    IdentifierInfo selectorId=getIdForStableIdentifier(selectorExpression,bindingContext,allowNamespaces);
    return combineInfo(receiverId,selectorId);
  }
  if (expression instanceof JetSimpleNameExpression) {
    return getIdForSimpleNameExpression((JetSimpleNameExpression)expression,bindingContext,allowNamespaces);
  }
 else   if (expression instanceof JetThisExpression) {
    JetThisExpression thisExpression=(JetThisExpression)expression;
    DeclarationDescriptor declarationDescriptor=bindingContext.get(REFERENCE_TARGET,thisExpression.getInstanceReference());
    return getIdForThisReceiver(declarationDescriptor);
  }
 else   if (expression instanceof JetRootNamespaceExpression) {
    return createNamespaceInfo(JetModuleUtil.getRootNamespaceType(expression),allowNamespaces);
  }
  return ERROR_IDENTIFIER_INFO;
}
