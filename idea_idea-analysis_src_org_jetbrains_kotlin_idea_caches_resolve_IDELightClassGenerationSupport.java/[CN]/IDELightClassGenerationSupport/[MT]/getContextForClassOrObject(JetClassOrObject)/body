{
  ResolveSessionForBodies session=KotlinCacheService.getInstance(classOrObject.getProject()).getLazyResolveSession(classOrObject);
  if (classOrObject.isLocal()) {
    BindingContext bindingContext=session.resolveToElement(classOrObject,BodyResolveMode.FULL);
    ClassDescriptor descriptor=bindingContext.get(BindingContext.CLASS,classOrObject);
    if (descriptor == null) {
      LOG.warn("No class descriptor in context for class: " + JetPsiUtil.getElementTextWithContext(classOrObject));
      return new LightClassConstructionContext(bindingContext,session.getModuleDescriptor());
    }
    ForceResolveUtil.forceResolveAllContents(descriptor);
    return new LightClassConstructionContext(bindingContext,session.getModuleDescriptor());
  }
  ForceResolveUtil.forceResolveAllContents(session.getClassDescriptor(classOrObject));
  return new LightClassConstructionContext(session.getBindingContext(),session.getModuleDescriptor());
}
