{
  ResolutionFacade resolutionFacade=ResolvePackage.getResolutionFacade(classOrObject);
  ModuleDescriptor moduleDescriptor=resolutionFacade.findModuleDescriptor(classOrObject);
  BindingContext bindingContext=resolutionFacade.analyze(classOrObject,BodyResolveMode.FULL);
  if (classOrObject.isLocal()) {
    ClassDescriptor descriptor=bindingContext.get(BindingContext.CLASS,classOrObject);
    if (descriptor == null) {
      LOG.warn("No class descriptor in context for class: " + PsiUtilPackage.getElementTextWithContext(classOrObject));
      return new LightClassConstructionContext(bindingContext,moduleDescriptor);
    }
    ForceResolveUtil.forceResolveAllContents(descriptor);
    return new LightClassConstructionContext(bindingContext,moduleDescriptor);
  }
  ForceResolveUtil.forceResolveAllContents(resolutionFacade.resolveToDescriptor(classOrObject));
  return new LightClassConstructionContext(bindingContext,moduleDescriptor);
}
