{
  for (  Map.Entry<JetScript,ScriptDescriptor> e : c.getScripts().entrySet()) {
    JetScript declaration=e.getKey();
    ScriptDescriptor descriptor=e.getValue();
    WritableScope scope=c.getScriptScopes().get(declaration);
    List<ValueParameterDescriptor> valueParameters=Lists.newArrayList();
    scope.setImplicitReceiver(descriptor.getThisAsReceiverParameter());
    JetFile file=(JetFile)declaration.getContainingFile();
    JetScriptDefinition scriptDefinition=JetScriptDefinitionProvider.getInstance(file.getProject()).findScriptDefinition(file);
    int index=0;
    List<AnalyzerScriptParameter> scriptParameters=!scriptDefinition.getScriptParameters().isEmpty() ? scriptDefinition.getScriptParameters() : c.getTopDownAnalysisParameters().getScriptParameters();
    for (    AnalyzerScriptParameter scriptParameter : scriptParameters) {
      ValueParameterDescriptor parameter=resolveScriptParameter(scriptParameter,index,descriptor);
      valueParameters.add(parameter);
      scope.addVariableDescriptor(parameter);
      ++index;
    }
    descriptor.setValueParameters(valueParameters);
  }
}
