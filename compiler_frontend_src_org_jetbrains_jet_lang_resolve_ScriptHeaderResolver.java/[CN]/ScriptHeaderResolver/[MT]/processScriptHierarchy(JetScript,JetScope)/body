{
  NamespaceDescriptorImpl ns=namespaceFactory.createNamespaceDescriptorPathIfNeeded(FqName.ROOT);
  Integer priority=script.getUserData(PRIORITY_KEY);
  if (priority == null) {
    priority=0;
  }
  ScriptDescriptor scriptDescriptor=new ScriptDescriptor(ns,priority);
  WritableScopeImpl scriptScope=new WritableScopeImpl(outerScope,scriptDescriptor,RedeclarationHandler.DO_NOTHING,"script");
  scriptScope.changeLockLevel(WritableScope.LockLevel.BOTH);
  context.getScriptScopes().put(script,scriptScope);
  context.getScripts().put(script,scriptDescriptor);
  trace.record(BindingContext.SCRIPT,script,scriptDescriptor);
}
