{
  JetFile file=(JetFile)script.getContainingFile();
  FqName fqName=file.getPackageFqName();
  PackageFragmentDescriptor ns=packageFragmentProvider.getOrCreateFragment(fqName);
  Integer priority=getScriptPriority(script);
  FqName nameForScript=ScriptNameUtil.classNameForScript((JetFile)script.getContainingFile());
  Name className=nameForScript.shortName();
  ScriptDescriptorImpl scriptDescriptor=new ScriptDescriptorImpl(ns,priority,outerScope,className);
  WritableScopeImpl scriptScope=new WritableScopeImpl(outerScope,scriptDescriptor,RedeclarationHandler.DO_NOTHING,"script");
  scriptScope.changeLockLevel(WritableScope.LockLevel.BOTH);
  scriptDescriptor.setScopeForBodyResolution(scriptScope);
  c.getScripts().put(script,scriptDescriptor);
  trace.record(BindingContext.SCRIPT,script,scriptDescriptor);
  outerScope.addClassifierDescriptor(scriptDescriptor.getClassDescriptor());
}
