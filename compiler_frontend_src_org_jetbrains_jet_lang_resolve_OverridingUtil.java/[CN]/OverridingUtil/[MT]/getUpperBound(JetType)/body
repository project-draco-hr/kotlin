{
  if (type.getConstructor().getDeclarationDescriptor() instanceof ClassDescriptor) {
    return type;
  }
 else   if (type.getConstructor().getDeclarationDescriptor() instanceof TypeParameterDescriptor) {
    return ((TypeParameterDescriptor)type.getConstructor().getDeclarationDescriptor()).getUpperBoundsAsType();
  }
 else {
    throw new IllegalStateException("unknown type constructor: " + type.getConstructor().getClass().getName());
  }
}
