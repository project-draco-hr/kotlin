{
  root.acceptChildren(new PsiElementVisitor(){
    @Override public void visitElement(    PsiElement element){
      element.acceptChildren(this);
    }
    @Override public void visitErrorElement(    PsiErrorElement element){
      Document document=PsiDocumentManager.getInstance(element.getProject()).getDocument(element.getContainingFile());
      int offset=element.getTextRange().getStartOffset();
      int lineNumber=document.getLineNumber(offset);
      int lineStartOffset=document.getLineStartOffset(lineNumber);
      int column=offset - lineStartOffset;
      throw new IllegalArgumentException(element.getErrorDescription() + "; looking at " + element.getNode().getElementType()+ " '"+ element.getText()+ "' at line "+ lineNumber+ ":"+ column);
    }
  }
);
}
