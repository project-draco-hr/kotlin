{
  if (place instanceof KtBlockExpression) {
    return place;
  }
  while (place != null) {
    PsiElement parent=place.getParent();
    if (parent instanceof KtContainerNode) {
      if (!isBadContainerNode((KtContainerNode)parent,place)) {
        return parent;
      }
    }
    if (parent instanceof KtBlockExpression || (parent instanceof KtWhenEntry && place == ((KtWhenEntry)parent).getExpression())) {
      return parent;
    }
    if (parent instanceof KtDeclarationWithBody && ((KtDeclarationWithBody)parent).getBodyExpression() == place) {
      return parent;
    }
    place=parent;
  }
  return null;
}
