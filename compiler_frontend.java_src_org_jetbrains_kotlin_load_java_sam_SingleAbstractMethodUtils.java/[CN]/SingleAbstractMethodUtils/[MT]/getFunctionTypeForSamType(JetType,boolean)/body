{
  ClassifierDescriptor classifier=samType.getConstructor().getDeclarationDescriptor();
  if (classifier instanceof JavaClassDescriptor) {
    JetType functionTypeDefault=((JavaClassDescriptor)classifier).getFunctionTypeForSamInterface();
    if (functionTypeDefault != null) {
      JetType substitute=TypeSubstitutor.create(samType).substitute(functionTypeDefault,Variance.INVARIANT);
      if (substitute == null)       return null;
      JetType type=fixProjections(substitute);
      if (type == null)       return null;
      if (JvmPackage.getPLATFORM_TYPES() && !isSamConstructor && TypesPackage.isNullabilityFlexible(samType)) {
        return LazyJavaTypeResolver.FlexibleJavaClassifierTypeCapabilities.create(type,TypeUtils.makeNullable(type));
      }
      return TypeUtils.makeNullableAsSpecified(type,!isSamConstructor && samType.isMarkedNullable());
    }
  }
  return null;
}
