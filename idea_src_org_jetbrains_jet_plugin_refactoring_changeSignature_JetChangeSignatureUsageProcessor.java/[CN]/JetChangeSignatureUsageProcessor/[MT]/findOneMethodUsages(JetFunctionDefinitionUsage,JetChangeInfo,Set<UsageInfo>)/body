{
  boolean isInherited=functionUsageInfo.isInherited();
  if (isInherited) {
    result.add(functionUsageInfo);
  }
  PsiElement functionPsi=functionUsageInfo.getElement();
  if (functionPsi == null)   return;
  for (  PsiReference reference : ReferencesSearch.search(functionPsi,functionPsi.getUseScope())) {
    PsiElement element=reference.getElement();
    if (element instanceof JetReferenceExpression) {
      PsiElement parent=element.getParent();
      if (parent instanceof JetCallExpression)       result.add(new JetFunctionCallUsage((JetCallExpression)parent,functionUsageInfo));
 else       if (parent instanceof JetUserType && parent.getParent() instanceof JetTypeReference) {
        parent=parent.getParent().getParent();
        if (parent instanceof JetConstructorCalleeExpression && parent.getParent() instanceof JetDelegatorToSuperCall)         result.add(new JetFunctionCallUsage((JetDelegatorToSuperCall)parent.getParent(),functionUsageInfo));
      }
    }
  }
  String oldName=changeInfo.getOldName();
  if (oldName != null)   TextOccurrencesUtil.findNonCodeUsages(functionPsi,oldName,true,true,changeInfo.getNewName(),result);
  List<JetParameter> oldParameters=functionPsi instanceof JetFunction ? ((JetFunction)functionPsi).getValueParameters() : ((JetClass)functionPsi).getPrimaryConstructorParameters();
  for (  JetParameterInfo parameterInfo : changeInfo.getNewParameters()) {
    if (parameterInfo.getOldIndex() >= 0 && parameterInfo.getOldIndex() < oldParameters.size()) {
      JetParameter oldParam=oldParameters.get(parameterInfo.getOldIndex());
      String oldParamName=oldParam.getName();
      if (oldParamName != null && !oldParamName.equals(parameterInfo.getName())) {
        for (        PsiReference reference : ReferencesSearch.search(oldParam,oldParam.getUseScope())) {
          PsiElement element=reference.getElement();
          if (element instanceof JetSimpleNameExpression && !(element.getParent() instanceof JetValueArgumentName)) {
            JetParameterUsage parameterUsage=new JetParameterUsage((JetSimpleNameExpression)element,parameterInfo,functionUsageInfo);
            result.add(parameterUsage);
          }
        }
      }
    }
  }
  if (functionPsi instanceof JetClass && ((JetClass)functionPsi).isEnum()) {
    for (    JetDeclaration declaration : ((JetClass)functionPsi).getDeclarations()) {
      if (declaration instanceof JetEnumEntry && ((JetEnumEntry)declaration).getDelegationSpecifierList() == null) {
        result.add(new JetEnumEntryWithoutSuperCallUsage((JetEnumEntry)declaration));
      }
    }
  }
}
