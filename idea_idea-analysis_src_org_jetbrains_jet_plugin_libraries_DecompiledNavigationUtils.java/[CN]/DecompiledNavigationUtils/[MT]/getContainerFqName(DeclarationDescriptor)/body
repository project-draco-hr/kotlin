{
  ClassOrPackageFragmentDescriptor containerDescriptor=DescriptorUtils.getParentOfType(referencedDescriptor,ClassOrPackageFragmentDescriptor.class,false);
  if (containerDescriptor instanceof PackageFragmentDescriptor) {
    return PackageClassUtils.getPackageClassFqName(((PackageFragmentDescriptor)containerDescriptor).getFqName());
  }
  if (containerDescriptor instanceof ClassDescriptor) {
    if (containerDescriptor.getContainingDeclaration() instanceof ClassDescriptor || ExpressionTypingUtils.isLocal(containerDescriptor.getContainingDeclaration(),containerDescriptor)) {
      return getContainerFqName(containerDescriptor.getContainingDeclaration());
    }
    FqNameUnsafe fqNameUnsafe=getFqName(containerDescriptor);
    return fqNameUnsafe.isSafe() ? fqNameUnsafe.toSafe() : null;
  }
  return null;
}
