{
  return ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
    @Override public Boolean compute(){
      PsiFile containingFile=element.getContainingFile();
      if (containingFile == null) {
        return false;
      }
      VirtualFile virtualFile=containingFile.getVirtualFile();
      if (virtualFile == null) {
        return false;
      }
      ProjectFileIndex index=ProjectFileIndex.SERVICE.getInstance(element.getProject());
      return includeLibrarySources ? index.isInSource(virtualFile) : index.isInSourceContent(virtualFile);
    }
  }
);
}
