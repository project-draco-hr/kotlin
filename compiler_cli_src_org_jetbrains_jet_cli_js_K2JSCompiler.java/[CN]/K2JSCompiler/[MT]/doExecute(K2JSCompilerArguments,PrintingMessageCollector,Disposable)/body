{
  if (arguments.sourceFiles == null) {
    messageCollector.report(CompilerMessageSeverity.ERROR,"Specify sources location via -sourceFiles",NO_LOCATION);
    return ExitCode.INTERNAL_ERROR;
  }
  CompilerConfiguration configuration=new CompilerConfiguration();
  configuration.addAll(CommonConfigurationKeys.SOURCE_ROOTS_KEY,Arrays.asList(arguments.sourceFiles));
  JetCoreEnvironment environmentForJS=new JetCoreEnvironment(rootDisposable,configuration);
  Project project=environmentForJS.getProject();
  ClassPathLibrarySourcesLoader sourceLoader=new ClassPathLibrarySourcesLoader(project);
  List<JetFile> sourceFiles=sourceLoader.findSourceFiles();
  environmentForJS.getSourceFiles().addAll(sourceFiles);
  if (arguments.isVerbose()) {
    reportCompiledSourcesList(messageCollector,environmentForJS);
  }
  Config config=getConfig(arguments,project);
  if (analyzeAndReportErrors(messageCollector,environmentForJS.getSourceFiles(),config)) {
    return COMPILATION_ERROR;
  }
  String outputFile=arguments.outputFile;
  if (outputFile == null) {
    messageCollector.report(CompilerMessageSeverity.ERROR,"Specify output file via -output",CompilerMessageLocation.NO_LOCATION);
    return ExitCode.INTERNAL_ERROR;
  }
  MainCallParameters mainCallParameters=arguments.createMainCallParameters();
  return translateAndGenerateOutputFile(mainCallParameters,messageCollector,environmentForJS,config,outputFile);
}
