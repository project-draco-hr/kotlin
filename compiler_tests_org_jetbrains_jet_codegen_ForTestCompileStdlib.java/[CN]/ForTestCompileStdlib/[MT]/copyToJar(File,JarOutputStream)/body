{
  Stack<Pair<String,File>> toCopy=new Stack<Pair<String,File>>();
  toCopy.add(new Pair<String,File>("",root));
  while (!toCopy.empty()) {
    Pair<String,File> pop=toCopy.pop();
    File file=pop.getSecond();
    if (file.isFile()) {
      os.putNextEntry(new JarEntry(pop.getFirst()));
      Files.copy(file,os);
    }
 else     if (file.isDirectory()) {
      for (      File child : file.listFiles()) {
        String path=pop.getFirst().isEmpty() ? child.getName() : pop.getFirst() + "/" + child.getName();
        toCopy.add(new Pair<String,File>(path,child));
      }
    }
 else {
      throw new IllegalStateException();
    }
  }
}
