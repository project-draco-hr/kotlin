{
  System.err.println("compiling stdlib for tests, resulting file: " + stdlibJarForTests);
  File tmpFile=new File(stdlibJarForTests.getPath() + "~");
  JetTestUtils.mkdirs(tmpFile.getParentFile());
  File tmpDir=new File(JetTestUtils.tmpDirForTest(ForTestCompileStdlib.class),"classes");
  JetTestUtils.recreateDirectory(tmpDir);
  compileKotlinPartOfStdlib(tmpDir);
  compileJavaPartOfStdlib(tmpDir);
  FileOutputStream stdlibJar=new FileOutputStream(tmpFile);
  try {
    JarOutputStream jarOutputStream=new JarOutputStream(stdlibJar);
    copyToJar(tmpDir,jarOutputStream);
    jarOutputStream.close();
    stdlibJar.close();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      stdlibJar.close();
    }
 catch (    Throwable e) {
    }
  }
  if (!tmpFile.renameTo(stdlibJarForTests)) {
    throw new RuntimeException();
  }
}
