{
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      LongRunningReadTask.runWithWriteActionPriority(indicator,new Runnable(){
        @Override public void run(){
          DeclarationDescriptor descriptor=null;
          try {
            BindingContext bindingContext=ResolvePackage.getBindingContext(jetFile);
            descriptor=bindingContext.getDiagnostics().forElement(declaration).isEmpty() ? bindingContext.get(BindingContext.DECLARATION_TO_DESCRIPTOR,declaration) : null;
          }
  finally {
            final DeclarationDescriptor finalDescriptor=descriptor;
            ApplicationManager.getApplication().invokeLater(new Runnable(){
              @Override public void run(){
                onDescriptorReady(finalDescriptor,declaration,editor,jetFile,indicator);
              }
            }
);
          }
        }
      }
);
    }
  }
);
}
