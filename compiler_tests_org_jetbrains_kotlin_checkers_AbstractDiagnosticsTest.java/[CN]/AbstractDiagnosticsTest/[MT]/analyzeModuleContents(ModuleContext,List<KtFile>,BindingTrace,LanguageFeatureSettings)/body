{
  CompilerConfiguration configuration;
  if (languageFeatureSettings != null) {
    configuration=getEnvironment().getConfiguration().copy();
    configuration.put(CommonConfigurationKeys.LANGUAGE_FEATURE_SETTINGS,languageFeatureSettings);
  }
 else {
    configuration=getEnvironment().getConfiguration();
  }
  return TopDownAnalyzerFacadeForJVM.analyzeFilesWithJavaIntegration(moduleContext,files,moduleTrace,configuration,new JvmPackagePartProvider(getEnvironment()));
}
