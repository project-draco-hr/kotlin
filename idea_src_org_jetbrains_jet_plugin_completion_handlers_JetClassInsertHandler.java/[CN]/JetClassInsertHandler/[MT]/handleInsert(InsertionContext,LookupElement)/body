{
  if (context.getFile() instanceof JetFile) {
    if (item.getObject() instanceof JetLookupObject) {
      JetLookupObject lookupObject=(JetLookupObject)item.getObject();
      DeclarationDescriptor descriptor=lookupObject.getDescriptor();
      if (descriptor != null) {
        int startOffset=context.getStartOffset();
        Document document=context.getDocument();
        if (!isAfterDot(document,startOffset)) {
          String text=DescriptorUtils.getFqName(descriptor).asString();
          document.replaceString(startOffset,context.getTailOffset(),text + ".");
          PsiDocumentManager psiDocumentManager=PsiDocumentManager.getInstance(context.getProject());
          psiDocumentManager.commitAllDocuments();
          RangeMarker rangeMarker=document.createRangeMarker(startOffset,startOffset + text.length());
          ShortenReferences.instance$.process((JetFile)context.getFile(),startOffset,startOffset + text.length());
          psiDocumentManager.commitAllDocuments();
          psiDocumentManager.doPostponedOperationsAndUnblockDocument(document);
          if (rangeMarker.isValid()) {
            int endOffset=rangeMarker.getEndOffset();
            if (endOffset < document.getTextLength() && document.getCharsSequence().charAt(endOffset) == '.') {
              document.deleteString(endOffset,endOffset + 1);
            }
          }
        }
      }
    }
  }
}
