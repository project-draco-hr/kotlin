{
  if (!endsWithReturn(bodyExpression)) {
    final org.jetbrains.jet.lang.types.Type expressionType=bindingContext.getExpressionType(bodyExpression);
    if (expressionType.equals(JetStandardClasses.getUnitType())) {
      mv.visitInsn(Opcodes.RETURN);
    }
 else {
      mv.visitInsn(Opcodes.ARETURN);
    }
  }
}
