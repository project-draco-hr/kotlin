{
  FunctionDescriptorImpl substitutedDescriptor=createSubstitutedCopy(newOwner,preserveOriginal,kind);
  List<TypeParameterDescriptor> substitutedTypeParameters=Lists.newArrayList();
  TypeSubstitutor substitutor=DescriptorSubstitutor.substituteTypeParameters(getTypeParameters(),originalSubstitutor,substitutedDescriptor,substitutedTypeParameters);
  JetType substitutedReceiverParameterType=null;
  if (receiverParameter.exists()) {
    substitutedReceiverParameterType=substitutor.substitute(getReceiverParameter().getType(),Variance.IN_VARIANCE);
    if (substitutedReceiverParameterType == null) {
      return null;
    }
  }
  ReceiverDescriptor substitutedExpectedThis=NO_RECEIVER;
  if (expectedThisObject.exists()) {
    JetType substitutedType=substitutor.substitute(expectedThisObject.getType(),Variance.INVARIANT);
    if (substitutedType == null) {
      return null;
    }
    substitutedExpectedThis=new TransientReceiver(substitutedType);
  }
  List<ValueParameterDescriptor> substitutedValueParameters=FunctionDescriptorUtil.getSubstitutedValueParameters(substitutedDescriptor,this,substitutor);
  if (substitutedValueParameters == null) {
    return null;
  }
  JetType substitutedReturnType=FunctionDescriptorUtil.getSubstitutedReturnType(this,substitutor);
  if (substitutedReturnType == null) {
    return null;
  }
  substitutedDescriptor.initialize(substitutedReceiverParameterType,substitutedExpectedThis,substitutedTypeParameters,substitutedValueParameters,substitutedReturnType,newModality,newVisibility);
  if (copyOverrides) {
    for (    FunctionDescriptor overriddenFunction : overriddenFunctions) {
      OverridingUtil.bindOverride(substitutedDescriptor,overriddenFunction.substitute(substitutor));
    }
  }
  return substitutedDescriptor;
}
