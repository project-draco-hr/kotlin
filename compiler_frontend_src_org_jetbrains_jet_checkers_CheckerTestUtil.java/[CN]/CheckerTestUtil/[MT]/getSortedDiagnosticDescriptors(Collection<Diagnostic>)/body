{
  List<Diagnostic> list=Lists.newArrayList(diagnostics);
  Collections.sort(list,DIAGNOSTIC_COMPARATOR);
  List<DiagnosticDescriptor> diagnosticDescriptors=Lists.newArrayList();
  DiagnosticDescriptor currentDiagnosticDescriptor=null;
  for (  Diagnostic diagnostic : list) {
    TextRange textRange=getTextRanges(diagnostic).get(0);
    if (currentDiagnosticDescriptor != null && currentDiagnosticDescriptor.equalRange(textRange)) {
      currentDiagnosticDescriptor.diagnostics.add(diagnostic);
    }
 else {
      currentDiagnosticDescriptor=new DiagnosticDescriptor(textRange.getStartOffset(),textRange.getEndOffset(),diagnostic);
      diagnosticDescriptors.add(currentDiagnosticDescriptor);
    }
  }
  return diagnosticDescriptors;
}
