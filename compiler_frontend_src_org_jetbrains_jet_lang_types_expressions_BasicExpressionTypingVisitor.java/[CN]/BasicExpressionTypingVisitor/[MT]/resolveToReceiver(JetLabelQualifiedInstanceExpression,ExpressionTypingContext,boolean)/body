{
  String labelName=expression.getLabelName();
  if (labelName != null) {
    return context.labelResolver.resolveThisLabel(expression.getInstanceReference(),expression.getTargetLabel(),context,new LabelName(labelName));
  }
 else {
    ReceiverParameterDescriptor result=NO_RECEIVER_PARAMETER;
    List<ReceiverParameterDescriptor> receivers=context.scope.getImplicitReceiversHierarchy();
    if (onlyClassReceivers) {
      for (      ReceiverParameterDescriptor receiver : receivers) {
        if (receiver.getContainingDeclaration() instanceof ClassDescriptor) {
          result=receiver;
          break;
        }
      }
    }
 else     if (!receivers.isEmpty()) {
      result=receivers.get(0);
    }
    if (result.exists()) {
      context.trace.record(REFERENCE_TARGET,expression.getInstanceReference(),result.getContainingDeclaration());
    }
    return LabelResolver.LabeledReceiverResolutionResult.labelResolutionSuccess(result);
  }
}
