{
  JetIfExpression ifExpression=(JetIfExpression)returnExpression.getReturnedExpression();
  assertNotNull(ifExpression);
  JetIfExpression newIfExpression=(JetIfExpression)ifExpression.copy();
  JetExpression thenExpr=getOutermostLastBlockElement(newIfExpression.getThen());
  JetExpression elseExpr=getOutermostLastBlockElement(newIfExpression.getElse());
  assertNotNull(thenExpr);
  assertNotNull(elseExpr);
  JetPsiFactory psiFactory=JetPsiFactory(returnExpression);
  thenExpr.replace(psiFactory.createReturn(thenExpr));
  elseExpr.replace(psiFactory.createReturn(elseExpr));
  returnExpression.replace(newIfExpression);
}
