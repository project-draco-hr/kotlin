{
  TemporaryTraceAndCache temporaryForVariable=TemporaryTraceAndCache.create(context,"trace to resolve as local variable or property",nameExpression);
  CallResolver callResolver=expressionTypingServices.getCallResolver();
  Call call=CallMaker.makePropertyCall(receiver,callOperationNode,nameExpression);
  BasicCallResolutionContext contextForVariable=BasicCallResolutionContext.create(context.replaceTraceAndCache(temporaryForVariable),call,CheckValueArgumentsMode.ENABLED);
  OverloadResolutionResults<VariableDescriptor> resolutionResult=callResolver.resolveSimpleProperty(contextForVariable);
  if (resolutionResult.isSuccess()) {
    temporaryForVariable.commit();
    checkSuper(receiver,resolutionResult,context.trace,nameExpression);
    result[0]=true;
    return resolutionResult.isSingleResult() ? resolutionResult.getResultingDescriptor().getReturnType() : null;
  }
  ExpressionTypingContext newContext=receiver.exists() ? context.replaceScope(receiver.getType().getMemberScope()) : context;
  TemporaryTraceAndCache temporaryForPackageOrClassObject=TemporaryTraceAndCache.create(context,"trace to resolve as package or class object",nameExpression);
  JetType jetType=lookupPackageOrClassObject(nameExpression,newContext.replaceTraceAndCache(temporaryForPackageOrClassObject));
  if (jetType != null) {
    temporaryForPackageOrClassObject.commit();
    context.trace.record(RESOLUTION_SCOPE,nameExpression,context.scope);
    if (context.dataFlowInfo.hasTypeInfoConstraints()) {
      context.trace.record(NON_DEFAULT_EXPRESSION_DATA_FLOW,nameExpression,context.dataFlowInfo);
    }
    result[0]=true;
    return jetType;
  }
  temporaryForVariable.commit();
  result[0]=!resolutionResult.isNothing();
  return resolutionResult.isSingleResult() ? resolutionResult.getResultingDescriptor().getReturnType() : null;
}
