{
  ExpressionTypingContext context=contextWithExpectedType.replaceExpectedType(NO_EXPECTED_TYPE).replaceContextDependency(INDEPENDENT);
  StringTemplateVisitor visitor=new StringTemplateVisitor(context);
  for (  JetStringTemplateEntry entry : expression.getEntries()) {
    entry.accept(visitor);
  }
  ConstantExpressionEvaluator.evaluate(expression,context.trace,contextWithExpectedType.expectedType);
  return visitor.typeInfo.replaceType(components.builtIns.getStringType()).checkType(expression,contextWithExpectedType);
}
