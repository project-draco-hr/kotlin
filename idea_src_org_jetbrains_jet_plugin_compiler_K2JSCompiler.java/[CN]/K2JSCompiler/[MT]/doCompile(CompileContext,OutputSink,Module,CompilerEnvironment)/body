{
  CompilerUtils.OutputItemsCollectorImpl collector=new CompilerUtils.OutputItemsCollectorImpl(environment.getOutput().getPath());
  outputCompilerMessagesAndHandleExitCode(context,collector,new Function1<PrintStream,Integer>(){
    @Override public Integer invoke(    PrintStream stream){
      return execInProcess(context,environment,stream,module);
    }
  }
);
  sink.add(environment.getOutput().getPath(),collector.getOutputs(),collector.getSources().toArray(VirtualFile.EMPTY_ARRAY));
}
