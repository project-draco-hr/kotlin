{
  VirtualFile[] roots=ModuleRootManager.getInstance(module).getSourceRoots();
  if (roots.length != 1) {
    context.addMessage(CompilerMessageCategory.ERROR,"K2JSCompiler does not support multiple module source roots.",null,-1,-1);
    return -1;
  }
  VirtualFile outDir=context.getModuleOutputDirectory(module);
  String outFile=outDir == null ? null : outDir.getPath() + "/" + module.getName()+ ".js";
  String[] commandLineArgs=constructArguments(module,outFile,roots[0]);
  Object rc=invokeExecMethod(environment,out,context,commandLineArgs,"org.jetbrains.jet.cli.js.K2JSCompiler");
  if (outDir != null && !ApplicationManager.getApplication().isUnitTestMode()) {
    outDir.refresh(false,true);
  }
  return CompilerUtils.getReturnCodeFromObject(rc);
}
