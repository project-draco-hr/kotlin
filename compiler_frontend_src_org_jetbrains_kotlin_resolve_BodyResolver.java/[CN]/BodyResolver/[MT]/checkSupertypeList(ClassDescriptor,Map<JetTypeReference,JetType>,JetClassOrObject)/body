{
  Set<TypeConstructor> allowedFinalSupertypes=getAllowedFinalSupertypes(supertypeOwner,jetClass);
  Set<TypeConstructor> typeConstructors=Sets.newHashSet();
  boolean classAppeared=false;
  for (  Map.Entry<JetTypeReference,JetType> entry : supertypes.entrySet()) {
    JetTypeReference typeReference=entry.getKey();
    JetType supertype=entry.getValue();
    boolean addSupertype=true;
    ClassDescriptor classDescriptor=TypeUtils.getClassDescriptor(supertype);
    if (classDescriptor != null) {
      if (ErrorUtils.isError(classDescriptor))       continue;
      if (classDescriptor.getKind() != ClassKind.INTERFACE) {
        if (supertypeOwner.getKind() == ClassKind.ENUM_CLASS) {
          trace.report(CLASS_IN_SUPERTYPE_FOR_ENUM.on(typeReference));
          addSupertype=false;
        }
 else         if (supertypeOwner.getKind() == ClassKind.INTERFACE && !classAppeared && !TypesPackage.isDynamic(supertype)) {
          trace.report(INTERFACE_WITH_SUPERCLASS.on(typeReference));
          addSupertype=false;
        }
 else         if (jetClass.hasModifier(JetTokens.DATA_KEYWORD)) {
          trace.report(DATA_CLASS_CANNOT_HAVE_CLASS_SUPERTYPES.on(typeReference));
          addSupertype=false;
        }
        if (classAppeared) {
          trace.report(MANY_CLASSES_IN_SUPERTYPE_LIST.on(typeReference));
        }
 else {
          classAppeared=true;
        }
      }
    }
 else {
      trace.report(SUPERTYPE_NOT_A_CLASS_OR_INTERFACE.on(typeReference));
    }
    TypeConstructor constructor=supertype.getConstructor();
    if (addSupertype && !typeConstructors.add(constructor)) {
      trace.report(SUPERTYPE_APPEARS_TWICE.on(typeReference));
    }
    if (DescriptorUtils.isSingleton(classDescriptor)) {
      trace.report(SINGLETON_IN_SUPERTYPE.on(typeReference));
    }
 else     if (constructor.isFinal() && !allowedFinalSupertypes.contains(constructor)) {
      if (classDescriptor.getModality() == Modality.SEALED) {
        DeclarationDescriptor containingDescriptor=supertypeOwner.getContainingDeclaration();
        while (containingDescriptor != null && containingDescriptor != classDescriptor) {
          containingDescriptor=containingDescriptor.getContainingDeclaration();
        }
        if (containingDescriptor == null) {
          trace.report(SEALED_SUPERTYPE.on(typeReference));
        }
 else {
          trace.report(SEALED_SUPERTYPE_IN_LOCAL_CLASS.on(typeReference));
        }
      }
 else {
        trace.report(FINAL_SUPERTYPE.on(typeReference));
      }
    }
  }
}
