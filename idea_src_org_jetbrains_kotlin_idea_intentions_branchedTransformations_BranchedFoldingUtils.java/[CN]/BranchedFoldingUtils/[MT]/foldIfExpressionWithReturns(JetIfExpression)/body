{
  JetReturnExpression newReturnExpression=JetPsiFactory(ifExpression).createReturn(ifExpression);
  JetIfExpression newIfExpression=(JetIfExpression)newReturnExpression.getReturnedExpression();
  assertNotNull(newIfExpression);
  JetReturnExpression thenReturn=getFoldableBranchedReturn(newIfExpression.getThen());
  JetReturnExpression elseReturn=getFoldableBranchedReturn(newIfExpression.getElse());
  assertNotNull(thenReturn);
  assertNotNull(elseReturn);
  JetExpression thenExpr=thenReturn.getReturnedExpression();
  JetExpression elseExpr=elseReturn.getReturnedExpression();
  assertNotNull(thenExpr);
  assertNotNull(elseExpr);
  thenReturn.replace(thenExpr);
  elseReturn.replace(elseExpr);
  ifExpression.replace(newReturnExpression);
}
