{
  if (delegate == GlobalSearchScope.EMPTY_SCOPE)   return delegate;
  if (delegate instanceof KotlinSourceFilterScope) {
    KotlinSourceFilterScope wrappedDelegate=(KotlinSourceFilterScope)delegate;
    boolean doIncludeProjectSourceFiles=wrappedDelegate.includeProjectSourceFiles && includeProjectSourceFiles;
    boolean doIncludeLibrarySourceFiles=wrappedDelegate.includeLibrarySourceFiles && includeLibrarySourceFiles;
    boolean doIncludeClassFiles=wrappedDelegate.includeClassFiles && includeClassFiles;
    return new KotlinSourceFilterScope(wrappedDelegate.myBaseScope,doIncludeProjectSourceFiles,doIncludeLibrarySourceFiles,doIncludeClassFiles,project);
  }
  return new KotlinSourceFilterScope(delegate,includeProjectSourceFiles,includeLibrarySourceFiles,includeClassFiles,project);
}
