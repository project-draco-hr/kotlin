{
  TypeProjection value=substitutionContext.get(type.getConstructor());
  if (value != null) {
    Variance projectionKind=value.getProjectionKind();
    if (howThisTypeIsUsed.allowsInPosition() && !projectionKind.allowsInPosition() || howThisTypeIsUsed.allowsOutPosition() && !projectionKind.allowsOutPosition()) {
      return ErrorType.createWrongVarianceErrorType(value);
    }
    return value.getType();
  }
  return specializeType(type,substitutionContext);
}
