{
  CompileTimeConstant<?> compileTimeConstant=trace.get(BindingContext.COMPILE_TIME_VALUE,expression);
  if (compileTimeConstant != null) {
    return compileTimeConstant;
  }
  JetStringTemplateEntry[] stringTemplateEntries=expression.getEntries();
  if (stringTemplateEntries.length == 1) {
    CompileTimeConstant singleEntry=stringTemplateEntries[0].accept(this,nothing);
    if (!(singleEntry instanceof StringValue) && singleEntry != null) {
      return new StringValue(singleEntry.getValue().toString());
    }
    return singleEntry;
  }
 else   if (stringTemplateEntries.length > 1) {
    CompileTimeConstant<?> first=stringTemplateEntries[0].accept(this,nothing);
    if (first == null) {
      return null;
    }
    CompileTimeConstant<?> second;
    String tmpResult=null;
    for (int i=1; i < stringTemplateEntries.length; i++) {
      second=stringTemplateEntries[i].accept(this,nothing);
      if (second == null) {
        return null;
      }
      Object object=EvaluatePackage.evaluateBinaryExpression(first,second,Name.identifier("plus"));
      if (object instanceof String) {
        tmpResult=(String)object;
      }
 else {
        tmpResult=object.toString();
      }
      first=new StringValue(tmpResult);
    }
    return new StringValue(tmpResult);
  }
  return null;
}
