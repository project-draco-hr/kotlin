{
  final Type exprType=expressionType(expression);
  final Type leftType=expressionType(expression.getLeft());
  gen(expression.getLeft(),leftType);
  if (leftType.getSort() != Type.OBJECT && leftType.getSort() != Type.ARRAY) {
    if (leftType != exprType) {
      StackValue.onStack(leftType).put(exprType,v);
    }
    return StackValue.onStack(exprType);
  }
  v.dup();
  Label end=new Label();
  Label ifNull=new Label();
  v.ifnull(ifNull);
  StackValue.onStack(leftType).put(exprType,v);
  v.goTo(end);
  v.mark(ifNull);
  v.pop();
  gen(expression.getRight(),exprType);
  v.mark(end);
  return StackValue.onStack(exprType);
}
