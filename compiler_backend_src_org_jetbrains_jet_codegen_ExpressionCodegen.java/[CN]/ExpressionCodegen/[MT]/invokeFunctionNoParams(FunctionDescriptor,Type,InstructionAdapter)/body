{
  DeclarationDescriptor containingDeclaration=functionDescriptor.getContainingDeclaration();
  boolean isStatic=containingDeclaration instanceof NamespaceDescriptorImpl;
  functionDescriptor=functionDescriptor.getOriginal();
  String owner;
  IntrinsicMethod intrinsic=intrinsics.getIntrinsic(functionDescriptor);
  if (intrinsic != null) {
    intrinsic.generate(this,v,type,null,null,StackValue.onStack(TYPE_OBJECT));
    return;
  }
  boolean isInterface;
  boolean isInsideClass=containingDeclaration == context.getThisDescriptor();
  if (isInsideClass || isStatic) {
    owner=typeMapper.getOwner(functionDescriptor,contextKind());
    isInterface=false;
  }
 else {
    owner=typeMapper.getOwner(functionDescriptor,OwnerKind.IMPLEMENTATION);
    if (containingDeclaration instanceof JavaClassDescriptor) {
      isInterface=CodegenUtil.isInterface(containingDeclaration);
    }
 else {
      if (containingDeclaration instanceof ClassDescriptor && ((ClassDescriptor)containingDeclaration).getKind() == ClassKind.OBJECT)       isInterface=false;
 else {
        JetClass jetClass=(JetClass)bindingContext.get(BindingContext.DESCRIPTOR_TO_DECLARATION,containingDeclaration);
        isInterface=jetClass == null || jetClass.isTrait();
      }
    }
  }
  v.visitMethodInsn(isStatic ? Opcodes.INVOKESTATIC : isInterface ? Opcodes.INVOKEINTERFACE : Opcodes.INVOKEVIRTUAL,owner,functionDescriptor.getName(),typeMapper.mapSignature(functionDescriptor.getName(),functionDescriptor).getDescriptor());
  StackValue.onStack(asmType(functionDescriptor.getReturnType())).coerce(type,v);
}
