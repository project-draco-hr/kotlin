{
  if (expr instanceof JetBinaryExpression) {
    final JetBinaryExpression binaryExpression=(JetBinaryExpression)expr;
    if (binaryExpression.getOperationToken() == JetTokens.PLUS) {
      JetExpression left=binaryExpression.getLeft();
      JetExpression right=binaryExpression.getRight();
      Type leftType=expressionType(left);
      Type rightType=expressionType(right);
      if (leftType.equals(JetTypeMapper.JAVA_STRING_TYPE) && rightType.equals(JAVA_STRING_TYPE)) {
        invokeAppend(left);
        invokeAppend(right);
        return;
      }
    }
  }
  Type exprType=expressionType(expr);
  gen(expr,exprType);
  invokeAppendMethod(exprType.getSort() == Type.ARRAY ? OBJECT_TYPE : exprType);
}
