{
  final IntrinsicMethod intrinsic=state.getInjector().getIntrinsics().getIntrinsic(fd);
  if (intrinsic != null) {
    return intrinsic;
  }
  CallableMethod callableMethod;
  if (fd instanceof ExpressionAsFunctionDescriptor || (fd instanceof SimpleFunctionDescriptor && (fd.getContainingDeclaration() instanceof FunctionDescriptor || fd.getContainingDeclaration() instanceof ScriptDescriptor))) {
    SimpleFunctionDescriptor invoke=CodegenUtil.createInvoke((FunctionDescriptor)fd);
    callableMethod=ClosureCodegen.asCallableMethod(invoke,typeMapper);
  }
 else   if (fd instanceof FunctionDescriptor) {
    callableMethod=typeMapper.mapToCallableMethod((FunctionDescriptor)fd,superCall,OwnerKind.IMPLEMENTATION);
  }
 else {
    throw new UnsupportedOperationException("can't resolve declaration to callable: " + fd);
  }
  return callableMethod;
}
