{
  if (expression.getOperationReference().getReferencedNameElementType() == JetTokens.EXCLEXCL) {
    StackValue base=genQualified(receiver,expression.getBaseExpression());
    if (isPrimitive(base.type)) {
      return base;
    }
    base.put(base.type,v);
    v.dup();
    Label ok=new Label();
    v.ifnonnull(ok);
    v.invokestatic("kotlin/jvm/internal/Intrinsics","throwNpe","()V",false);
    v.mark(ok);
    return StackValue.onStack(base.type);
  }
  DeclarationDescriptor op=bindingContext.get(REFERENCE_TARGET,expression.getOperationReference());
  if (!(op instanceof FunctionDescriptor)) {
    throw new UnsupportedOperationException("Don't know how to generate this postfix expression: " + op);
  }
  Type asmType=expressionType(expression);
  DeclarationDescriptor cls=op.getContainingDeclaration();
  int increment;
  if (op.getName().asString().equals("inc")) {
    increment=1;
  }
 else   if (op.getName().asString().equals("dec")) {
    increment=-1;
  }
 else {
    throw new UnsupportedOperationException("Unsupported postfix operation: " + op);
  }
  boolean isPrimitiveNumberClassDescriptor=isPrimitiveNumberClassDescriptor(cls);
  if (isPrimitiveNumberClassDescriptor) {
    JetExpression operand=expression.getBaseExpression();
    if (operand instanceof JetReferenceExpression && asmType == Type.INT_TYPE) {
      int index=indexOfLocal((JetReferenceExpression)operand);
      if (index >= 0) {
        return StackValue.postIncrement(index,increment);
      }
    }
  }
  StackValue value=gen(expression.getBaseExpression());
  value.dupReceiver(v);
  Type type=expressionType(expression.getBaseExpression());
  value.put(type,v);
  pushReceiverAndValueViaDup(value,type);
  Type storeType;
  if (isPrimitiveNumberClassDescriptor) {
    genIncrement(asmType,increment,v);
    storeType=type;
  }
 else {
    ResolvedCall<?> resolvedCall=getResolvedCallWithAssert(expression,bindingContext);
    Callable callable=resolveToCallable((FunctionDescriptor)op,false);
    CallableMethod callableMethod=(CallableMethod)callable;
    callableMethod.invokeWithNotNullAssertion(v,state,resolvedCall);
    storeType=callableMethod.getReturnType();
  }
  value.store(storeType,v);
  return StackValue.onStack(asmType);
}
