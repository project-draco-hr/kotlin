{
  PsiElement containingFunction=PsiTreeUtil.getParentOfType(startExpression,JetClassOrObject.class,JetDeclarationWithBody.class);
  if (containingFunction == null) {
    return false;
  }
  DeclarationDescriptor containingFunctionDescriptor=trace.get(BindingContext.DECLARATION_TO_DESCRIPTOR,containingFunction);
  if (containingFunctionDescriptor == null) {
    return false;
  }
  BindingContext bindingContext=trace.getBindingContext();
  while (isFunctionalExpression(containingFunction) && fromFunction != containingFunctionDescriptor) {
    if (!isInlineLambda((JetFunction)containingFunction,bindingContext,true)) {
      return false;
    }
    containingFunctionDescriptor=getContainingClassOrFunctionDescriptor(containingFunctionDescriptor,true);
    containingFunction=containingFunctionDescriptor != null ? DescriptorToSourceUtils.descriptorToDeclaration(containingFunctionDescriptor) : null;
  }
  return fromFunction == containingFunctionDescriptor;
}
