{
  if (myEnvironment != null) {
    throw new IllegalStateException("must not set up myEnvironment twice");
  }
  CompilerConfiguration configuration=compilerConfigurationForTests(configurationKind,TestJdkKind.MOCK_JDK,Collections.singletonList(getAnnotationsJar()),new SmartList<File>(javaSourceRoot));
  myEnvironment=KotlinCoreEnvironment.createForTests(getTestRootDisposable(),configuration,EnvironmentConfigFiles.JVM_CONFIG_FILES);
}
