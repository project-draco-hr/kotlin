{
synchronized (lock) {
    CachedValue<AnalyzeExhaust> bindingContextCachedValue=file.getUserData(BINDING_CONTEXT);
    if (bindingContextCachedValue == null) {
      bindingContextCachedValue=CachedValuesManager.getManager(file.getProject()).createCachedValue(new CachedValueProvider<AnalyzeExhaust>(){
        @Override public Result<AnalyzeExhaust> compute(){
          try {
            AnalyzeExhaust bindingContext;
            bindingContext=analyzeFilesWithJavaIntegration(file.getProject(),declarationProvider.fun(file),Predicates.<PsiFile>equalTo(file),JetControlFlowDataTraceFactory.EMPTY,compilerDependencies);
            return new Result<AnalyzeExhaust>(bindingContext,PsiModificationTracker.MODIFICATION_COUNT);
          }
 catch (          ProcessCanceledException e) {
            throw e;
          }
catch (          Throwable e) {
            DiagnosticUtils.throwIfRunningOnServer(e);
            LOG.error(e);
            BindingTraceContext bindingTraceContext=new BindingTraceContext();
            bindingTraceContext.report(Errors.EXCEPTION_WHILE_ANALYZING.on(file,e));
            AnalyzeExhaust analyzeExhaust=new AnalyzeExhaust(bindingTraceContext.getBindingContext(),null);
            return new Result<AnalyzeExhaust>(analyzeExhaust,PsiModificationTracker.MODIFICATION_COUNT);
          }
        }
      }
,false);
      file.putUserData(BINDING_CONTEXT,bindingContextCachedValue);
    }
    return bindingContextCachedValue.getValue();
  }
}
