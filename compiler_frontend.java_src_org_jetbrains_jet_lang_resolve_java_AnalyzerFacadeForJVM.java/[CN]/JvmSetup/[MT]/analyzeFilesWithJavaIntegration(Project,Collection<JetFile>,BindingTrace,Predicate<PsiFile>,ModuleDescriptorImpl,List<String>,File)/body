{
  GlobalContext globalContext=ContextPackage.GlobalContext();
  TopDownAnalysisParameters topDownAnalysisParameters=TopDownAnalysisParameters.create(globalContext.getStorageManager(),globalContext.getExceptionTracker(),filesToAnalyzeCompletely,false,false);
  InjectorForTopDownAnalyzerForJvm injector=new InjectorForTopDownAnalyzerForJvm(project,topDownAnalysisParameters,trace,module);
  try {
    module.addFragmentProvider(DependencyKind.BINARIES,injector.getJavaDescriptorResolver().getPackageFragmentProvider());
    IncrementalCacheProvider incrementalCacheProvider=IncrementalCacheProvider.object$.getInstance();
    if (incrementalCacheDir != null && moduleIds != null && incrementalCacheProvider != null) {
      IncrementalCache incrementalCache=incrementalCacheProvider.getIncrementalCache(incrementalCacheDir);
      for (      String moduleId : moduleIds) {
        module.addFragmentProvider(DependencyKind.SOURCES,new IncrementalPackageFragmentProvider(files,module,globalContext.getStorageManager(),injector.getDeserializationGlobalContextForJava(),incrementalCache,moduleId,injector.getJavaDescriptorResolver()));
      }
    }
    injector.getTopDownAnalyzer().analyzeFiles(topDownAnalysisParameters,files);
    return AnalyzeExhaust.success(trace.getBindingContext(),module);
  }
  finally {
    injector.destroy();
  }
}
