{
  JetExpression left=JetPsiUtil.deparenthesize(expression.getLeft());
  JetExpression right=expression.getRight();
  if (left instanceof JetArrayAccessExpression) {
    JetArrayAccessExpression arrayAccessExpression=(JetArrayAccessExpression)left;
    return resolveArrayAccessToLValue(arrayAccessExpression,right,expression.getOperationReference(),context);
  }
  JetType leftType=left == null ? ErrorUtils.createErrorType("No expression") : facade.getType(left,context.replaceExpectedType(TypeUtils.NO_EXPECTED_TYPE).replaceScope(scope));
  if (right != null) {
    JetType rightType=facade.getType(right,context.replaceExpectedType(leftType).replaceScope(scope));
  }
  VariableDescriptor variable=BindingContextUtils.extractVariableDescriptorIfAny(context.trace.getBindingContext(),left,true);
  if (variable == null && leftType != null) {
    context.trace.report(VARIABLE_EXPECTED.on(left != null ? left : expression.getLeft()));
  }
  if (left instanceof JetSimpleNameExpression) {
    JetSimpleNameExpression simpleName=(JetSimpleNameExpression)left;
    String referencedName=simpleName.getReferencedName();
    if (simpleName.getReferencedNameElementType() == JetTokens.FIELD_IDENTIFIER && referencedName != null) {
      PropertyDescriptor property=context.scope.getPropertyByFieldReference(referencedName);
      if (property != null) {
        context.trace.record(BindingContext.VARIABLE_ASSIGNMENT,simpleName,property);
      }
    }
    ExpressionTypingUtils.checkWrappingInRef(simpleName,context);
  }
  return checkExpectedType(expression,context);
}
