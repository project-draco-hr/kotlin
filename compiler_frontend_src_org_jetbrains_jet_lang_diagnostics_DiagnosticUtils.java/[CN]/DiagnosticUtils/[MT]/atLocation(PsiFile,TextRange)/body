{
  Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  int offset=textRange.getStartOffset();
  VirtualFile virtualFile=file.getVirtualFile();
  String pathSuffix=virtualFile == null ? "" : " in " + virtualFile.getPath();
  if (document != null) {
    int lineNumber=document.getLineNumber(offset);
    int lineStartOffset=document.getLineStartOffset(lineNumber);
    int column=offset - lineStartOffset;
    return "' at line " + (lineNumber + 1) + ":"+ column+ pathSuffix;
  }
 else {
    return "' at offset " + offset + " (line unknown)"+ pathSuffix;
  }
}
