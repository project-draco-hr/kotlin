{
  configureByFile(getTestName(false) + ".kt");
  boolean oldValue=CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY;
  try {
    CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY=true;
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        ImportInsertHelper.addImportDirectiveIfNeeded(new FqName(importString),(JetFile)getFile());
      }
    }
);
  }
  finally {
    CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY=oldValue;
  }
  checkResultByFile(getTestName(false) + ".kt.after");
}
