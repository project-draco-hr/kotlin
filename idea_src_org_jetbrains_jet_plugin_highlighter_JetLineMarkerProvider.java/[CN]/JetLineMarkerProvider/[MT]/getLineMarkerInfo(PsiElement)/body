{
  JetFile file=(JetFile)element.getContainingFile();
  if (file == null)   return null;
  if (!(element instanceof JetNamedFunction))   return null;
  JetNamedFunction jetFunction=(JetNamedFunction)element;
  final BindingContext bindingContext=WholeProjectAnalyzerFacade.analyzeProjectWithCacheOnAFile(file);
  final SimpleFunctionDescriptor functionDescriptor=bindingContext.get(BindingContext.FUNCTION,jetFunction);
  if (functionDescriptor == null)   return null;
  final Set<? extends FunctionDescriptor> overriddenFunctions=functionDescriptor.getOverriddenDescriptors();
  if (overriddenFunctions.size() == 0)   return null;
  boolean allOverriddenAbstract=true;
  for (  FunctionDescriptor function : overriddenFunctions) {
    allOverriddenAbstract&=function.getModality() == Modality.ABSTRACT;
  }
  final String implementsOrOverrides=allOverriddenAbstract ? "implements" : "overrides";
  return new LineMarkerInfo<JetNamedFunction>(jetFunction,jetFunction.getTextOffset(),allOverriddenAbstract ? IMPLEMENTING_MARK : OVERRIDING_MARK,Pass.UPDATE_ALL,new Function<JetNamedFunction,String>(){
    @Override public String fun(    JetNamedFunction jetFunction){
      StringBuilder builder=new StringBuilder();
      builder.append(DescriptorRenderer.HTML.render(functionDescriptor));
      int overrideCount=overriddenFunctions.size();
      if (overrideCount >= 1) {
        builder.append(" ").append(implementsOrOverrides).append(" ");
        builder.append(DescriptorRenderer.HTML.render(overriddenFunctions.iterator().next()));
      }
      if (overrideCount > 1) {
        int count=overrideCount - 1;
        builder.append(" and ").append(count).append(" other function");
        if (count > 1) {
          builder.append("s");
        }
      }
      return builder.toString();
    }
  }
,new GutterIconNavigationHandler<JetNamedFunction>(){
    @Override public void navigate(    MouseEvent event,    JetNamedFunction elt){
      if (overriddenFunctions.isEmpty())       return;
      final List<PsiElement> list=Lists.newArrayList();
      for (      FunctionDescriptor overriddenFunction : overriddenFunctions) {
        PsiElement declarationPsiElement=bindingContext.get(BindingContext.DESCRIPTOR_TO_DECLARATION,overriddenFunction);
        list.add(declarationPsiElement);
      }
      if (list.isEmpty()) {
        String myEmptyText="empty text";
        final JComponent renderer=HintUtil.createErrorLabel(myEmptyText);
        final JBPopup popup=JBPopupFactory.getInstance().createComponentPopupBuilder(renderer,renderer).createPopup();
        if (event != null) {
          popup.show(new RelativePoint(event));
        }
        return;
      }
      if (list.size() == 1) {
        PsiNavigateUtil.navigate(list.iterator().next());
      }
 else {
        final JBPopup popup=NavigationUtil.getPsiElementPopup(PsiUtilBase.toPsiElementArray(list),new DefaultPsiElementCellRenderer(){
          @Override public String getElementText(          PsiElement element){
            if (element instanceof JetNamedFunction) {
              JetNamedFunction function=(JetNamedFunction)element;
              return DescriptorRenderer.HTML.render(bindingContext.get(BindingContext.FUNCTION,function));
            }
            return super.getElementText(element);
          }
        }
,DescriptorRenderer.HTML.render(functionDescriptor));
        if (event != null) {
          popup.show(new RelativePoint(event));
        }
      }
    }
  }
);
}
