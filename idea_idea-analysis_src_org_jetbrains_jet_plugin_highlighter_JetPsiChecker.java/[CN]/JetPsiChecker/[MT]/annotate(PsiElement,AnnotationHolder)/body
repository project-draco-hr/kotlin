{
  if (!(ProjectRootsUtil.isInProjectOrLibSource(element) || element.getContainingFile() instanceof JetCodeFragment))   return;
  for (  HighlightingVisitor visitor : getBeforeAnalysisVisitors(holder)) {
    element.accept(visitor);
  }
  JetFile file=(JetFile)element.getContainingFile();
  AnalysisResult analysisResult=ResolvePackage.analyzeFullyAndGetResult(file);
  if (analysisResult.isError()) {
    throw new ProcessCanceledException(analysisResult.getError());
  }
  BindingContext bindingContext=analysisResult.getBindingContext();
  for (  HighlightingVisitor visitor : getAfterAnalysisVisitor(holder,bindingContext)) {
    element.accept(visitor);
  }
  annotateElement(element,holder,bindingContext.getDiagnostics());
}
