{
  Index index=new Index();
  for (  JetFile file : files) {
    JetPackageDirective directive=file.getPackageDirective();
    if (directive == null) {
      throw new IllegalArgumentException("Scripts are not supported");
    }
    FqName packageFqName=new FqName(directive.getQualifiedName());
    addMeAndParentPackages(index,packageFqName);
    index.filesByPackage.put(packageFqName,file);
  }
  return index;
}
