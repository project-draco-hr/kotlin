{
  JetFile jetFile=(JetFile)expression.getContainingFile();
  final ResolveSession resolveSessionForFile=WholeProjectAnalyzerFacade.getLazyResolveSessionForFile(jetFile);
  LazyBindingContextUtils.getExpressionBindingContext(resolveSessionForFile,expression);
  BindingContext context=WholeProjectAnalyzerFacade.getLazyResolveContext(jetFile,expression);
  JetScope jetScope=context.get(BindingContext.RESOLUTION_SCOPE,expression);
  if (jetScope == null) {
    return Collections.emptyList();
  }
  Set<FunctionDescriptor> result=Sets.newHashSet();
  Collection<PsiMethod> topLevelFunctionPrototypes=JetFromJavaDescriptorHelper.getTopLevelFunctionPrototypesByName(name,project,scope);
  for (  PsiMethod method : topLevelFunctionPrototypes) {
    FqName functionFQN=JetFromJavaDescriptorHelper.getJetTopLevelDeclarationFQN(method);
    if (functionFQN != null) {
      JetImportDirective importDirective=JetPsiFactory.createImportDirective(project,new ImportPath(functionFQN,false));
      Collection<? extends DeclarationDescriptor> declarationDescriptors=new QualifiedExpressionResolver().analyseImportReference(importDirective,jetScope,new BindingTraceContext());
      for (      DeclarationDescriptor declarationDescriptor : declarationDescriptors) {
        if (declarationDescriptor instanceof FunctionDescriptor) {
          result.add((FunctionDescriptor)declarationDescriptor);
        }
      }
    }
  }
  Collection<JetNamedFunction> jetNamedFunctions=JetShortFunctionNameIndex.getInstance().get(name,project,scope);
  for (  JetNamedFunction jetNamedFunction : jetNamedFunctions) {
    FunctionDescriptor functionDescriptor=(FunctionDescriptor)resolveSessionForFile.resolveToDescriptor(jetNamedFunction);
    result.add(functionDescriptor);
  }
  return result;
}
