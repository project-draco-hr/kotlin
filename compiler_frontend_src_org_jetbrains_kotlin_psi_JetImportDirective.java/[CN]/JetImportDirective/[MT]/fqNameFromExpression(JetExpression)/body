{
  if (expression == null) {
    return null;
  }
  if (expression instanceof JetDotQualifiedExpression) {
    JetDotQualifiedExpression dotQualifiedExpression=(JetDotQualifiedExpression)expression;
    FqName parentFqn=fqNameFromExpression(dotQualifiedExpression.getReceiverExpression());
    Name child=nameFromExpression(dotQualifiedExpression.getSelectorExpression());
    if (child == null) {
      return parentFqn;
    }
    if (parentFqn != null) {
      return parentFqn.child(child);
    }
    return null;
  }
 else   if (expression instanceof JetSimpleNameExpression) {
    JetSimpleNameExpression simpleNameExpression=(JetSimpleNameExpression)expression;
    return FqName.topLevel(simpleNameExpression.getReferencedNameAsName());
  }
 else {
    throw new IllegalArgumentException("Can't construct fqn for: " + expression.getClass().toString());
  }
}
