{
  JetExpression subjectExpression=expression.getSubjectExpression();
  if (subjectExpression == null)   return false;
  JetType type=trace.get(BindingContext.EXPRESSION_TYPE,subjectExpression);
  if (type == null)   return false;
  DeclarationDescriptor declarationDescriptor=type.getConstructor().getDeclarationDescriptor();
  if (!(declarationDescriptor instanceof ClassDescriptor))   return false;
  ClassDescriptor classDescriptor=(ClassDescriptor)declarationDescriptor;
  if (classDescriptor.getKind() != ClassKind.ENUM_CLASS || classDescriptor.getModality().isOverridable())   return false;
  boolean isExhaust=true;
  boolean notEmpty=false;
  for (  DeclarationDescriptor descriptor : getEnumEntriesScope(classDescriptor).getAllDescriptors()) {
    if (isEnumEntry(descriptor)) {
      notEmpty=true;
      if (!containsEnumEntryCase(expression,(ClassDescriptor)descriptor,trace)) {
        isExhaust=false;
      }
    }
  }
  boolean exhaustive=isExhaust && notEmpty;
  if (exhaustive) {
    trace.record(BindingContext.EXHAUSTIVE_WHEN,expression);
  }
  return exhaustive;
}
