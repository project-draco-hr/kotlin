{
  if (!FileModificationService.getInstance().prepareFileForWrite(file)) {
    return;
  }
  JetPsiFactory psiFactory=JetPsiFactory(project);
  if (!isRemove) {
    JetExpression modifiedExpression=getExpressionForIntroduceCall(editor,file);
    JetExpression exclExclExpression=psiFactory.createExpression(modifiedExpression.getText() + "!!");
    modifiedExpression.replace(exclExclExpression);
  }
 else {
    JetPostfixExpression postfixExpression=getExclExclPostfixExpression(editor,file);
    JetExpression expression=psiFactory.createExpression(postfixExpression.getBaseExpression().getText());
    postfixExpression.replace(expression);
  }
}
