{
  PsiManager manager=PsiManager.getInstance(project);
  final PsiJavaFileStubImpl javaFileStub=new PsiJavaFileStubImpl(packageFqName.asString(),true);
  javaFileStub.setPsiFactory(new ClsWrapperStubPsiFactory());
  ClsFileImpl fakeFile=new ClsFileImpl(new ClassFileViewProvider(manager,virtualFile)){
    @NotNull @Override public PsiClassHolderFileStub getStub(){
      return javaFileStub;
    }
    @NotNull @Override public String getPackageName(){
      return packageFqName.asString();
    }
  }
;
  fakeFile.setPhysical(false);
  javaFileStub.setPsi(fakeFile);
  return javaFileStub;
}
