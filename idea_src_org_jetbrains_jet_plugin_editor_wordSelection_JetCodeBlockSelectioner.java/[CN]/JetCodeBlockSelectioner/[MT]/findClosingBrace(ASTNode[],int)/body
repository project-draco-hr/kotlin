{
  int end=children[children.length - 1].getTextRange().getEndOffset();
  for (int i=0; i < children.length; i++) {
    PsiElement child=children[i].getPsi();
    if (child instanceof LeafPsiElement) {
      if (((LeafPsiElement)child).getElementType() == JetTokens.RBRACE) {
        int j=i - 1;
        while (children[j] instanceof PsiWhiteSpace && children[j].getTextRange().getStartOffset() > startOffset) {
          j--;
        }
        end=children[j].getTextRange().getEndOffset();
      }
    }
  }
  return end;
}
