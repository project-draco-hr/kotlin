{
  List<JetFile> jetFiles=getJetFiles(testFiles);
  BindingTrace trace=CliLightClassGenerationSupport.getInstanceForCli(getProject()).getTrace();
  BindingContext bindingContext=AnalyzerFacadeForJVM.analyzeFilesWithJavaIntegration(getProject(),jetFiles,trace,Collections.<AnalyzerScriptParameter>emptyList(),Predicates.<PsiFile>alwaysTrue(),false).getBindingContext();
  boolean ok=true;
  StringBuilder actualText=new StringBuilder();
  for (  TestFile testFile : testFiles) {
    ok&=testFile.getActualText(bindingContext,actualText);
  }
  JetTestUtils.assertEqualsToFile(testDataFile,actualText.toString());
  assertTrue("Diagnostics mismatch. See the output above",ok);
  checkAllResolvedCallsAreCompleted(jetFiles,bindingContext);
}
