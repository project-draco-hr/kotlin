{
  if (!(root instanceof JetElement))   return null;
  final List<T> results=Lists.newArrayList();
  ((JetElement)root).accept(new JetVisitorVoid(){
    @Override public void visitJetElement(    JetElement element){
      if (PsiTreeUtil.instanceOf(element,elementTypes)) {
        results.add((T)element);
      }
 else {
        element.acceptChildren(this);
      }
    }
  }
);
  if (results.isEmpty())   return null;
  return first ? results.get(0) : results.get(results.size() - 1);
}
