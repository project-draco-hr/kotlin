{
  if (deparenthesizeBinaryExpressionWithTypeRHS && expression instanceof JetBinaryExpressionWithTypeRHS) {
    JetBinaryExpressionWithTypeRHS binaryExpression=(JetBinaryExpressionWithTypeRHS)expression;
    JetSimpleNameExpression operationSign=binaryExpression.getOperationReference();
    if (JetTokens.COLON.equals(operationSign.getReferencedNameElementType())) {
      expression=binaryExpression.getLeft();
      JetTypeReference typeReference=binaryExpression.getRight();
      if (typeResolutionStrategy != null && typeReference != null) {
        typeResolutionStrategy.apply(typeReference);
      }
    }
  }
 else   if (expression instanceof JetLabeledExpression) {
    JetExpression baseExpression=((JetLabeledExpression)expression).getBaseExpression();
    if (baseExpression != null) {
      expression=baseExpression;
    }
  }
 else   if (expression instanceof JetExpressionWrapper) {
    expression=((JetExpressionWrapper)expression).getBaseExpression();
  }
  if (expression instanceof JetParenthesizedExpression) {
    JetExpression innerExpression=((JetParenthesizedExpression)expression).getExpression();
    return innerExpression != null && deparenthesizeRecursively ? deparenthesizeWithResolutionStrategy(innerExpression,deparenthesizeBinaryExpressionWithTypeRHS,true,typeResolutionStrategy) : innerExpression;
  }
  return expression;
}
