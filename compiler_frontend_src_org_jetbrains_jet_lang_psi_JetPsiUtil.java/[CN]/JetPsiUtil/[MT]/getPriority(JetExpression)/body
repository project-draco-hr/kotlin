{
  int maxPriority=JetExpressionParsing.Precedence.values().length + 1;
  if (expression instanceof JetPostfixExpression || expression instanceof JetQualifiedExpression || expression instanceof JetCallExpression|| expression instanceof JetArrayAccessExpression) {
    return maxPriority - 1;
  }
  if (expression instanceof JetPrefixExpression || expression instanceof JetLabeledExpression)   return maxPriority - 2;
  if (expression instanceof JetIfExpression) {
    return JetExpressionParsing.Precedence.ASSIGNMENT.ordinal();
  }
  if (expression instanceof JetDeclaration || expression instanceof JetStatementExpression) {
    return 0;
  }
  IElementType operation=getOperation(expression);
  for (  JetExpressionParsing.Precedence precedence : JetExpressionParsing.Precedence.values()) {
    if (precedence != JetExpressionParsing.Precedence.PREFIX && precedence != JetExpressionParsing.Precedence.POSTFIX && precedence.getOperations().contains(operation)) {
      return maxPriority - precedence.ordinal() - 1;
    }
  }
  return maxPriority;
}
