{
  if (!(root instanceof JetElement))   return null;
  final List<JetElement> results=Lists.newArrayList();
  root.accept(new JetVisitorVoid(){
    @Override public void visitJetElement(    @NotNull JetElement element){
      if (predicate.apply(element)) {
        results.add(element);
      }
 else {
        element.acceptChildren(this);
      }
    }
  }
);
  if (results.isEmpty())   return null;
  return first ? results.get(0) : results.get(results.size() - 1);
}
