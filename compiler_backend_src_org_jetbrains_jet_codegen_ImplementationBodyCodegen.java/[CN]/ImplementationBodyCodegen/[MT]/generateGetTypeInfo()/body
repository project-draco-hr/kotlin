{
  if (myClass instanceof JetClass && ((JetClass)myClass).isTrait())   return;
  JetType defaultType=descriptor.getDefaultType();
  if (CodegenUtil.requireTypeInfoConstructorArg(defaultType)) {
    if (!CodegenUtil.hasDerivedTypeInfoField(defaultType)) {
      v.newField(myClass,Opcodes.ACC_PROTECTED,"$typeInfo","Ljet/TypeInfo;",null,null);
      MethodVisitor mv=v.newMethod(myClass,Opcodes.ACC_PUBLIC,"getTypeInfo","()Ljet/TypeInfo;",null,null);
      if (v.generateCode()) {
        mv.visitCode();
        InstructionAdapter iv=new InstructionAdapter(mv);
        String owner=typeMapper.mapType(descriptor.getDefaultType(),OwnerKind.IMPLEMENTATION).getInternalName();
        iv.load(0,JetTypeMapper.TYPE_OBJECT);
        iv.getfield(owner,"$typeInfo","Ljet/TypeInfo;");
        iv.areturn(JetTypeMapper.TYPE_TYPEINFO);
        FunctionCodegen.endVisit(iv,"getTypeInfo",myClass);
      }
      mv=v.newMethod(myClass,Opcodes.ACC_PROTECTED | Opcodes.ACC_FINAL,"$setTypeInfo","(Ljet/TypeInfo;)V",null,null);
      if (v.generateCode()) {
        mv.visitCode();
        InstructionAdapter iv=new InstructionAdapter(mv);
        String owner=typeMapper.mapType(descriptor.getDefaultType(),OwnerKind.IMPLEMENTATION).getInternalName();
        iv.load(0,JetTypeMapper.TYPE_OBJECT);
        iv.load(1,JetTypeMapper.TYPE_OBJECT);
        iv.putfield(owner,"$typeInfo","Ljet/TypeInfo;");
        mv.visitInsn(Opcodes.RETURN);
        FunctionCodegen.endVisit(iv,"$setTypeInfo",myClass);
      }
    }
  }
 else {
    genGetStaticGetTypeInfoMethod();
    staticTypeInfoField();
  }
}
