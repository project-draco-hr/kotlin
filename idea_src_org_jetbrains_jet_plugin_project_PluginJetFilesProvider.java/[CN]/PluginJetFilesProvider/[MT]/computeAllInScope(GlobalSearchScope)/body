{
  final PsiManager manager=PsiManager.getInstance(project);
  Collection<JetFile> jetFiles=ContainerUtil.map(FileTypeIndex.getFiles(JetFileType.INSTANCE,scope),new Function<VirtualFile,JetFile>(){
    @Override public JetFile fun(    @Nullable VirtualFile file){
      if (file == null || !isKotlinSourceVirtualFile(file)) {
        return null;
      }
      PsiFile psiFile=manager.findFile(file);
      if (!(psiFile instanceof JetFile)) {
        return null;
      }
      return ((JetFile)psiFile);
    }
  }
);
  return Sets.newHashSet(Collections2.filter(jetFiles,Predicates.<JetFile>notNull()));
}
