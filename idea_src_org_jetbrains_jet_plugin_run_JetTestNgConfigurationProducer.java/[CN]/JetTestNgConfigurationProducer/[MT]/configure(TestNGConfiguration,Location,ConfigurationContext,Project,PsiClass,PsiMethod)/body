{
  if (delegate == null) {
    return false;
  }
  setupConfigurationModule(context,configuration);
  Module originalModule=configuration.getConfigurationModule().getModule();
  configuration.setClassConfiguration(delegate);
  if (method != null) {
    configuration.setMethodConfiguration(PsiLocation.fromPsiElement(project,method));
  }
  configuration.restoreOriginalModule(originalModule);
  configuration.setName(configuration.getName());
  JavaRunConfigurationExtensionManager.getInstance().extendCreatedConfiguration(configuration,location);
  return true;
}
