{
  ProgressIndicatorProvider.checkCanceled();
  ResolvedCallImpl<D> candidateCall=context.candidateCall;
  D candidate=candidateCall.getCandidateDescriptor();
  if (ErrorUtils.isError(candidate)) {
    candidateCall.addStatus(SUCCESS);
    checkTypesWithNoCallee(context.toBasic());
    return;
  }
  if (!Visibilities.isVisible(candidate,context.scope.getContainingDeclaration())) {
    candidateCall.addStatus(OTHER_ERROR);
    context.tracing.invisibleMember(context.trace,candidate);
    return;
  }
  Set<ValueArgument> unmappedArguments=Sets.newLinkedHashSet();
  ValueArgumentsToParametersMapper.Status argumentMappingStatus=ValueArgumentsToParametersMapper.mapValueArgumentsToParameters(context.call,context.tracing,candidateCall,unmappedArguments);
  if (!argumentMappingStatus.isSuccess()) {
    if (argumentMappingStatus == ValueArgumentsToParametersMapper.Status.STRONG_ERROR) {
      candidateCall.addStatus(STRONG_ERROR);
    }
 else {
      candidateCall.addStatus(OTHER_ERROR);
    }
    if ((argumentMappingStatus == ValueArgumentsToParametersMapper.Status.ERROR && candidate.getTypeParameters().isEmpty()) || argumentMappingStatus == ValueArgumentsToParametersMapper.Status.STRONG_ERROR) {
      checkTypesWithNoCallee(context.toBasic());
      return;
    }
    checkUnmappedArgumentTypes(context.toBasic(),unmappedArguments);
  }
  List<JetTypeProjection> jetTypeArguments=context.call.getTypeArguments();
  if (jetTypeArguments.isEmpty()) {
    if (!candidate.getTypeParameters().isEmpty()) {
      ResolutionStatus status=inferTypeArguments(context);
      candidateCall.addStatus(status);
    }
 else {
      candidateCall.addStatus(checkAllValueArguments(context).status);
    }
  }
 else {
    List<JetType> typeArguments=new ArrayList<JetType>();
    for (    JetTypeProjection projection : jetTypeArguments) {
      if (projection.getProjectionKind() != JetProjectionKind.NONE) {
        context.trace.report(PROJECTION_ON_NON_CLASS_TYPE_ARGUMENT.on(projection));
      }
      JetTypeReference typeReference=projection.getTypeReference();
      if (typeReference != null) {
        typeArguments.add(typeResolver.resolveType(context.scope,typeReference,context.trace,true));
      }
 else {
        typeArguments.add(ErrorUtils.createErrorType("Star projection in a call"));
      }
    }
    int expectedTypeArgumentCount=candidate.getTypeParameters().size();
    if (expectedTypeArgumentCount == jetTypeArguments.size()) {
      checkGenericBoundsInAFunctionCall(jetTypeArguments,typeArguments,candidate,context.trace);
      Map<TypeConstructor,TypeProjection> substitutionContext=FunctionDescriptorUtil.createSubstitutionContext((FunctionDescriptor)candidate,typeArguments);
      candidateCall.setResultingSubstitutor(TypeSubstitutor.create(substitutionContext));
      List<TypeParameterDescriptor> typeParameters=candidateCall.getCandidateDescriptor().getTypeParameters();
      for (int i=0; i < typeParameters.size(); i++) {
        TypeParameterDescriptor typeParameterDescriptor=typeParameters.get(i);
        candidateCall.recordTypeArgument(typeParameterDescriptor,typeArguments.get(i));
      }
      candidateCall.addStatus(checkAllValueArguments(context).status);
    }
 else {
      candidateCall.addStatus(OTHER_ERROR);
      context.tracing.wrongNumberOfTypeArguments(context.trace,expectedTypeArgumentCount);
    }
  }
  task.performAdvancedChecks(candidate,context.trace,context.tracing);
  JetSuperExpression superExpression=TaskPrioritizer.getReceiverSuper(candidateCall.getReceiverArgument());
  if (superExpression != null) {
    context.trace.report(SUPER_IS_NOT_AN_EXPRESSION.on(superExpression,superExpression.getText()));
    candidateCall.addStatus(OTHER_ERROR);
  }
  AutoCastUtils.recordAutoCastIfNecessary(candidateCall.getReceiverArgument(),candidateCall.getTrace());
  AutoCastUtils.recordAutoCastIfNecessary(candidateCall.getThisObject(),candidateCall.getTrace());
}
