{
  if (expression == null)   return null;
  return expression.accept(new JetVisitor<JetExpression,Void>(){
    @Nullable private JetExpression visitInnerExpression(    @Nullable JetElement expression){
      if (expression == null)       return null;
      return expression.accept(this,null);
    }
    @Override public JetExpression visitQualifiedExpression(    @NotNull JetQualifiedExpression expression,    Void data){
      return visitInnerExpression(expression.getSelectorExpression());
    }
    @Override public JetExpression visitExpression(    @NotNull JetExpression expression,    Void data){
      return expression;
    }
    @Override public JetExpression visitParenthesizedExpression(    @NotNull JetParenthesizedExpression expression,    Void data){
      return visitInnerExpression(expression.getExpression());
    }
    @Override public JetExpression visitUnaryExpression(    @NotNull JetUnaryExpression expression,    Void data){
      return ExpressionTypingUtils.isUnaryExpressionDependentOnExpectedType(expression) ? expression : null;
    }
    @Override public JetExpression visitLabeledExpression(    @NotNull JetLabeledExpression expression,    Void data){
      return visitInnerExpression(expression.getBaseExpression());
    }
    @Override public JetExpression visitBlockExpression(    @NotNull JetBlockExpression expression,    Void data){
      JetElement lastStatement=JetPsiUtil.getLastStatementInABlock(expression);
      if (lastStatement != null) {
        return visitInnerExpression(lastStatement);
      }
      return expression;
    }
    @Override public JetExpression visitBinaryExpression(    @NotNull JetBinaryExpression expression,    Void data){
      return ExpressionTypingUtils.isBinaryExpressionDependentOnExpectedType(expression) ? expression : null;
    }
  }
,null);
}
