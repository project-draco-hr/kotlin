{
  doTest(new MultiFileTestCase.PerformAction(){
    @Override public void performAction(    VirtualFile rootDir,    VirtualFile rootAfter) throws Exception {
      PsiClass aClass=myJavaFacade.findClass(qClassName,GlobalSearchScope.allScope(getProject()));
      assertNotNull("Class " + qClassName + " not found",aClass);
      PsiElement substitution=RenamePsiElementProcessor.forElement(aClass).substituteElementToRename(aClass,null);
      new RenameProcessor(myProject,substitution,newName,true,true).run();
      PsiDocumentManager.getInstance(myProject).commitAllDocuments();
      FileDocumentManager.getInstance().saveAllDocuments();
    }
  }
);
}
