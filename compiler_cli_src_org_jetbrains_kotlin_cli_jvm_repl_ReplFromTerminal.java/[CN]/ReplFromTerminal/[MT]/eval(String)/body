{
  ReplInterpreter.LineResult lineResult=getReplInterpreter().eval(line);
  if (lineResult.getType() == ReplInterpreter.LineResultType.SUCCESS) {
    if (!lineResult.isUnit()) {
      replWriter.printlnResult(lineResult.getValue());
    }
  }
 else   if (lineResult.getType() == ReplInterpreter.LineResultType.INCOMPLETE) {
    replWriter.printlnIncomplete();
  }
 else   if (lineResult.getType() == ReplInterpreter.LineResultType.COMPILE_ERROR) {
    replWriter.printlnCompileError(lineResult.getErrorText());
  }
 else   if (lineResult.getType() == ReplInterpreter.LineResultType.RUNTIME_ERROR) {
    replWriter.printlnRuntimeError(lineResult.getErrorText());
  }
 else {
    throw new IllegalStateException("unknown line result type: " + lineResult);
  }
  return lineResult.getType();
}
