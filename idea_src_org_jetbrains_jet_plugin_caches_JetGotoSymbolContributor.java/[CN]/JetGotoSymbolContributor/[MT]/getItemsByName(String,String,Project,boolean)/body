{
  GlobalSearchScope baseScope=includeNonProjectItems ? GlobalSearchScope.allScope(project) : GlobalSearchScope.projectScope(project);
  GlobalSearchScope noLibrarySourceScope=JetSourceFilterScope.kotlinSourceAndClassFiles(baseScope,project);
  Collection<? extends NavigationItem> functions=JetFunctionShortNameIndex.getInstance().get(name,project,noLibrarySourceScope);
  Collection<? extends NavigationItem> properties=JetPropertyShortNameIndex.getInstance().get(name,project,noLibrarySourceScope);
  List<NavigationItem> items=new ArrayList<NavigationItem>(Collections2.filter(functions,Predicates.notNull()));
  items.addAll(properties);
  return ArrayUtil.toObjectArray(items,NavigationItem.class);
}
