{
  GlobalSearchScope scope=includeNonProjectItems ? GlobalSearchScope.allScope(project) : GlobalSearchScope.projectScope(project);
  Collection<? extends NavigationItem> functions=StubIndex.getInstance().get(JetIndexKeys.FUNCTIONS_SHORT_NAME_KEY,name,project,scope);
  Collection<? extends NavigationItem> properties=StubIndex.getInstance().get(JetIndexKeys.PROPERTIES_SHORT_NAME_KEY,name,project,scope);
  final List<NavigationItem> items=new ArrayList<NavigationItem>(Collections2.filter(functions,Predicates.notNull()));
  items.addAll(properties);
  return ArrayUtil.toObjectArray(items,NavigationItem.class);
}
