{
  DeclarationDescriptor declaration=p.getContainingDeclaration();
  if (CodegenUtil.isInterface(declaration)) {
    return ACC_PUBLIC;
  }
  if (p.getVisibility() == Visibilities.PUBLIC) {
    return ACC_PUBLIC;
  }
 else   if (p.getVisibility() == Visibilities.PROTECTED) {
    return ACC_PROTECTED;
  }
 else   if (p.getVisibility() == Visibilities.PRIVATE) {
    if (DescriptorUtils.isClassObject(declaration)) {
      return defaultFlags;
    }
    if (p.getContainingDeclaration() instanceof NamespaceDescriptor) {
      return ACC_PROTECTED;
    }
    return ACC_PRIVATE;
  }
 else   if (p.getVisibility() == Visibilities.INTERNAL) {
    return ACC_PUBLIC;
  }
 else {
    if (p.getVisibility() == Visibilities.INHERITED) {
      throw new IllegalStateException("'inherited' visibility is unresolved on code generation stage");
    }
    return defaultFlags;
  }
}
