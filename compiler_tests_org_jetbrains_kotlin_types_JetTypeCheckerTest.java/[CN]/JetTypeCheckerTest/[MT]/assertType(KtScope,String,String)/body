{
  Project project=getProject();
  KtExpression ktExpression=KtPsiFactoryKt.KtPsiFactory(project).createExpression(expression);
  KtType type=expressionTypingServices.getType(ScopeUtilsKt.asLexicalScope(addImports(scope)),ktExpression,TypeUtils.NO_EXPECTED_TYPE,DataFlowInfo.EMPTY,new BindingTraceContext());
  KtType expectedType=expectedTypeStr == null ? null : makeType(expectedTypeStr);
  assertEquals(expectedType,type);
}
