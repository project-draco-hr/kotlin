{
  DeclarationDescriptor parentDeclaration=deserializedDescriptor.getContainingDeclaration();
  ClassId containerClassId;
  if (parentDeclaration instanceof PackageFragmentDescriptor) {
    ProtoBuf.Callable proto=deserializedDescriptor.getProto();
    if (!proto.hasExtension(JvmProtoBuf.implClassName)) {
      throw new IllegalStateException("Function in namespace should have implClassName property in proto: " + deserializedDescriptor);
    }
    Name name=deserializedDescriptor.getNameResolver().getName(proto.getExtension(JvmProtoBuf.implClassName));
    ClassId packageClassId=PackageClassUtils.getPackageClassId(((PackageFragmentDescriptor)parentDeclaration).getFqName());
    containerClassId=new ClassId(packageClassId.getPackageFqName(),name);
  }
 else {
    containerClassId=getContainerClassId(deserializedDescriptor);
  }
  if (containerClassId == null) {
    throw new IllegalStateException("Couldn't find container FQName for " + deserializedDescriptor.getName());
  }
  return containerClassId;
}
