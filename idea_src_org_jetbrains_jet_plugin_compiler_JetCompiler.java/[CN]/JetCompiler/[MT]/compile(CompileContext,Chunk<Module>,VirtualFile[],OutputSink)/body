{
  if (virtualFiles.length == 0)   return;
  List<VirtualFile> productionFiles=new ArrayList<VirtualFile>();
  List<VirtualFile> testFiles=new ArrayList<VirtualFile>();
  for (  VirtualFile file : virtualFiles) {
    final boolean inTests=((CompileContextEx)compileContext).isInTestSourceContent(file);
    if (inTests) {
      testFiles.add(file);
    }
 else {
      productionFiles.add(file);
    }
  }
  final Module module=compileContext.getModuleByFile(virtualFiles[0]);
  doCompile(compileContext,moduleChunk,productionFiles,module,outputSink,false);
  doCompile(compileContext,moduleChunk,testFiles,module,outputSink,true);
}
