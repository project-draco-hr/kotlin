{
  if (type instanceof NullAwareType) {
    return ((NullAwareType)type).makeNullableAsSpecified(nullable);
  }
  if (type instanceof AbstractTypeWithKnownNullability) {
    return makeNullableAsSpecified(((AbstractTypeWithKnownNullability)type).delegate,nullable);
  }
  if (!(type instanceof LazyType) && type.isNullable() == nullable) {
    return type;
  }
  return nullable ? new NullableType(type) : new NotNullType(type);
}
