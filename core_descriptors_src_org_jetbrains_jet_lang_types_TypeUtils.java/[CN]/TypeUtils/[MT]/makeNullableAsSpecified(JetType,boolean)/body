{
  NullAwareness nullAwareness=type.getCapability(NullAwareness.class);
  if (nullAwareness != null) {
    return nullAwareness.makeNullableAsSpecified(nullable);
  }
  if (type instanceof AbstractTypeWithKnownNullability) {
    return makeNullableAsSpecified(((AbstractTypeWithKnownNullability)type).delegate,nullable);
  }
  if (!(type instanceof LazyType) && type.isMarkedNullable() == nullable) {
    return type;
  }
  return nullable ? new NullableType(type) : new NotNullType(type);
}
