{
  File libPath=getLibPath(environment.getKotlinPaths(),messageCollector);
  if (libPath == null)   return null;
  ClassLoader classLoader=ourClassLoaderRef.get();
  if (classLoader == null) {
    classLoader=usePreloader ? createPreloader(libPath,environment.getParentClassLoader(),environment.getClassesToLoadByParent()) : createClassLoader(libPath);
    ourClassLoaderRef=new SoftReference<ClassLoader>(classLoader);
  }
  Class<?> kompiler=Class.forName(compilerClassName,true,classLoader);
  Method exec=kompiler.getMethod("execAndOutputXml",PrintStream.class,Class.forName("org.jetbrains.jet.config.Services",true,classLoader),String[].class);
  return exec.invoke(kompiler.newInstance(),out,environment.getServices(),arguments);
}
