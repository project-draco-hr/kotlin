{
  List<Element> children=LintUtils.getChildren(element);
  boolean requiredIntentFilterFound=false;
  boolean deviceAdmin=false;
  Attr locationNode=null;
  for (  Element child : children) {
    String tagName=child.getTagName();
    if (tagName.equals(TAG_INTENT_FILTER) && !requiredIntentFilterFound) {
      boolean dataFound=false;
      boolean actionFound=false;
      for (      Element filterChild : LintUtils.getChildren(child)) {
        String filterTag=filterChild.getTagName();
        if (filterTag.equals(NODE_ACTION)) {
          String name=filterChild.getAttributeNS(ANDROID_URI,ATTR_NAME);
          if ("android.app.action.DEVICE_ADMIN_ENABLED".equals(name)) {
            actionFound=true;
          }
        }
 else         if (filterTag.equals(NODE_DATA)) {
          dataFound=true;
        }
      }
      if (actionFound && !dataFound) {
        requiredIntentFilterFound=true;
      }
    }
 else     if (tagName.equals(NODE_METADATA)) {
      Attr valueNode=child.getAttributeNodeNS(ANDROID_URI,ATTR_NAME);
      if (valueNode != null) {
        String name=valueNode.getValue();
        if ("android.app.device_admin".equals(name)) {
          deviceAdmin=true;
          locationNode=valueNode;
        }
      }
    }
  }
  if (deviceAdmin && !requiredIntentFilterFound && context.isEnabled(DEVICE_ADMIN)) {
    context.report(DEVICE_ADMIN,locationNode,context.getLocation(locationNode),"You must have an intent filter for action " + "`android.app.action.DEVICE_ADMIN_ENABLED`");
  }
}
