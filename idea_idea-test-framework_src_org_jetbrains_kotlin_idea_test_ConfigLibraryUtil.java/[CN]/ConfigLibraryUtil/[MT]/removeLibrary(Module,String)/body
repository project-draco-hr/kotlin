{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModuleRootManager rootManager=ModuleRootManager.getInstance(module);
      ModifiableRootModel model=rootManager.getModifiableModel();
      for (      OrderEntry orderEntry : model.getOrderEntries()) {
        if (orderEntry instanceof LibraryOrderEntry) {
          LibraryOrderEntry libraryOrderEntry=(LibraryOrderEntry)orderEntry;
          Library library=libraryOrderEntry.getLibrary();
          if (library != null) {
            String name=library.getName();
            if (name != null && name.equals(libraryName)) {
              Library.ModifiableModel modifiableModel=library.getModifiableModel();
              for (              String rootUrl : library.getRootProvider().getUrls(OrderRootType.CLASSES)) {
                modifiableModel.removeRoot(rootUrl,OrderRootType.CLASSES);
              }
              for (              String rootUrl : library.getRootProvider().getUrls(OrderRootType.SOURCES)) {
                modifiableModel.removeRoot(rootUrl,OrderRootType.SOURCES);
              }
              modifiableModel.commit();
              model.getModuleLibraryTable().removeLibrary(library);
              break;
            }
          }
        }
      }
      model.commit();
    }
  }
);
}
