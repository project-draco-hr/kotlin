{
  JetExpression bodyExpression=function.getBodyExpression();
  if (bodyExpression == null)   return;
  final boolean blockBody=function.hasBlockBody();
  final TypeInferenceContext context=blockBody ? newContext(trace,functionInnerScope,dataFlowInfo,NO_EXPECTED_TYPE,expectedReturnType) : newContext(trace,functionInnerScope,dataFlowInfo,expectedReturnType,FORBIDDEN);
  if (function instanceof JetFunctionLiteralExpression) {
    JetFunctionLiteralExpression functionLiteralExpression=(JetFunctionLiteralExpression)function;
    getBlockReturnedType(functionInnerScope,functionLiteralExpression.getBodyExpression(),CoercionStrategy.COERCION_TO_UNIT,context);
  }
 else {
    typeInferrerVisitor.getType(bodyExpression,context);
  }
}
