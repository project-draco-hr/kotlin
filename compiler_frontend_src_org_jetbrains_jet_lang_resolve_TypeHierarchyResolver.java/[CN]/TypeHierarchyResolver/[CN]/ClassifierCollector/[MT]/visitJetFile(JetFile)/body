{
  NamespaceDescriptorImpl namespaceDescriptor=namespaceFactory.createNamespaceDescriptorPathIfNeeded(file,outerScope,RedeclarationHandler.DO_NOTHING);
  context.getNamespaceDescriptors().put(file,namespaceDescriptor);
  WriteThroughScope namespaceScope=new WriteThroughScope(outerScope,namespaceDescriptor.getMemberScope(),new TraceBasedRedeclarationHandler(trace),"namespace in file " + file.getName());
  namespaceScope.changeLockLevel(WritableScope.LockLevel.BOTH);
  context.getNamespaceScopes().put(file,namespaceScope);
  if (file.isScript()) {
    scriptHeaderResolver.processScriptHierarchy(file.getScript(),namespaceScope);
  }
  prepareForDeferredCall(namespaceScope,namespaceDescriptor,file);
}
