{
  GenerationState generationState=analyzeAndGenerate(environment);
  if (generationState == null) {
    return null;
  }
  try {
    ClassFileFactory factory=generationState.getFactory();
    try {
      GeneratedClassLoader classLoader=new GeneratedClassLoader(factory,new URLClassLoader(new URL[]{CompilerPathUtil.getRuntimePath().toURI().toURL()},parentLoader == null ? AllModules.class.getClassLoader() : parentLoader));
      JetFile scriptFile=environment.getSourceFiles().get(0);
      return classLoader.loadClass(ScriptCodegen.classNameForScript(scriptFile));
    }
 catch (    Exception e) {
      throw new RuntimeException("Failed to evaluate script: " + e,e);
    }
  }
  finally {
    generationState.destroy();
  }
}
