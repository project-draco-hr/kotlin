{
  Project project=config.getProject();
  BindingTraceContext bindingTraceContext=new BindingTraceContext();
  final ModuleDescriptor owner=new ModuleDescriptor(Name.special("<module>"));
  Predicate<PsiFile> completely=Predicates.and(notLibFiles(config.getLibFiles()),filesToAnalyzeCompletely);
  TopDownAnalysisParameters topDownAnalysisParameters=new TopDownAnalysisParameters(completely,false,false);
  InjectorForTopDownAnalyzerForJs injector=new InjectorForTopDownAnalyzerForJs(project,topDownAnalysisParameters,new ObservableBindingTrace(bindingTraceContext),owner,JetControlFlowDataTraceFactory.EMPTY,JsConfiguration.jsLibConfiguration(project));
  injector.getTopDownAnalyzer().analyzeFiles(withJsLibAdded(files,config));
  return bindingTraceContext.getBindingContext();
}
