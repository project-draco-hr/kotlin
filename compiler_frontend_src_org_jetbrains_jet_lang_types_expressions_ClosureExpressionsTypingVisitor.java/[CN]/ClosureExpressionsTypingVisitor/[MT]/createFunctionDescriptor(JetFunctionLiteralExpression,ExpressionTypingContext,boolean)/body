{
  JetFunctionLiteral functionLiteral=expression.getFunctionLiteral();
  JetTypeReference receiverTypeRef=functionLiteral.getReceiverTypeRef();
  NamedFunctionDescriptorImpl functionDescriptor=new NamedFunctionDescriptorImpl(context.scope.getContainingDeclaration(),Collections.<AnnotationDescriptor>emptyList(),"<anonymous>");
  List<ValueParameterDescriptor> valueParameterDescriptors=createValueParameterDescriptors(context,functionLiteral,functionDescriptor,functionTypeExpected);
  JetType effectiveReceiverType;
  if (receiverTypeRef == null) {
    if (functionTypeExpected) {
      effectiveReceiverType=JetStandardClasses.getReceiverType(context.expectedType);
    }
 else {
      effectiveReceiverType=null;
    }
  }
 else {
    effectiveReceiverType=context.getTypeResolver().resolveType(context.scope,receiverTypeRef);
  }
  functionDescriptor.initialize(effectiveReceiverType,NO_RECEIVER,Collections.<TypeParameterDescriptor>emptyList(),valueParameterDescriptors,null,Modality.FINAL,Visibility.LOCAL);
  context.trace.record(BindingContext.FUNCTION,expression,functionDescriptor);
  return functionDescriptor;
}
