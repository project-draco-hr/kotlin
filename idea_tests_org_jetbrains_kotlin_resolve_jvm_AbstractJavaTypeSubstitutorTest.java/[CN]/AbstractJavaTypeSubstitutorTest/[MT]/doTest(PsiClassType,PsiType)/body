{
  PsiType expectedType=type.resolveGenerics().getSubstitutor().substitute(psiTypeToSubstitute);
  JavaClassifierType javaClassifierType=(JavaClassifierType)JavaTypeImpl.create(type);
  JavaType javaTypeToSubstitute=JavaTypeImpl.create(psiTypeToSubstitute);
  JavaType actualType=javaClassifierType.getSubstitutor().substitute(javaTypeToSubstitute);
  if (expectedType instanceof PsiEllipsisType) {
    PsiEllipsisType ellipsisType=(PsiEllipsisType)expectedType;
    assertEquals(ellipsisType.toArrayType(),((JavaTypeImpl)actualType).getPsi());
  }
 else {
    assertEquals(expectedType,((JavaTypeImpl)actualType).getPsi());
  }
}
