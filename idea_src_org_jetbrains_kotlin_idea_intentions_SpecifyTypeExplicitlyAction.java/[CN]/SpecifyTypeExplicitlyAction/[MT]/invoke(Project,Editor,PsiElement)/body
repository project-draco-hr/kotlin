{
  JetTypeReference typeRefParent=PsiTreeUtil.getTopmostParentOfType(element,JetTypeReference.class);
  if (typeRefParent != null) {
    element=typeRefParent;
  }
  JetCallableDeclaration declaration=(JetCallableDeclaration)element.getParent();
  JetType type=getTypeForDeclaration(declaration);
  if (declaration.getTypeReference() == null) {
    addTypeAnnotation(project,editor,declaration,type);
  }
 else {
    declaration.setTypeReference(null);
  }
}
