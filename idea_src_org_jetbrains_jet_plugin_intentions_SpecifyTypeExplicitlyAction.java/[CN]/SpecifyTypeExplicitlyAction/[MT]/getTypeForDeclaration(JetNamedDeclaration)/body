{
  BindingContext bindingContext=ResolvePackage.getAnalysisResults(declaration.getContainingJetFile()).getBindingContext();
  DeclarationDescriptor descriptor=bindingContext.get(BindingContext.DECLARATION_TO_DESCRIPTOR,declaration);
  JetType type;
  if (descriptor instanceof VariableDescriptor) {
    type=((VariableDescriptor)descriptor).getType();
  }
 else   if (descriptor instanceof SimpleFunctionDescriptor) {
    type=((SimpleFunctionDescriptor)descriptor).getReturnType();
  }
 else {
    return ErrorUtils.createErrorType("unknown declaration type");
  }
  return type == null ? ErrorUtils.createErrorType("null type") : type;
}
